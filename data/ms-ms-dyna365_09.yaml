- en: Report Development with AL
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 使用 AL 进行报告开发
- en: In this book, we have been introduced to and analyzed a vast variety of AL language
    objects, and we've seen how to develop simple to complex extensions with them.
  id: totrans-1
  prefs: []
  type: TYPE_NORMAL
  zh: 在本书中，我们介绍并分析了各种 AL 语言对象，并且展示了如何使用它们开发从简单到复杂的扩展。
- en: In this chapter, we will deep dive into a specific object and look at its properties,
    triggers, and methods and how to use it proficiently. This object is **the report
    object**.
  id: totrans-2
  prefs: []
  type: TYPE_NORMAL
  zh: 在本章中，我们将深入研究一个特定对象，查看其属性、触发器和方法，并学习如何熟练使用它。这个对象就是**报告对象**。
- en: An overview, with pros and cons, will be provided regarding which tool to use
    to design and develop datasets and layouts, such as Microsoft Word for Word layouts
    and Microsoft Report Builder for **Report Definition Language** (**RDL**) layouts.
    We will discuss the main shortcuts, tips, and tricks related to dataset development
    with Visual Studio Code and both Word and RDL layouts.
  id: totrans-3
  prefs: []
  type: TYPE_NORMAL
  zh: 我们将提供有关使用哪些工具来设计和开发数据集和布局的概述，包括 Microsoft Word 用于 Word 布局，以及 Microsoft Report
    Builder 用于**报告定义语言**（**RDL**）布局，并且会讨论与使用 Visual Studio Code 进行数据集开发以及 Word 和 RDL
    布局相关的主要快捷键、技巧和窍门。
- en: In this chapter, we aspire to provide you with the confidence you need to develop
    Dynamics 365 Business Central report extensions, explain how to make them perform
    to their best, and help you troubleshoot the most common issues in this area.
  id: totrans-4
  prefs: []
  type: TYPE_NORMAL
  zh: 在本章中，我们旨在为您提供必要的信心，以便您能够开发 Dynamics 365 Business Central 报告扩展，解释如何使其性能达到最佳，并帮助您排查这一领域最常见的问题。
- en: 'In this chapter, we will cover the following topics:'
  id: totrans-5
  prefs: []
  type: TYPE_NORMAL
  zh: 在本章中，我们将讨论以下主题：
- en: Anatomy of the AL report object
  id: totrans-6
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: AL 报告对象的结构
- en: Tools to use for Word and RDL layouts
  id: totrans-7
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 用于 Word 和 RDL 布局的工具
- en: Converting an existing C/AL report into AL
  id: totrans-8
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 将现有的 C/AL 报告转换为 AL
- en: Feature limitation when developing an RDL or Word layout report
  id: totrans-9
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 开发 RDL 或 Word 布局报告时的功能限制
- en: Understanding report performance considerations
  id: totrans-10
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 理解报告性能的考虑因素
- en: Anatomy of the AL report object
  id: totrans-11
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: AL 报告对象的结构
- en: Requests for new reports come from every department and in many different forms.
    Most of the time, users have an idea in mind of how they would like the data to
    be shown.
  id: totrans-12
  prefs: []
  type: TYPE_NORMAL
  zh: 新报告的请求来自各个部门，并且以多种不同的形式呈现。大多数时候，用户心中已经有了他们希望数据呈现方式的构想。
- en: 'Nevertheless, a report developer should always keep in mind some important
    points. Everything is related to data:'
  id: totrans-13
  prefs: []
  type: TYPE_NORMAL
  zh: 然而，报告开发人员应始终牢记一些重要的要点。一切都与数据相关：
- en: '**Retrieval**: A good report developer should have a good knowledge of the
    business process (how data is created, modified, and deleted) and data topology
    (where data is stored). Data can be retrieved from heterogenous resources that
    cannot be directly stored in Dynamics 365 Business Central tables. As an example,
    you might want to run an HTTP call to a web service to gather some data outside
    the database and store it in a physical or temporary table before processing it.'
  id: totrans-14
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**检索**：一个优秀的报告开发人员应具备良好的业务流程知识（数据是如何创建、修改和删除的）和数据拓扑知识（数据存储的位置）。数据可以从无法直接存储在
    Dynamics 365 Business Central 表中的异构资源中检索。例如，您可能希望通过 HTTP 调用一个 Web 服务，收集数据库外部的一些数据，并将其存储在物理表或临时表中，然后再进行处理。'
- en: '**Processing**: Some of the data that''s presented could be the result of data
    aggregation, could be calculated from different fields, or could even be the results
    from a concatenation of values from different tables. The result of data retrieval
    and processing generates the dataset.'
  id: totrans-15
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**处理**：一些呈现的数据可能是数据聚合的结果，可能是从不同字段计算得到的，甚至可能是不同表格中值的连接结果。数据的检索和处理结果生成数据集。'
- en: '**Presentation**: Datasets are sent from the application to the Report Viewer
    component, which takes care of data rendering and presentation. Together with
    the dataset, a report definition file (`Report.rdlc`) is sent to the Report Viewer
    to build up the content of the report. The report definition file contains the
    metadata structure and rules to render the report. Despite its extension (`.rdlc`),
    this is actually an XML-formatted flat file. Tools such as the Report Builder
    or Visual Studio can digest the XML file and create a presentation of the report
    structure in a more human-readable way. Every action that''s taken in this designer
    has the consequence of editing and changing the XML file.'
  id: totrans-16
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**呈现**：数据集从应用程序发送到报告查看器组件，报告查看器负责数据的呈现和显示。与数据集一起，一个报告定义文件（`Report.rdlc`）也会发送给报告查看器，以构建报告的内容。报告定义文件包含用于呈现报告的元数据结构和规则。尽管它的扩展名是（`.rdlc`），但这实际上是一个XML格式的平面文件。诸如报告生成器或Visual
    Studio之类的工具可以解析该XML文件，并以更易于人类阅读的方式创建报告结构的呈现。在此设计器中进行的每个操作都会导致编辑和更改XML文件。'
- en: With Dynamics 365 Business Central, it is also possible to design reports to
    perform only data retrieval and processing, typically committing changes in tables
    as a result of the process. No data is presented to the users, hence no layout
    is needed, and no dataset will be created.
  id: totrans-17
  prefs: []
  type: TYPE_NORMAL
  zh: 使用Dynamics 365 Business Central，还可以设计报告仅执行数据检索和处理，通常会在处理过程中提交对表的更改。没有数据呈现给用户，因此不需要布局，也不会创建数据集。
- en: 'Reports can be grouped into two main categories: processing only and dataset-based.'
  id: totrans-18
  prefs: []
  type: TYPE_NORMAL
  zh: 报告可以分为两大类：仅处理和基于数据集。
- en: Reports that are processing only do not have any layout. They also typically
    do not have any columns defined in the dataset and are only used to process data.
    Quite often, the same result could be achieved using codeunit objects instead
    since these are just simple code repositories and do not have any graphical or
    **User Interface** (**UI**) interaction. To give you a simple example, you could
    create a processing-only report with a data item that loops all the customer records
    and prints a flat JSON file with the customer number, name, and email. The same
    could be achieved by implementing a codeunit with a function that declares an `IF
    CustomerRec FINDSET THEN REPEAT UNTIL NEXT=0` loop. Within this loop, it is possible
    to write a flat JSON file with exactly the same information.
  id: totrans-19
  prefs: []
  type: TYPE_NORMAL
  zh: 仅处理的报告没有任何布局。它们通常也没有在数据集中定义任何列，只用于处理数据。通常，使用代码单元对象也可以实现相同的结果，因为这些只是简单的代码库，并没有任何图形或**用户界面**（**UI**）交互。举个简单的例子，你可以创建一个仅处理的报告，数据项会循环所有客户记录，并打印一个包含客户编号、姓名和电子邮件的扁平JSON文件。同样的结果也可以通过实现一个代码单元来完成，该代码单元包含一个声明为`IF
    CustomerRec FINDSET THEN REPEAT UNTIL NEXT=0`的循环。在这个循环中，可以编写一个包含完全相同信息的扁平JSON文件。
- en: 'The pros and cons of using a processing-only report or a codeunit have been
    tabulated here:'
  id: totrans-20
  prefs: []
  type: TYPE_NORMAL
  zh: 使用仅处理报告或代码单元的优缺点已经在这里列出：
- en: '|  | **Processing Only Report** | **Codeunit** |'
  id: totrans-21
  prefs: []
  type: TYPE_TB
  zh: '|  | **仅处理报告** | **代码单元** |'
- en: '| **Easy to Implement** | It''s faster. The data item looping construct is
    predefined. | There''s more development activity to build a loop. |'
  id: totrans-22
  prefs: []
  type: TYPE_TB
  zh: '| **易于实现** | 它更快。数据项循环结构是预定义的。 | 构建一个循环需要更多的开发活动。 |'
- en: '| **Flexibility** | It''s limited to data item triggers. | It''s more flexible.
    |'
  id: totrans-23
  prefs: []
  type: TYPE_TB
  zh: '| **灵活性** | 它仅限于数据项触发器。 | 它更灵活。 |'
- en: '| **Performance** | It has worse performance. | It has better performance.
    |'
  id: totrans-24
  prefs: []
  type: TYPE_TB
  zh: '| **性能** | 它的性能较差。 | 它的性能更好。 |'
- en: 'A report object has the following tree structure:'
  id: totrans-25
  prefs: []
  type: TYPE_NORMAL
  zh: 一个报告对象具有以下树结构：
- en: '**Request Page**:'
  id: totrans-26
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**请求页面**：'
- en: '**Columns**:'
  id: totrans-27
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**列**：'
- en: '**Groups**:'
  id: totrans-28
  prefs:
  - PREF_IND
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**分组**：'
- en: '**Fields**'
  id: totrans-29
  prefs:
  - PREF_IND
  - PREF_IND
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**字段**'
- en: '**Actions**'
  id: totrans-30
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**操作**'
- en: '**Dataset**:'
  id: totrans-31
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**数据集**：'
- en: '**Data items**:'
  id: totrans-32
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**数据项**：'
- en: '**Properties**'
  id: totrans-33
  prefs:
  - PREF_IND
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**属性**'
- en: '**Triggers**'
  id: totrans-34
  prefs:
  - PREF_IND
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**触发器**'
- en: '**Columns**:'
  id: totrans-35
  prefs:
  - PREF_IND
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**列**：'
- en: '**Properties**'
  id: totrans-36
  prefs:
  - PREF_IND
  - PREF_IND
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**属性**'
- en: '**Triggers**'
  id: totrans-37
  prefs:
  - PREF_IND
  - PREF_IND
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**触发器**'
- en: '**Labels**:'
  id: totrans-38
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**标签**：'
- en: '**Properties**'
  id: totrans-39
  prefs:
  - PREF_IND
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**属性**'
- en: '**Layout**:'
  id: totrans-40
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**布局**：'
- en: '**RDL**'
  id: totrans-41
  prefs:
  - PREF_IND
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**RDL**'
- en: '**Word**'
  id: totrans-42
  prefs:
  - PREF_IND
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**词汇**'
- en: 'After installing the standard **AL Language extension** and **CRS AL Language
    extension tool**, we could use a `treport` or `treport` (CRS) snippet to create
    a prototype of a report and inspect all the different items related to the main
    content areas: the dataset and the request page. Layouts are just references to
    the corresponding output (an RDL and/or Word file) within the report objects,
    and these are created with tools other than Visual Studio Code. We will work with
    them later in this chapter.'
  id: totrans-43
  prefs: []
  type: TYPE_NORMAL
  zh: 安装标准的**AL Language 扩展**和**CRS AL Language 扩展工具**后，我们可以使用`treport`或`treport`（CRS）代码片段来创建报告的原型，并检查与主内容区域相关的所有不同项：数据集和请求页面。布局仅是报告对象中对应输出（RDL
    和/或 Word 文件）的引用，这些是通过其他工具而非 Visual Studio Code 创建的。我们将在本章稍后部分与它们一起工作。
- en: After exploring the anatomy of a report object in AL, it is time to see the
    tools that are used in Word and RDL layouts.
  id: totrans-44
  prefs: []
  type: TYPE_NORMAL
  zh: 在探索 AL 中报告对象的结构后，是时候了解用于 Word 和 RDL 布局的工具了。
- en: Tools to use for Word and RDL layouts
  id: totrans-45
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 用于 Word 和 RDL 布局的工具
- en: Visual Studio Code does not have a valid extension—yet—that would replace the
    best-in-class RDL report editor, which is supported by the Dynamics 365 Business
    Central development team. With a release every six months, the application is
    always up to date and, at the time of writing, it deploys Report Viewer 2017 and
    the latest RDL 2016 schema-based syntax.
  id: totrans-46
  prefs: []
  type: TYPE_NORMAL
  zh: Visual Studio Code 目前没有有效的扩展——尚未发布——来替代由 Dynamics 365 Business Central 开发团队支持的顶级
    RDL 报告编辑器。该应用程序每六个月发布一次，始终保持最新状态，并且在撰写本文时，它部署了 Report Viewer 2017 和最新的基于 RDL 2016
    模式的语法。
- en: 'To develop an RDL layout report, you have two choices:'
  id: totrans-47
  prefs: []
  type: TYPE_NORMAL
  zh: 要开发 RDL 布局报告，你有两个选择：
- en: '**Report Builder for SQL Server 2016**: [https://www.microsoft.com/en-us/download/details.aspx?id=53613](https://www.microsoft.com/en-us/download/details.aspx?id=53613)'
  id: totrans-48
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**SQL Server 2016 报告生成器**: [https://www.microsoft.com/en-us/download/details.aspx?id=53613](https://www.microsoft.com/en-us/download/details.aspx?id=53613)'
- en: '**Visual Studio 2017 with the Microsoft RDLC Report Designer for the Visual
    Studio extension installed**: [https://marketplace.visualstudio.com/items?itemName=ProBITools.MicrosoftRdlcReportDesignerforVisualStudio-18001](https://marketplace.visualstudio.com/items?itemName=ProBITools.MicrosoftRdlcReportDesignerforVisualStudio-18001)'
  id: totrans-49
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**已安装 Microsoft RDLC 报告设计器的 Visual Studio 2017**: [https://marketplace.visualstudio.com/items?itemName=ProBITools.MicrosoftRdlcReportDesignerforVisualStudio-18001](https://marketplace.visualstudio.com/items?itemName=ProBITools.MicrosoftRdlcReportDesignerforVisualStudio-18001)'
- en: 'To find out more, please visit the following official reference and this useful
    blog:'
  id: totrans-50
  prefs: []
  type: TYPE_NORMAL
  zh: 要了解更多信息，请访问以下官方参考资料和这个有用的博客：
- en: '[https://docs.microsoft.com/en-us/dynamics365/business-central/dev-itpro/deployment/system-requirement-business-central ](https://docs.microsoft.com/en-us/dynamics365/business-central/dev-itpro/deployment/system-requirement-business-central)'
  id: totrans-51
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[https://docs.microsoft.com/en-us/dynamics365/business-central/dev-itpro/deployment/system-requirement-business-central](https://docs.microsoft.com/en-us/dynamics365/business-central/dev-itpro/deployment/system-requirement-business-central)'
- en: '[https://thinkaboutit.be/2019/01/how-do-i-configure-my-rdlc-layout-designers-for-vscode/](https://thinkaboutit.be/2019/01/how-do-i-configure-my-rdlc-layout-designers-for-vscode/)'
  id: totrans-52
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[https://thinkaboutit.be/2019/01/how-do-i-configure-my-rdlc-layout-designers-for-vscode/](https://thinkaboutit.be/2019/01/how-do-i-configure-my-rdlc-layout-designers-for-vscode/)'
- en: The Word layout feature is built around the latest Aspose.Words ([https://products.aspose.com/words](https://products.aspose.com/words))
    component and is implemented in the application by the backend server team. Designing
    and editing must be done with a version of Microsoft Word that supports XML mappings.
    Minimum system requirements specify that we should use **Microsoft Word 2016**
    or later.
  id: totrans-53
  prefs: []
  type: TYPE_NORMAL
  zh: Word 布局功能是基于最新的 Aspose.Words ([https://products.aspose.com/words](https://products.aspose.com/words))
    组件构建的，并由后端服务器团队在应用程序中实现。设计和编辑必须使用支持 XML 映射的 Microsoft Word 版本。最低系统要求规定我们应使用**Microsoft
    Word 2016**或更高版本。
- en: RDL and Word layout features
  id: totrans-54
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: RDL 和 Word 布局功能
- en: To explain and show some of the most important RDL and Word layout features
    supported by Dynamics 365 Business Central, we will go through a step-by-step
    example.
  id: totrans-55
  prefs: []
  type: TYPE_NORMAL
  zh: 为了解释和展示 Dynamics 365 Business Central 支持的一些最重要的 RDL 和 Word 布局功能，我们将通过一个逐步示例进行讲解。
- en: In [Chapter 5](d8553d40-bf59-4aef-983c-89519ef30e29.xhtml), *Developing a Customized
    Solution for Dynamics 365 Business Central*, we extended the Item Ledger Entry
    table by creating the Customer Category field for statistics. It is now time to
    create a report that uses this extended field for sales analysis purposes. Create
    a new directory in your extension called `.\Src\CustomerCategory\report`. Let's
    learn how to do this.
  id: totrans-56
  prefs: []
  type: TYPE_NORMAL
  zh: 在[第5章](d8553d40-bf59-4aef-983c-89519ef30e29.xhtml)，*为Dynamics 365 Business Central开发定制解决方案*中，我们通过创建“客户类别”字段来扩展了项目账目表。现在是时候创建一个使用此扩展字段进行销售分析的报告了。请在扩展中创建一个名为`.\Src\CustomerCategory\report`的新目录。让我们学习如何实现。
- en: Part 1 – Designing the dataset
  id: totrans-57
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 第1部分 – 设计数据集
- en: The dataset is designed within the report by specifying the data item field's
    columns and their properties. They have a big influence from a qualitative perspective
    (in which format is data exported?) and from a quantitative perspective (how many
    rows are processed?). Both have a clear impact on report performance.
  id: totrans-58
  prefs: []
  type: TYPE_NORMAL
  zh: 数据集通过指定数据项字段的列及其属性在报告中进行设计。它们从定性角度（数据以何种格式导出？）和定量角度（处理了多少行？）都有较大影响。这两者对报告性能都有明显的影响。
- en: 'A short example is represented by decimal data types. When specifying a decimal
    data type in a dataset, two fields are always included: the decimal data and its
    formatting. This means that, together with the decimal field, you always have
    a repeated text variable tightly bound to it. This would increase the dimension
    of the dataset and, consequently, influence report performance.'
  id: totrans-59
  prefs: []
  type: TYPE_NORMAL
  zh: 一个简短的示例是由十进制数据类型表示的。当在数据集中特定十进制数据类型时，始终会包括两个字段：十进制数据及其格式化方式。这意味着，在十进制字段的同时，你总是会有一个与之紧密绑定的重复文本变量。这将增加数据集的维度，从而影响报告性能。
- en: 'What could be the definition of a Dynamics 365 Business Central dataset? Here''s
    mine:'
  id: totrans-60
  prefs: []
  type: TYPE_NORMAL
  zh: 什么是Dynamics 365 Business Central数据集的定义？这是我的定义：
- en: '"A dataset is like a table in the client memory whose columns are made of all
    of the column fields defined in the dataset section and whose rows are all valid
    (not skipped) records that are processed in the DataItems."'
  id: totrans-61
  prefs: []
  type: TYPE_NORMAL
  zh: “数据集就像是客户端内存中的一张表，其列由数据集部分中定义的所有列字段组成，而行则是所有有效的（未跳过的）记录，这些记录在DataItems中进行处理。”
- en: 'Let''s design/create our report dataset:'
  id: totrans-62
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们设计/创建我们的报告数据集：
- en: Create a new file in the `.\Src\CustomerCategory\report` folder called `Rep50111.ItemLedegerEntryAnalysis.al`.
  id: totrans-63
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在`.\Src\CustomerCategory\report`文件夹中创建一个名为`Rep50111.ItemLedegerEntryAnalysis.al`的新文件。
- en: Type `treport` or `treport` (CRS) to enable the report snippet.
  id: totrans-64
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 输入`treport`或`treport`（CRS）以启用报告片段。
- en: 'Add the following data item and columns:'
  id: totrans-65
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 添加以下数据项和列：
- en: '[PRE0]'
  id: totrans-66
  prefs: []
  type: TYPE_PRE
  zh: '[PRE0]'
- en: 'After this, we add the labels:'
  id: totrans-67
  prefs: []
  type: TYPE_NORMAL
  zh: 之后，我们添加标签：
- en: '[PRE1]'
  id: totrans-68
  prefs: []
  type: TYPE_PRE
  zh: '[PRE1]'
- en: Build and publish the extension as is in your online or Docker-contained sandbox.
  id: totrans-69
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 按照原样构建并发布扩展，在你的在线或Docker容器沙箱中进行。
- en: Go to Report Layout Selection and filter for your report's ID or name.
  id: totrans-70
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 转到报告布局选择，并根据报告的ID或名称进行筛选。
- en: Select Actions | Custom Layouts.
  id: totrans-71
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 选择“操作 | 自定义布局”。
- en: Click New, select Insert RDLC layout, and click OK. This will add an empty RDL
    layout to the report and reference the dataset structure.
  id: totrans-72
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 单击“新建”，选择“插入RDLC布局”，然后单击“确定”。这将为报告添加一个空的RDL布局，并引用数据集结构。
- en: Choose Process | Export Layout and save the `Default.rdl` report in the `.\Src\CustomerCategory\report`
    folder. You might call the report layout `Rep50111.ItemLedgerEntryAnalysis.rdl`.
  id: totrans-73
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 选择“处理 | 导出布局”，并将`Default.rdl`报告保存到`.\Src\CustomerCategory\report`文件夹中。你可以将报告布局命名为`Rep50111.ItemLedgerEntryAnalysis.rdl`。
- en: 'Bind the report to the RDL layout within the extension and make RDL the default
    layout by specifying the following parameter in the AL report object:'
  id: totrans-74
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将报告绑定到扩展中的RDL布局，并通过在AL报告对象中指定以下参数，使RDL成为默认布局：
- en: '[PRE2]'
  id: totrans-75
  prefs: []
  type: TYPE_PRE
  zh: '[PRE2]'
- en: In Visual Studio Code, right-click the RDL file and choose Open externally.
    It will open in whichever program you selected to work with the `.rdl` file extension
    by default. In this example, we will work with Microsoft SQL Server Report Builder
    2016.
  id: totrans-76
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在Visual Studio Code中，右键单击RDL文件并选择“外部打开”。它将默认在你选择的程序中打开该`.rdl`文件。在此示例中，我们将使用Microsoft
    SQL Server Report Builder 2016。
- en: If it's not already enabled, be sure to have the Report Data option checked
    in the View | Show/Hide ribbon menu in your Report Builder 2016 instance. In the
    Report Data pane, expand `Parameters` and `DataSets`.
  id: totrans-77
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 如果尚未启用，请确保在Report Builder 2016实例的“视图 | 显示/隐藏”功能区菜单中勾选了“报告数据”选项。在“报告数据”窗格中，展开`参数`和`数据集`。
- en: 'You will notice that `Parameters` items are labels and field captions (specified
    by the `IncludeCaption=true` property in the dataset). `DataSet_Results` shows
    the entire dataset''s definition transposed into the Report Builder IDE. Here
    is a screenshot of the Report Data pane:'
  id: totrans-78
  prefs: []
  type: TYPE_NORMAL
  zh: 你会注意到 `Parameters` 项是标签和字段标题（由数据集中的 `IncludeCaption=true` 属性指定）。`DataSet_Results`
    显示了整个数据集的定义，并转置到 Report Builder IDE 中。以下是报告数据窗格的截图：
- en: '![](img/cd0285fa-5e83-40e7-8df3-4e76c7def0bd.png)'
  id: totrans-79
  prefs: []
  type: TYPE_IMG
  zh: '![](img/cd0285fa-5e83-40e7-8df3-4e76c7def0bd.png)'
- en: Part 2 – Creating a simple RDL layout
  id: totrans-80
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 第2部分 – 创建简单的 RDL 布局
- en: RDL layout development is one of the two layout design options you have for
    Dynamics 365 Business Central. Report layout design with Visual Studio 2017 (plus
    the Microsoft RDLC Report Designer for Visual Studio extension) has a fully-fledged
    development experience compared to Report Builder. An example is the Document
    Outline window, which shows a hierarchical view of the controls in the layout
    and lets you jump from one control to another quickly.
  id: totrans-81
  prefs: []
  type: TYPE_NORMAL
  zh: RDL 布局开发是 Dynamics 365 Business Central 提供的两种布局设计选项之一。与 Report Builder 相比，使用
    Visual Studio 2017（加上 Microsoft RDLC Report Designer for Visual Studio 扩展）进行报告布局设计提供了更完整的开发体验。一个例子是“文档大纲”窗口，它显示了布局中控件的层次视图，并让你可以快速从一个控件跳转到另一个控件。
- en: Specifically targeted at RDL layout development, you may find quite exhaustive
    official documentation from SQL Server Reporting Services, official courseware,
    or third-party books. This section contains some very good development references
    if you would like to completely master the RDL layout for Dynamics 365 Business
    Central. Even if they mostly come from earlier versions of Dynamics NAV or SQL
    Server Reporting Services, they still contain great hints, and you should spare
    them a spot in your personal library.
  id: totrans-82
  prefs: []
  type: TYPE_NORMAL
  zh: 专门针对 RDL 布局开发，你可以从 SQL Server Reporting Services 的官方文档、官方课程资料或第三方书籍中找到非常详尽的资料。如果你希望彻底掌握
    Dynamics 365 Business Central 的 RDL 布局，本部分包含了一些非常好的开发参考资料。即使它们大多来自较早版本的 Dynamics
    NAV 或 SQL Server Reporting Services，它们仍然包含了许多有用的提示，你应该在个人资料库中留一个位置给它们。
- en: 'Here are some RDL layout development references:'
  id: totrans-83
  prefs: []
  type: TYPE_NORMAL
  zh: 这里有一些 RDL 布局开发的参考资料：
- en: '| *Microsoft Dynamics NAV 2015 Professional Reporting* | Renders (Packt) |'
  id: totrans-84
  prefs: []
  type: TYPE_TB
  zh: '| *Microsoft Dynamics NAV 2015 专业报告* | Renders (Packt) |'
- en: '| *Microsoft Dynamics NAV 2009: Professional Reporting* | Renders (Packt) |'
  id: totrans-85
  prefs: []
  type: TYPE_TB
  zh: '| *Microsoft Dynamics NAV 2009: 专业报告* | Renders (Packt) |'
- en: '| *Microsoft Dynamics NAV 2009 INSIDE Reporting* | Gayer (Mbst) |'
  id: totrans-86
  prefs: []
  type: TYPE_TB
  zh: '| *Microsoft Dynamics NAV 2009 INSIDE 报告* | Gayer (Mbst) |'
- en: '| *Professional Microsoft SQL Server 2008 Reporting Services* | Misner (Microsoft)
    |'
  id: totrans-87
  prefs: []
  type: TYPE_TB
  zh: '| *专业的 Microsoft SQL Server 2008 报告服务* | Misner (Microsoft) |'
- en: Part 2.1 – Creating the RDL report header
  id: totrans-88
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 第2.1部分 – 创建 RDL 报告头部
- en: 'In this section, we will create the report header step by step:'
  id: totrans-89
  prefs: []
  type: TYPE_NORMAL
  zh: 在这一部分，我们将一步步创建报告头部：
- en: 'In the Report Builder, let''s set up the report properties: right-click anywhere
    in the gray development area and select Report Properties:'
  id: totrans-90
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在 Report Builder 中，让我们设置报告属性：右键点击灰色开发区域的任意位置，选择“报告属性”：
- en: '![](img/b28bff9b-4308-4f0e-a9c8-b2c6b9ce5e80.png)'
  id: totrans-91
  prefs: []
  type: TYPE_IMG
  zh: '![](img/b28bff9b-4308-4f0e-a9c8-b2c6b9ce5e80.png)'
- en: 'Change the Page Setup parameters, as follows:'
  id: totrans-92
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 修改“页面设置”参数，如下所示：
- en: '![](img/10c88efa-5995-4de5-a81c-7919313f59f9.png)'
  id: totrans-93
  prefs: []
  type: TYPE_IMG
  zh: '![](img/10c88efa-5995-4de5-a81c-7919313f59f9.png)'
- en: 'Let''s add a page header: right-click anywhere in the gray development area
    and select Add Page Header.'
  id: totrans-94
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 让我们添加一个页面头部：右键点击灰色开发区域的任意位置，选择“添加页面头部”。
- en: Right-click anywhere in the page header and select Header Properties.
  id: totrans-95
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 右键点击页面头部的任意位置，选择“头部属性”。
- en: 'Edit Page Header Properties as follows:'
  id: totrans-96
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 按如下方式编辑页面头部属性：
- en: '![](img/f1d5b3bb-42fd-4a20-b1ac-4f7bc38331b9.png)'
  id: totrans-97
  prefs: []
  type: TYPE_IMG
  zh: '![](img/f1d5b3bb-42fd-4a20-b1ac-4f7bc38331b9.png)'
- en: 'Click on the body section and change the body size property as follows:'
  id: totrans-98
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 点击正文部分并按如下方式修改正文大小属性：
- en: 'Width: 7.21205in'
  id: totrans-99
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 宽度：7.21205英寸
- en: 'Height: 1.93403in'
  id: totrans-100
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 高度：1.93403英寸
- en: Now, let's directly add some report item control to the header. Right-click
    anywhere in the report header and select Insert | TextBox in the page header.
    Perform this action six times.
  id: totrans-101
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 现在，让我们直接将一些报告项控件添加到头部。右键点击报告头部的任意位置，选择“插入 | 文本框”到页面头部。执行此操作六次。
- en: 'Change the following properties for the textboxes:'
  id: totrans-102
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 修改文本框的以下属性：
- en: '| **Name** | **Value** | **Size** | **Location** | **Font** | **Padding** |
    **CanGrow** | **TextAlign** | **VerticalAlign** |'
  id: totrans-103
  prefs: []
  type: TYPE_TB
  zh: '| **名称** | **值** | **大小** | **位置** | **字体** | **填充** | **是否可增长** | **文本对齐**
    | **垂直对齐** |'
- en: '| --- | --- | --- | --- | --- | --- | --- | --- | --- |'
  id: totrans-104
  prefs: []
  type: TYPE_TB
  zh: '| --- | --- | --- | --- | --- | --- | --- | --- | --- |'
- en: '| `txtReportName` | `=Parameters!BCReportName.Value` | `7.5 cm; 0.423 cm` |
    `0 cm; 0.0005 cm` | `Arial; 8 pt; Default; Bold; Default` | `0 pt; 0 pt; 0 pt;
    0 pt` | `False` | `Default` | `Middle` |'
  id: totrans-105
  prefs: []
  type: TYPE_TB
  zh: '| `txtReportName` | `=Parameters!BCReportName.Value` | `7.5 cm; 0.423 cm` |
    `0 cm; 0.0005 cm` | `Arial; 8 pt; Default; Bold; Default` | `0 pt; 0 pt; 0 pt;
    0 pt` | `False` | `Default` | `Middle` |'
- en: '| `txtCompanyName` | `=Fields!COMPANYNAME.Value` | `7.5 cm; 0.423 cm` | `0
    cm; 0.45878 cm` | `Arial; 7 pt; Default; Default; Default` | `0 pt; 0 pt; 0 pt;
    0 pt` | `False` | `Default` | `Middle` |'
  id: totrans-106
  prefs: []
  type: TYPE_TB
  zh: '| `txtCompanyName` | `=Fields!COMPANYNAME.Value` | `7.5 cm; 0.423 cm` | `0
    cm; 0.45878 cm` | `Arial; 7 pt; Default; Default; Default` | `0 pt; 0 pt; 0 pt;
    0 pt` | `False` | `Default` | `Middle` |'
- en: '| `txtExecutionTime` | `=Globals!ExecutionTime` | `3.15 cm; 0.423 cm` | `15
    cm; 0.0005 cm` | `Arial; 7 pt; Default; Default; Default` | `0 pt; 0 pt; 0 pt;
    0 pt` | `False` | `Right` | `Middle` |'
  id: totrans-107
  prefs: []
  type: TYPE_TB
  zh: '| `txtExecutionTime` | `=Globals!ExecutionTime` | `3.15 cm; 0.423 cm` | `15
    cm; 0.0005 cm` | `Arial; 7 pt; Default; Default; Default` | `0 pt; 0 pt; 0 pt;
    0 pt` | `False` | `Right` | `Middle` |'
- en: '| `txtPageNoLabel` | `=Parameters!PageNo.Value` | `1.25271 cm; 0.423 cm` |
    `16.44729 cm; 0.4235 cm` | `Arial; 7 pt; Default; Default; Default` | `0 pt; 0
    pt; 0 pt; 0 pt` | `False` | `Left` | `Middle` |'
  id: totrans-108
  prefs: []
  type: TYPE_TB
  zh: '| `txtPageNoLabel` | `=Parameters!PageNo.Value` | `1.25271 cm; 0.423 cm` |
    `16.44729 cm; 0.4235 cm` | `Arial; 7 pt; Default; Default; Default` | `0 pt; 0
    pt; 0 pt; 0 pt` | `False` | `Left` | `Middle` |'
- en: '| `txtPageNumber` | `=Globals!PageNumber` | `0.45 cm; 0.423 cm` | `17.7 cm;
    0.45878 cm` | `Arial; 7 pt; Default; Default; Default` | `0 pt; 0 pt; 0 pt; 0
    pt` | `False` | `Right` | `Middle` |'
  id: totrans-109
  prefs: []
  type: TYPE_TB
  zh: '| `txtPageNumber` | `=Globals!PageNumber` | `0.45 cm; 0.423 cm` | `17.7 cm;
    0.45878 cm` | `Arial; 7 pt; Default; Default; Default` | `0 pt; 0 pt; 0 pt; 0
    pt` | `False` | `Right` | `Middle` |'
- en: '| `txtUserID` | `=User!UserID` | `3.15 cm; 0.423 cm` | `14.8868 cm; 0.91298
    cm` | `Arial; 7 pt; Default; Default; Default` | `0 pt; 0 pt; 0 pt; 0 pt` | `False`
    | `Right` | `Middle` |'
  id: totrans-110
  prefs: []
  type: TYPE_TB
  zh: '| `txtUserID` | `=User!UserID` | `3.15 cm; 0.423 cm` | `14.8868 cm; 0.91298
    cm` | `Arial; 7 pt; Default; Default; Default` | `0 pt; 0 pt; 0 pt; 0 pt` | `False`
    | `Right` | `Middle` |'
- en: 'This is what it should look like in the report header section:'
  id: totrans-111
  prefs: []
  type: TYPE_NORMAL
  zh: 这就是报表标题部分的样子：
- en: '![](img/6f7908a0-4890-4689-9d5a-2550b6eb5182.png)'
  id: totrans-112
  prefs: []
  type: TYPE_IMG
  zh: '![](img/6f7908a0-4890-4689-9d5a-2550b6eb5182.png)'
- en: Part 2.2 – Adding a table control to the RDLC report body
  id: totrans-113
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 第二部分 2.2 – 向 RDLC 报表主体添加表格控件
- en: 'In this section, we will add a table control in the report body to display
    data in a tabular format:'
  id: totrans-114
  prefs: []
  type: TYPE_NORMAL
  zh: 在本节中，我们将在报表主体中添加一个表格控件，以便以表格格式显示数据：
- en: Right-click somewhere in the middle of the report body and choose Insert. Select
    the Table control from the menu. Keep the table small since we will need to add
    some extra columns and resize the width manually.
  id: totrans-115
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在报表主体中某个位置右键点击并选择插入。然后从菜单中选择“表格控件”。保持表格较小，因为我们将需要添加一些额外的列并手动调整宽度。
- en: 'Select the last table column, right-click and select Insert Column, and choose
    Right:'
  id: totrans-116
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 选择最后一列，右键点击并选择插入列，选择右侧：
- en: '![](img/ae36b7b4-645c-4026-ad0c-d4d8c8750c67.png)'
  id: totrans-117
  prefs: []
  type: TYPE_IMG
  zh: '![](img/ae36b7b4-645c-4026-ad0c-d4d8c8750c67.png)'
- en: Repeat *step 2* three more times so that we have seven columns in total.
  id: totrans-118
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 重复*步骤 2*三次，以便总共添加七列。
- en: 'Keep the table aligned by changing the following table properties:'
  id: totrans-119
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 通过更改以下表格属性保持表格对齐：
- en: 'Location: 0.02584 in; 0.18403in'
  id: totrans-120
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 位置：0.02584 in; 0.18403in
- en: 'Size: 7.06693 in; 0.48958in'
  id: totrans-121
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 尺寸：7.06693 in; 0.48958in
- en: 'Change the column width property for each column, from left to right, as follows:'
  id: totrans-122
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 更改每列的列宽属性，从左到右如下：
- en: '| **Column** | **1** | **2** | **3** | **4** | **5** | **6** | **7** |'
  id: totrans-123
  prefs: []
  type: TYPE_TB
  zh: '| **列** | **1** | **2** | **3** | **4** | **5** | **6** | **7** |'
- en: '| --- | --- | --- | --- | --- | --- | --- | --- |'
  id: totrans-124
  prefs: []
  type: TYPE_TB
  zh: '| --- | --- | --- | --- | --- | --- | --- | --- |'
- en: '| Width (cm) | 1,905 | 2,222 | 2,593 | 2,990 | 3,373 | 2,620 | 1,798 |'
  id: totrans-125
  prefs: []
  type: TYPE_TB
  zh: '| 宽度 (cm) | 1,905 | 2,222 | 2,593 | 2,990 | 3,373 | 2,620 | 1,798 |'
- en: 'This should be the current layout result:'
  id: totrans-126
  prefs: []
  type: TYPE_NORMAL
  zh: 这应该是当前布局结果：
- en: '![](img/c9b5410b-12ed-4799-b084-aa6e433ecf27.png)'
  id: totrans-127
  prefs: []
  type: TYPE_IMG
  zh: '![](img/c9b5410b-12ed-4799-b084-aa6e433ecf27.png)'
- en: It is now time to set the table properties appropriately and bind them to the
    Dynamics 365 Business Central dataset. Select the table (once you have clicked
    on the table, a gray column/row area appears, and in a Microsoft Excel-like style,
    just click in the top left of this area to select the whole table).
  id: totrans-128
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 现在是时候适当设置表格属性，并将它们绑定到 Dynamics 365 Business Central 数据集。选择表格（点击表格后，会出现一个灰色的列/行区域，类似
    Microsoft Excel 风格，只需点击该区域的左上角即可选择整个表格）。
- en: In the Properties window, click the Property Pages button.
  id: totrans-129
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在属性窗口中，点击属性页面按钮。
- en: 'Change the values in the General tab as follows and click OK:'
  id: totrans-130
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在常规选项卡中更改以下值，并点击确定：
- en: 'Name: `tableItemLedgerEntry`'
  id: totrans-131
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 名称：`tableItemLedgerEntry`
- en: 'Dataset name: `Dataset_Result`'
  id: totrans-132
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 数据集名称：`Dataset_Result`
- en: Now, the table is bound to the appropriate dataset and it has a self-explanatory
    name. Giving an appropriate name to every single control in the RDL layout is
    useful because you can find out the purpose of the control and where it is located at
    a glance. Now, let's bind every table control to the dataset caption and field
    values.
  id: totrans-133
  prefs: []
  type: TYPE_NORMAL
  zh: 现在，表格已绑定到相应的数据集，并且具有自解释的名称。为RDL布局中的每个控件命名是非常有用的，因为你可以一眼看出控件的用途及其位置。现在，让我们将每个表格控件绑定到数据集的标题和字段值。
- en: 'For every single text box in the first row of the table (the table header row),
    open the Property Pages window and change the Value property of the first seven
    table header textboxes, as follows:'
  id: totrans-134
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 对表格的第一行（表头行）中的每个文本框，打开属性页面窗口并按如下方式更改前七个表头文本框的值属性：
- en: '| `txtItemNoCap` | `=Parameters!ItemNo_ItemLedgerEntryCaption.Value` |'
  id: totrans-135
  prefs: []
  type: TYPE_TB
  zh: '| `txtItemNoCap` | `=Parameters!ItemNo_ItemLedgerEntryCaption.Value` |'
- en: '| `txtPostingDateCap` | `=Parameters!PostingDate_ItemLedgerEntryCaption.Value`
    |'
  id: totrans-136
  prefs: []
  type: TYPE_TB
  zh: '| `txtPostingDateCap` | `=Parameters!PostingDate_ItemLedgerEntryCaption.Value`
    |'
- en: '| `txtCustCatPKTCap` | `=Parameters!CustCatPKT_ItemLedgerEntryCaption.Value`
    |'
  id: totrans-137
  prefs: []
  type: TYPE_TB
  zh: '| `txtCustCatPKTCap` | `=Parameters!CustCatPKT_ItemLedgerEntryCaption.Value`
    |'
- en: '| `txtDocumentNoCap` | `=Parameters!DocumentNo_ItemLedgerEntryCaption.Value`
    |'
  id: totrans-138
  prefs: []
  type: TYPE_TB
  zh: '| `txtDocumentNoCap` | `=Parameters!DocumentNo_ItemLedgerEntryCaption.Value`
    |'
- en: '| `txtDescriptionCap` | `=Parameters!Description_ItemLedgerEntryCaption.Value`
    |'
  id: totrans-139
  prefs: []
  type: TYPE_TB
  zh: '| `txtDescriptionCap` | `=Parameters!Description_ItemLedgerEntryCaption.Value`
    |'
- en: '| `txtLocationCodeCap` | `=Parameters!LocationCode_ItemLedgerEntryCaption.Value`
    |'
  id: totrans-140
  prefs: []
  type: TYPE_TB
  zh: '| `txtLocationCodeCap` | `=Parameters!LocationCode_ItemLedgerEntryCaption.Value`
    |'
- en: '| `txtQuantityCap` | `=Parameters!Quantity_ItemLedgerEntryCaption.Value` |'
  id: totrans-141
  prefs: []
  type: TYPE_TB
  zh: '| `txtQuantityCap` | `=Parameters!Quantity_ItemLedgerEntryCaption.Value` |'
- en: 'Let''s bind table body text box controls to the dataset fields. For every text
    box in the second row of the table (the table body), open the Property Pages window
    and change the following properties:'
  id: totrans-142
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 让我们将表格主体文本框控件绑定到数据集字段。对于表格第二行（表格主体）中的每个文本框，打开属性页面窗口并更改以下属性：
- en: '| **Name** | **Value** | **Format** |'
  id: totrans-143
  prefs: []
  type: TYPE_TB
  zh: '| **名称** | **值** | **格式** |'
- en: '| `txtItemNo` | `=Fields!ItemNo_ItemLedgerEntry.Value` |  |'
  id: totrans-144
  prefs: []
  type: TYPE_TB
  zh: '| `txtItemNo` | `=Fields!ItemNo_ItemLedgerEntry.Value` |  |'
- en: '| `txtPostingDate` | `=Fields!PostingDate_ItemLedgerEntry.Value` |  |'
  id: totrans-145
  prefs: []
  type: TYPE_TB
  zh: '| `txtPostingDate` | `=Fields!PostingDate_ItemLedgerEntry.Value` |  |'
- en: '| `txtCustCatPKT` | `=Fields!CustCatPKT_ItemLedgerEntry.Value` |  |'
  id: totrans-146
  prefs: []
  type: TYPE_TB
  zh: '| `txtCustCatPKT` | `=Fields!CustCatPKT_ItemLedgerEntry.Value` |  |'
- en: '| `txtDocumentNo` | `=Fields!DocumentNo_ItemLedgerEntry.Value` |  |'
  id: totrans-147
  prefs: []
  type: TYPE_TB
  zh: '| `txtDocumentNo` | `=Fields!DocumentNo_ItemLedgerEntry.Value` |  |'
- en: '| `txtDescription` | `=Fields!Description_ItemLedgerEntry.Value` |  |'
  id: totrans-148
  prefs: []
  type: TYPE_TB
  zh: '| `txtDescription` | `=Fields!Description_ItemLedgerEntry.Value` |  |'
- en: '| `txtLocationCode` | `=Fields!LocationCode_ItemLedgerEntry.Value` |  |'
  id: totrans-149
  prefs: []
  type: TYPE_TB
  zh: '| `txtLocationCode` | `=Fields!LocationCode_ItemLedgerEntry.Value` |  |'
- en: '| `txtQuantity` | `=Fields!Quantity_ItemLedgerEntry.Value` | `=Fields!Quantity_ItemLedgerEntryFormat.Value`
    |'
  id: totrans-150
  prefs: []
  type: TYPE_TB
  zh: '| `txtQuantity` | `=Fields!Quantity_ItemLedgerEntry.Value` | `=Fields!Quantity_ItemLedgerEntryFormat.Value`
    |'
- en: 'Create an alternate line color to make it easier to read. In the table details,
    select the seven textboxes mentioned in the previous table and add the following
    values to the following properties in each of these textboxes:'
  id: totrans-151
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 创建交替行颜色，使其更易于阅读。在表格详细信息中，选择之前表格中提到的七个文本框，并在每个文本框的相应属性中添加以下值：
- en: 'Background Color: `=iif(RowNumber(Nothing) mod 2, "AliceBlue", "White")`'
  id: totrans-152
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '背景颜色: `=iif(RowNumber(Nothing) mod 2, "AliceBlue", "White")`'
- en: 'TextAlign: Right'
  id: totrans-153
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 'TextAlign: 右对齐'
- en: 'Conditionally format the Color property for the `txtQuantity` text box. Select
    `txtQuantity` and change the Color property as follows:'
  id: totrans-154
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 条件格式化`txtQuantity`文本框的颜色属性。选择`txtQuantity`并按如下方式更改颜色属性：
- en: 'Color: `=iif(Fields!Quantity_ItemLedgerEntry.Value <= 0,"Red","Black")`'
  id: totrans-155
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '颜色: `=iif(Fields!Quantity_ItemLedgerEntry.Value <= 0,"Red","Black")`'
- en: Enable the ability to display the table header at the beginning of every page
    to improve report readability. Click on the small down arrow in Column Groups and
    enable Advanced Mode.
  id: totrans-156
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 启用在每一页的开头显示表头的功能，以提高报告的可读性。点击列组中的小箭头并启用高级模式。
- en: 'Select the (Static) group in Row Groups:'
  id: totrans-157
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 选择行组中的(Static)组：
- en: '![](img/944df101-012d-4af3-a704-401f853db6e4.png)'
  id: totrans-158
  prefs: []
  type: TYPE_IMG
  zh: '![](img/944df101-012d-4af3-a704-401f853db6e4.png)'
- en: 'Change the properties for the (Static) group as follows:'
  id: totrans-159
  prefs: []
  type: TYPE_NORMAL
  zh: 更改(Static)组的属性如下：
- en: 'KeepTogether: True'
  id: totrans-160
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '保持在一起: True'
- en: 'RepeatOnNewPage: True'
  id: totrans-161
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 'RepeatOnNewPage: True'
- en: Part 3 – Understanding grouping
  id: totrans-162
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 第3部分 – 理解分组
- en: With the term **grouping**, we mean the capacity of aggregate result sets based
    on one or more discriminant elements. Grouping is typically used to show totals
    per group and/or aggregate and calculate totals (typically using sum formulas).
    The grouping feature is used typically within controls that implement the data
    region scope, such as table, matrix, list, chart, and gauge.
  id: totrans-163
  prefs: []
  type: TYPE_NORMAL
  zh: 在“**分组**”一词中，我们指的是基于一个或多个判别元素的聚合结果集的能力。分组通常用于显示每组的总计和/或聚合并计算总计（通常使用求和公式）。分组功能通常用于实现数据区域范围的控件中，如表格、矩阵、列表、图表和仪表。
- en: 'In this section, we will create group totals for the table control of our report:'
  id: totrans-164
  prefs: []
  type: TYPE_NORMAL
  zh: 在本节中，我们将为报告的表格控件创建组总计：
- en: In the Row Groups section, right-click on the (Details) static row group and
    select Add Group. Choose Parent Group….
  id: totrans-165
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在“行组”部分，右键点击（详细信息）静态行组并选择添加组。选择父组...。
- en: 'A pop-up window should appear, asking you to provide a grouping element. Select
    the [ItemNo_ItemLedgerEntry] field value and choose to add both a group header
    and a group footer. Then, click OK:'
  id: totrans-166
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 应该出现一个弹出窗口，要求您提供一个分组元素。选择 [ItemNo_ItemLedgerEntry] 字段值，并选择同时添加组头和组尾。然后点击确定：
- en: '![](img/32963939-7ab1-4f44-b2cd-f7652c6cee19.png)'
  id: totrans-167
  prefs: []
  type: TYPE_IMG
  zh: '![](img/32963939-7ab1-4f44-b2cd-f7652c6cee19.png)'
- en: Select the group we've just created (typically named `ItemNo_ItemLedgerEntry`
    by default), right-click, and select Group Properties….
  id: totrans-168
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 选择我们刚刚创建的分组（默认情况下通常命名为 `ItemNo_ItemLedgerEntry`），右键点击，选择“组属性...”。
- en: In the Group Properties window, change the name to `ItemNoGroup` and click OK.
  id: totrans-169
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在“组属性”窗口中，将名称更改为 `ItemNoGroup`，然后点击确定。
- en: Select ItemNoGroup, right-click, and select Add Group and Child Group….
  id: totrans-170
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 选择 `ItemNoGroup`，右键点击，选择“添加组和子组...”。
- en: A pop-up window appears, asking you to provide a grouping element. Select CustCatPKT_ItemLedgerEntry,
    choose to add just the group header (no group footer), and click OK.
  id: totrans-171
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 弹出窗口出现，要求您提供一个分组元素。选择 `CustCatPKT_ItemLedgerEntry`，选择仅添加组头（不添加组尾），然后点击确定。
- en: Select the group we've just created, right-click, and select Group Properties….
  id: totrans-172
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 选择我们刚刚创建的分组，右键点击，选择“组属性...”。
- en: 'In the Group Properties window, change the Name to `CustCatPKTNoGroup`. Then,
    go to the Advanced tab and set CustCatPKT_ItemLedgerEntry in the Recursive Parent box.
    Click OK to confirm this:'
  id: totrans-173
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在“组属性”窗口中，将名称更改为 `CustCatPKTNoGroup`。然后，转到高级选项卡并在递归父项框中设置 `CustCatPKT_ItemLedgerEntry`。点击确定确认：
- en: '![](img/0741b61b-daeb-47b3-9715-49efb70a0d9f.png)'
  id: totrans-174
  prefs: []
  type: TYPE_IMG
  zh: '![](img/0741b61b-daeb-47b3-9715-49efb70a0d9f.png)'
- en: All of these operations should have created, by default, two extra unwanted
    columns in the table to display grouping elements. Select the first two columns
    and then right-click and choose Delete Column***s***.
  id: totrans-175
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 所有这些操作应该默认创建了两个额外的不需要的列以显示分组元素。选择前两列，右键点击并选择删除列***s***。
- en: 'The automatic action of adding two extra columns should have automatically
    enlarged the Report Body: bring this back to its original size. Set the following
    value:'
  id: totrans-176
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 添加两个额外列的自动操作应该自动放大了报告正文：将其恢复到原始大小。设置以下值：
- en: 'Size: 7.21205in; 1.93403in'
  id: totrans-177
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '大小: 7.21205英寸; 1.93403英寸'
- en: 'Let''s add group caption labels. Select the first text box in the ItemNoGroup header
    row, as shown in the following screenshot:'
  id: totrans-178
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 现在让我们添加组标题标签。选择 `ItemNoGroup` 头行中的第一个文本框，如下图所示：
- en: '![](img/79c73257-43a3-4553-952a-813d6ed4ea3f.png)'
  id: totrans-179
  prefs: []
  type: TYPE_IMG
  zh: '![](img/79c73257-43a3-4553-952a-813d6ed4ea3f.png)'
- en: 'Change its properties as follows:'
  id: totrans-180
  prefs: []
  type: TYPE_NORMAL
  zh: 修改其属性如下：
- en: '**Name**: `txtItemNoGroup`'
  id: totrans-181
  prefs:
  - PREF_UL
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**名称**: `txtItemNoGroup`'
- en: '**Value**: `=Fields!ItemNo_ItemLedgerEntry.Value`'
  id: totrans-182
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**值**: `=Fields!ItemNo_ItemLedgerEntry.Value`'
- en: '**BackgroundColor**: `LightBlue`'
  id: totrans-183
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**背景颜色**: `LightBlue`'
- en: 'Select the third text box in the `SourceNoGroup` header column and change its
    properties as follows:'
  id: totrans-184
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 选择 `SourceNoGroup` 头列中的第三个文本框，并修改其属性如下：
- en: '**Name**: `txtCustCatPKTGroup`'
  id: totrans-185
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**名称**: `txtCustCatPKTGroup`'
- en: '**Value**: `=Fields!CustCatPKT_ItemLedgerEntry.Value`'
  id: totrans-186
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**值**: `=Fields!CustCatPKT_ItemLedgerEntry.Value`'
- en: '**BackgroundColor**: `LightSteelBlue`'
  id: totrans-187
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**背景颜色**: `LightSteelBlue`'
- en: 'Select the last text box in the bottom right, in the `ItemNoGroup` footer row,
    and change its properties as follows:'
  id: totrans-188
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 选择底部右侧 `ItemNoGroup` 页脚行中的最后一个文本框，并修改其属性如下：
- en: '**Name**: `txtSumQuantity`'
  id: totrans-189
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**名称**: `txtSumQuantity`'
- en: '**Value**: `=Sum(Fields!Quantity_ItemLedgerEntry.Value)`'
  id: totrans-190
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**值**: `=Sum(Fields!Quantity_ItemLedgerEntry.Value)`'
- en: '**Color**: `=iif(Sum(Fields!Quantity_ItemLedgerEntry.Value) <= 0,"Red","Black")`'
  id: totrans-191
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**颜色**: `=iif(Sum(Fields!Quantity_ItemLedgerEntry.Value) <= 0,"红色","黑色")`'
- en: '**Font**: `Arial; 10pt; Default; Bold; Default`'
  id: totrans-192
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**字体**: `Arial; 10pt; 默认; 粗体; 默认`'
- en: '**Format**: `` `=Fields!Quantity_ItemLedgerEntryFormat.Value` ``'
  id: totrans-193
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**格式**: `` `=Fields!Quantity_ItemLedgerEntryFormat.Value` ``'
- en: Now, for the rest of the textboxes in all the grouping rows (both headers and
    footers), remove the `BackgroundColor` formula, `=iif(RowNumber(Nothing) mod 2,
    "AliceBlue", "White")`, that has been automatically copied from the details group.
    When the formula is deleted from the Properties window, BackGroundColor will default
    to No Color.
  id: totrans-194
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 现在，对于所有分组行中的其余文本框（包括页头和页脚），请删除自动从详细信息组复制过来的`BackgroundColor`公式，`=iif(RowNumber(Nothing)
    mod 2, "AliceBlue", "White")`。当从属性窗口中删除公式时，BackgroundColor将默认为无颜色。
- en: 'We are almost finished with groupings. Let''s add the last touch to the totals.
    Select the sixth text box in the ItemNoGroup footer row, click on the Property
    Pages pop-up window for this text box, and change the Border properties, as shown
    in the following screenshot:'
  id: totrans-195
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 我们几乎完成了分组工作。让我们为总计部分添加最后的修饰。在ItemNoGroup页脚行中选择第六个文本框，点击该文本框的属性页面弹出窗口，并更改边框属性，如下图所示：
- en: '![](img/f1432618-b757-4802-950d-ea474f97b5de.png)'
  id: totrans-196
  prefs: []
  type: TYPE_IMG
  zh: '![](img/f1432618-b757-4802-950d-ea474f97b5de.png)'
- en: Repeat *step 15* for the seventh text box (`txtSumQuantity`).
  id: totrans-197
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 对第七个文本框（`txtSumQuantity`）重复*步骤15*。
- en: 'Enable the ability to display the table header if there is more than one page
    to be rendered. Click on the small down arrow in Column Groups and enable Advanced
    Mode. Select the (Static) group in Row Groups and change the properties of the
    Static member, as follows:'
  id: totrans-198
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 启用在呈现多页时显示表头的功能。点击列组中的小下拉箭头并启用高级模式。选择行组中的（静态）组，并更改静态成员的属性，如下所示：
- en: '****KeepTogether: `True`****'
  id: totrans-199
  prefs:
  - PREF_UL
  - PREF_UL
  type: TYPE_NORMAL
  zh: '****KeepTogether: `True`****'
- en: '**KeepWithGroup**: `After`'
  id: totrans-200
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**KeepWithGroup**：`After`'
- en: '**RepeatOnNewPage**: `True`'
  id: totrans-201
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**RepeatOnNewPage**：`True`'
- en: Part 4 – Building a simple request page
  id: totrans-202
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 第四部分 – 构建一个简单的请求页面
- en: If report objects have been set with `UseRequestPage = true;` (the default value),
    then a request page will be shown to the user so that they can set filters, gather
    user information, and populate AL variables or parameters that influence the processing and output
    of the report.
  id: totrans-203
  prefs: []
  type: TYPE_NORMAL
  zh: 如果报告对象已设置`UseRequestPage = true;`（默认值），那么将显示一个请求页面，让用户可以设置过滤器、收集用户信息，并填充影响报告处理和输出的AL变量或参数。
- en: Within a request page, you can also add actions to perform some extra activities
    before running the report. Typical examples include a shortcut to run a page to
    check for some specific setup or an action that performs preprocessing tasks before
    setting request page variables.
  id: totrans-204
  prefs: []
  type: TYPE_NORMAL
  zh: 在请求页面中，您还可以添加动作以在运行报告之前执行一些额外的活动。典型示例包括运行一个页面的快捷方式以检查某些特定设置，或者在设置请求页面变量之前执行预处理任务的动作。
- en: 'In Visual Studio Code, add (or change, if you have used the `treport` snippet)
    the `requestpage` section and the `OnPreReport()` trigger section. Consider the
    following code:'
  id: totrans-205
  prefs: []
  type: TYPE_NORMAL
  zh: 在Visual Studio Code中，添加（或如果您使用过`treport`片段，则更改）`requestpage`部分和`OnPreReport()`触发器部分。参考以下代码：
- en: '[PRE3]'
  id: totrans-206
  prefs: []
  type: TYPE_PRE
  zh: '[PRE3]'
- en: Part 5 – Adding database images
  id: totrans-207
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 第五部分 – 添加数据库图片
- en: 'In this section, we will add the ability to display images at runtime to our
    report:'
  id: totrans-208
  prefs: []
  type: TYPE_NORMAL
  zh: 在本节中，我们将为报告添加在运行时显示图像的功能：
- en: Go back to Report Builder and the RDL layout. In the center of the report header,
    right-click and select Insert | Image.
  id: totrans-209
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 返回到报告生成器和RDL布局。在报告头部的中间，右键单击并选择“插入 | 图像”。
- en: 'The Image Properties pop-up window will load. In the General tab, change the
    Name to `imgCompanyLogo` and input the parameters shown in the following screenshot:'
  id: totrans-210
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: “图像属性”弹出窗口将加载。在“常规”选项卡中，将名称更改为`imgCompanyLogo`，并输入下图所示的参数：
- en: '![](img/3ce9d348-3a78-4439-bc54-a7efea6dcbe7.png)'
  id: totrans-211
  prefs: []
  type: TYPE_IMG
  zh: '![](img/3ce9d348-3a78-4439-bc54-a7efea6dcbe7.png)'
- en: 'In the Visibility tab, change the display option to Show or hide based on an
    expression and add the following formula:'
  id: totrans-212
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在“可见性”选项卡中，将显示选项更改为基于表达式显示或隐藏，并添加以下公式：
- en: '[PRE4]'
  id: totrans-213
  prefs: []
  type: TYPE_PRE
  zh: '[PRE4]'
- en: This expression sets the visibility of the image control if the user has chosen
    to include the company logo and if the conversion from binary format into text
    returns values greater than 0 bytes (in short, if there is image data in the dataset).
  id: totrans-214
  prefs: []
  type: TYPE_NORMAL
  zh: 此表达式设置图像控件的可见性，如果用户选择包含公司徽标，并且从二进制格式转换为文本的结果返回大于0字节的值（简而言之，如果数据集中有图像数据）。
- en: Click OK to confirm the modifications you've made.
  id: totrans-215
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 点击“确定”以确认您所做的修改。
- en: 'Set the image control''s location and size as follows:'
  id: totrans-216
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 设置图像控件的位置和大小如下：
- en: 'Location: 3,29875in; 0in'
  id: totrans-217
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 位置：3.29875英寸；0英寸
- en: 'Size: 2,42708in; 0,56578in'
  id: totrans-218
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 大小：2.42708英寸；0.56578英寸
- en: 'The final report layout should now look like this:'
  id: totrans-219
  prefs: []
  type: TYPE_NORMAL
  zh: 最终的报告布局应如下所示：
- en: '![](img/8fb06638-46c7-45be-ba58-c43b3b483e7b.png)'
  id: totrans-220
  prefs: []
  type: TYPE_IMG
  zh: '![](img/8fb06638-46c7-45be-ba58-c43b3b483e7b.png)'
- en: 'The RDL report and its layout are now ready to be deployed. Compile the extension
    (*Ctrl* + *Shift* + *B*) and deploy the package into your online or containerized
    sandbox (*F5*). Once the web client is loading, just search (*Alt* + *Q*) for
    the Item Ledger Entry Analysis report and fill in the request page if you want
    to include the company logo in the report''s output:'
  id: totrans-221
  prefs: []
  type: TYPE_NORMAL
  zh: RDL 报告及其布局现已准备好进行部署。编译扩展（*Ctrl* + *Shift* + *B*）并将包部署到您的在线或容器化沙箱中（*F5*）。一旦网页客户端加载完成，只需搜索（*Alt*
    + *Q*）项目分类账条目分析报告，如果您希望在报告输出中包括公司徽标，可以填写请求页面：
- en: '![](img/090a6a56-5bb2-4496-bdca-48feddb83f77.png)'
  id: totrans-222
  prefs: []
  type: TYPE_IMG
  zh: '![](img/090a6a56-5bb2-4496-bdca-48feddb83f77.png)'
- en: 'If you click Preview, the output should look as follows:'
  id: totrans-223
  prefs: []
  type: TYPE_NORMAL
  zh: 如果点击预览，输出应如下所示：
- en: '![](img/8bd9612d-895d-404c-aa22-22057e1c942a.png)'
  id: totrans-224
  prefs: []
  type: TYPE_IMG
  zh: '![](img/8bd9612d-895d-404c-aa22-22057e1c942a.png)'
- en: Part 6 – Adding a Word layout
  id: totrans-225
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 第六部分 – 添加 Word 布局
- en: 'In this section, together with the RDL layout, we will also add a Word layout
    to our report:'
  id: totrans-226
  prefs: []
  type: TYPE_NORMAL
  zh: 在本节中，除了 RDL 布局，我们还将向报告中添加一个 Word 布局：
- en: Go to Report Layout Selection and filter for report ID 50111.
  id: totrans-227
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 转到报告布局选择并筛选报告 ID 50111。
- en: Select Actions | Custom Layouts.
  id: totrans-228
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 选择操作 | 自定义布局。
- en: Click New, select Insert Word layout, and click OK. This will add an empty Word
    layout to the report and reference the dataset structure as an XML mapping.
  id: totrans-229
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 点击新建，选择插入 Word 布局，然后点击确定。这将向报告中添加一个空的 Word 布局，并将数据集结构作为 XML 映射进行引用。
- en: Choose Process | Export Layout and save the `Default.docx` report into the `.\Src\CustomerCategory\report`
    folder. You might call the report layout `Rep50111.ItemLedgerEntryAnalysis.docx`.
  id: totrans-230
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 选择处理 | 导出布局并将 `Default.docx` 报告保存到 `.\Src\CustomerCategory\report` 文件夹中。您可以将报告布局命名为
    `Rep50111.ItemLedgerEntryAnalysis.docx`。
- en: 'Bind the report to the RDL layout within the extension, change the default
    layout to Word, and change record sorting by specifying the following report properties
    in the AL report object. Consider the following code:'
  id: totrans-231
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将报告绑定到扩展中的 RDL 布局，改变默认布局为 Word，并通过在 AL 报告对象中指定以下报告属性来更改记录排序。考虑以下代码：
- en: '[PRE5]'
  id: totrans-232
  prefs: []
  type: TYPE_PRE
  zh: '[PRE5]'
- en: In Visual Studio Code, right-click the DOCX file and choose Open externally.
    This will open Microsoft Word.
  id: totrans-233
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在 Visual Studio Code 中，右键点击 DOCX 文件并选择外部打开。这将打开 Microsoft Word。
- en: 'If you haven''t already, be sure that you have the Developer tab enabled. Click
    on File | Options | Customize Ribbon. In the main tab, check the Developer (custom) ribbon
    option and click OK:'
  id: totrans-234
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 如果您还没有启用开发人员选项卡，请确保已启用。点击文件 | 选项 | 自定义功能区。在主选项卡中，勾选开发人员（自定义）功能区选项并点击确定：
- en: '![](img/16916810-f51c-4084-b48f-cdb8c00cd5c8.png)'
  id: totrans-235
  prefs: []
  type: TYPE_IMG
  zh: '![](img/16916810-f51c-4084-b48f-cdb8c00cd5c8.png)'
- en: Back in the Word layout, select the Developer tab and click on the XML Mapping
    pane.
  id: totrans-236
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 返回 Word 布局，选择开发人员选项卡并点击 XML 映射窗格。
- en: In the Custom XML Part box, select the last entry from the drop-down menu and
    expand the Labels and Item_Ledger_Entry nodes from the NavWorldReportXMLPart root.
  id: totrans-237
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在自定义 XML 部分框中，从下拉菜单中选择最后一个条目，并展开 NavWorldReportXMLPart 根目录下的标签和 Item_Ledger_Entry
    节点。
- en: 'It should look like this:'
  id: totrans-238
  prefs: []
  type: TYPE_NORMAL
  zh: 它应如下所示：
- en: '![](img/0704991b-dcb7-4dd9-80fd-82e1699d3f36.png)'
  id: totrans-239
  prefs: []
  type: TYPE_IMG
  zh: '![](img/0704991b-dcb7-4dd9-80fd-82e1699d3f36.png)'
- en: 'Let''s add a Word layout list report to our extension:'
  id: totrans-240
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们为扩展添加一个 Word 布局列表报告：
- en: Right-click in the XML Mapping pane, select Item_Ledger_Entry the drop-down
    menu, and choose CompanyInformation_Picture. Right-click on it and select Insert
    Content Control | Picture. This will add a placeholder for the company information
    logo in the Word layout.
  id: totrans-241
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在 XML 映射窗格中右键点击，选择 Item_Ledger_Entry 下拉菜单，并选择 CompanyInformation_Picture。右键点击它，选择插入内容控件
    | 图片。这将为公司信息徽标在 Word 布局中添加占位符。
- en: Add an extra line. Right-click in the XML Mapping pane, select Labels, and choose
    BCReportName**.** Right-click on it and select Insert Content Control | Plain
    Text.
  id: totrans-242
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 添加一行。在 XML 映射窗格中右键点击，选择标签，并选择 BCReportName**。**右键点击它，选择插入内容控件 | 纯文本。
- en: Add an extra line. Right-click in the XML Mapping pane, select the Item_Ledger_Entry
    drop-down menu, and choose COMPANYNAME. Right-click on it and select Insert Content
    Control | Plain Text.
  id: totrans-243
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 添加一行。在 XML 映射窗格中右键点击，选择 Item_Ledger_Entry 下拉菜单，并选择 COMPANYNAME。右键点击它，选择插入内容控件
    | 纯文本。
- en: Add an extra line. In the Word ribbon, click on Insert | Table and create a
    7-row x 2-column table.
  id: totrans-244
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 添加一行。在 Word 功能区，点击插入 | 表格，并创建一个 7 行 2 列的表格。
- en: 'In the first row, for each cell, place the cursor in the XML Mapping pane,
    select Labels, right-click in each caption element, and select Insert Content
    Control | Plain Text. Here is a list of the column captions:'
  id: totrans-245
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在第一行，对于每个单元格，将光标放在 XML 映射窗格中，选择标签，右键点击每个标题元素，选择插入内容控件 | 纯文本。以下是列标题的列表：
- en: ItemNo_ItemLedgerEntryCaption
  id: totrans-246
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: ItemNo_ItemLedgerEntryCaption
- en: PostingDate_ItemLedgerEntryCaption
  id: totrans-247
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: PostingDate_ItemLedgerEntryCaption
- en: CustCatPKT_ItemLedgerEntryCaption
  id: totrans-248
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: CustCatPKT_ItemLedgerEntryCaption
- en: DocumentNo_ItemLedgerEntryCaption
  id: totrans-249
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: DocumentNo_ItemLedgerEntryCaption
- en: Description_ItemLedgerEntryCaption
  id: totrans-250
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: Description_ItemLedgerEntryCaption
- en: LocationCode_ItemLedgerEntryCaption
  id: totrans-251
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: LocationCode_ItemLedgerEntryCaption
- en: Quantity_ItemLedgerEntryCaption
  id: totrans-252
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: Quantity_ItemLedgerEntryCaption
- en: Select the second row of the table. In the XML Mapping pane, select Item_Ledger_Entry
    element, right-click on it, and select Insert Content Control | Repeating. This
    will make the line elements repeat for every record in the Item Ledger Entry dataset.
  id: totrans-253
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 选择表格的第二行。在XML映射窗格中，选择Item_Ledger_Entry元素，右键单击它，然后选择“插入内容控件 | 重复”。这将使行元素在Item
    Ledger Entry数据集中的每个记录上重复。
- en: 'In the second row, inside the repeater element, place the cursor in every cell
    in the XML Mapping pane, expand the Item_Ledger_Entry drop-down menu, right-click
    in the field element, and select Insert Content Control | Plain Text. Here is
    a list of the column fields:'
  id: totrans-254
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在第二行的重复元素内，在XML映射窗格中的每个单元格中放置光标，展开“Item_Ledger_Entry”下拉菜单，右键单击字段元素，然后选择“插入内容控件
    | 纯文本”。以下是列字段的列表：
- en: ItemNo_ItemLedgerEntry
  id: totrans-255
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: ItemNo_ItemLedgerEntry
- en: PostingDate_ItemLedgerEntry
  id: totrans-256
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: PostingDate_ItemLedgerEntry
- en: CustCatPKT_ItemLedgerEntry
  id: totrans-257
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: CustCatPKT_ItemLedgerEntry
- en: DocumentNo_ItemLedgerEntry
  id: totrans-258
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: DocumentNo_ItemLedgerEntry
- en: Description_ItemLedgerEntry
  id: totrans-259
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: Description_ItemLedgerEntry
- en: LocationCode_ItemLedgerEntry
  id: totrans-260
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: LocationCode_ItemLedgerEntry
- en: Quantity_ItemLedgerEntry
  id: totrans-261
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: Quantity_ItemLedgerEntry
- en: 'This will be the result:'
  id: totrans-262
  prefs: []
  type: TYPE_NORMAL
  zh: 结果如下：
- en: '![](img/7005be50-9cef-4320-92dc-1305e328c1a8.png)'
  id: totrans-263
  prefs: []
  type: TYPE_IMG
  zh: '![](img/7005be50-9cef-4320-92dc-1305e328c1a8.png)'
- en: Save and close the Word file.
  id: totrans-264
  prefs: []
  type: TYPE_NORMAL
  zh: 保存并关闭Word文件。
- en: 'The Word layout is now ready to be deployed. Build the extension (*Ctrl* +
    *Shift* + *B*) and deploy the package into your online or containerized sandbox
    (*F5*). Once the web client is loading, search (*Alt* + *Q*) for Report Layout
    Selection, filter for the current report, and change the selected layout to Word
    (built-in), as shown here:'
  id: totrans-265
  prefs: []
  type: TYPE_NORMAL
  zh: 现在，Word布局已经准备好部署。构建扩展（*Ctrl* + *Shift* + *B*），并将包部署到在线或容器化沙箱中（*F5*）。当Web客户端加载后，搜索（*Alt*
    + *Q*）“报告布局选择”，筛选当前报告，并将所选布局更改为Word（内置），如下所示：
- en: '![](img/a09b9ef2-c6c0-4d45-86e3-98ec419c76f5.png)'
  id: totrans-266
  prefs: []
  type: TYPE_IMG
  zh: '![](img/a09b9ef2-c6c0-4d45-86e3-98ec419c76f5.png)'
- en: 'After searching for the Item Ledger Entry Analysis report, choose to include
    the company logo in the report output and print it to Microsoft Word. Here is
    the outcome:'
  id: totrans-267
  prefs: []
  type: TYPE_NORMAL
  zh: 在搜索“Item Ledger Entry Analysis”报告后，选择将公司logo包含在报告输出中，并将其打印到Microsoft Word。以下是结果：
- en: '![](img/dc497d0b-22f8-4d8d-ba17-8a6273a564a3.png)'
  id: totrans-268
  prefs: []
  type: TYPE_IMG
  zh: '![](img/dc497d0b-22f8-4d8d-ba17-8a6273a564a3.png)'
- en: 'This concludes this section, where we created and beautified a report from
    scratch. In the next section, we will have a look at the most common task for
    a developer: copying and refactoring an existing report to cope with customer
    feature requirements.'
  id: totrans-269
  prefs: []
  type: TYPE_NORMAL
  zh: 本节结束，我们从零开始创建并美化了一个报告。在下一节，我们将看看开发者最常见的任务：复制并重构一个现有的报告，以应对客户的功能需求。
- en: Converting an existing C/AL report into AL
  id: totrans-270
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 将现有的C/AL报告转换为AL
- en: Making small modifications to an existing report is a very common task. Together
    with creating new pages and codeunits, this is probably one of the most repetitive
    and frequent jobs for a developer.
  id: totrans-271
  prefs: []
  type: TYPE_NORMAL
  zh: 对现有报告进行小的修改是非常常见的任务。与创建新页面和代码单元一起，这可能是开发者最频繁且重复性最高的工作之一。
- en: 'Let''s say that we would like to make the following changes to the standard
    sales order report:'
  id: totrans-272
  prefs: []
  type: TYPE_NORMAL
  zh: 假设我们希望对标准销售订单报告进行以下更改：
- en: Show the Customer Category field in the sales order header
  id: totrans-273
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 在销售订单头中显示客户类别字段
- en: Print *GIFT* in the sales lines for item lines with 100% discount
  id: totrans-274
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 在销售行中，对于100%折扣的项目行，打印 *GIFT*。
- en: The current version of the AL Language extension does not have any artifact
    such as the `ReportExtension` object that could be used to modify or merge existing
    reports. Therefore, it is always required to create a brand new report from scratch,
    even if we need to make very small modifications to the dataset and/or layout.
  id: totrans-275
  prefs: []
  type: TYPE_NORMAL
  zh: 当前版本的AL语言扩展没有类似于`ReportExtension`对象的工件，无法用于修改或合并现有报告。因此，即使我们只需要对数据集和/或布局做很小的修改，也总是需要从头开始创建一个全新的报告。
- en: The easiest way to accomplish this task, then, is to copy and give a different
    ID to an existing report after converting it from C/AL into AL.
  id: totrans-276
  prefs: []
  type: TYPE_NORMAL
  zh: 完成此任务的最简单方法是复制一个现有的报告，并在将其从C/AL转换为AL后，赋予其不同的ID。
- en: The first part of the task (copy an existing report) is pretty straightforward
    with the Dynamics 365 Business Central October 2019 update since all of the legacy
    C/AL reports have been transformed into their equivalent AL objects and included
    in the base application extension.
  id: totrans-277
  prefs: []
  type: TYPE_NORMAL
  zh: 任务的第一部分（复制现有报告）在 Dynamics 365 Business Central 2019 年 10 月更新中非常简单，因为所有遗留的 C/AL
    报告都已转换为其等效的 AL 对象，并已包含在基础应用程序扩展中。
- en: With the on-premises version, you can find them in the DVD installation folder
    in the `\Applications\BaseApp\Source`directory. Just unzip the file named `Base
    Application.Source.zip` and search for the standard report you need to make a
    copy of, together with its `.rdl` and `.docx` files.
  id: totrans-278
  prefs: []
  type: TYPE_NORMAL
  zh: 对于本地版，你可以在 DVD 安装文件夹的 `\Applications\BaseApp\Source` 目录中找到它们。只需解压名为 `Base Application.Source.zip`
    的文件，并搜索你需要复制的标准报告，以及它的 `.rdl` 和 `.docx` 文件。
- en: 'If you are using a Docker-contained sandbox, you might think of using a powerful
    cmdlet implemented in the `NavContainerHelper` library that is specifically intended
    for the Dynamics 365 Business Central October 2019 update: `Create-AlProjectFolderFromBcContainer`.
    This cmdlet will unpack the base application source code in a local folder of
    your choice. Here is a very simple code snippet:'
  id: totrans-279
  prefs: []
  type: TYPE_NORMAL
  zh: 如果你使用的是 Docker 容器化沙盒，可能会想到使用一个由 `NavContainerHelper` 库实现的强大 cmdlet，该 cmdlet
    特别适用于 Dynamics 365 Business Central 2019 年 10 月更新：`Create-AlProjectFolderFromBcContainer`。这个
    cmdlet 会将基础应用程序源代码解压到你选择的本地文件夹中。以下是一个非常简单的代码片段：
- en: '[PRE6]'
  id: totrans-280
  prefs: []
  type: TYPE_PRE
  zh: '[PRE6]'
- en: In `$alFolder`, you can pick up the AL report items that you need and renumber
    and customize them.
  id: totrans-281
  prefs: []
  type: TYPE_NORMAL
  zh: 在 `$alFolder` 中，你可以选择所需的 AL 报告项，并重新编号和自定义它们。
- en: With the Dynamics 365 Business Central April 2019 update or earlier, Microsoft
    provides a very useful—and powerful—command-line tool called `txt2al.exe`, which
    helps to convert C/AL objects into AL syntax. But there is more.
  id: totrans-282
  prefs: []
  type: TYPE_NORMAL
  zh: 在 2019 年 4 月或更早的 Dynamics 365 Business Central 更新中，微软提供了一个非常有用且强大的命令行工具 `txt2al.exe`，它帮助将
    C/AL 对象转换为 AL 语法。但还有更多功能。
- en: The `New-NavContainer` cmdlet contained in the `NavContainerHelper` PowerShell
    library, which we discussed in [Chapter 3](8b032c15-9adb-4170-bf03-50a1abad1aa9.xhtml),
    *Online and Container-Based Sandboxes*, also implements a useful switch (`-includeAL`)
    that extracts all of the C/AL objects in TXT format from a container and converts
    them one by one using `txt2.al.exe`.
  id: totrans-283
  prefs: []
  type: TYPE_NORMAL
  zh: '`New-NavContainer` cmdlet 是包含在 `NavContainerHelper` PowerShell 库中的，我们在[第3章](8b032c15-9adb-4170-bf03-50a1abad1aa9.xhtml)
    *在线和基于容器的沙盒*中讨论过，它还实现了一个非常有用的开关（`-includeAL`），该开关可以从容器中提取所有 C/AL 对象的 TXT 格式，并使用
    `txt2.al.exe` 逐个转换它们。'
- en: Since the Dynamics 365 Business Central October 2019 update, Microsoft discontinued
    the C/AL and CSIDE development environment, hence `txt2al.exe` is only present
    in deployments based on the Dynamics 365 Business Central April 2019 update or
    earlier versions.
  id: totrans-284
  prefs: []
  type: TYPE_NORMAL
  zh: 自从 Dynamics 365 Business Central 2019 年 10 月更新后，微软已停止支持 C/AL 和 CSIDE 开发环境，因此
    `txt2al.exe` 仅存在于基于 Dynamics 365 Business Central 2019 年 4 月更新或更早版本的部署中。
- en: 'Here is a very useful script that converts all of the standard base C/AL objects
    into their AL equivalents:'
  id: totrans-285
  prefs: []
  type: TYPE_NORMAL
  zh: 这是一个非常有用的脚本，它将所有标准的基础 C/AL 对象转换为其 AL 对应项：
- en: '[PRE7]'
  id: totrans-286
  prefs: []
  type: TYPE_PRE
  zh: '[PRE7]'
- en: 'Here''s a snippet of the PowerShell standard output that shows what is happening
    when the `-includeAL` switch is enabled:'
  id: totrans-287
  prefs: []
  type: TYPE_NORMAL
  zh: 以下是 PowerShell 标准输出的一个片段，显示当启用 `-includeAL` 开关时发生的情况：
- en: '[PRE8]'
  id: totrans-288
  prefs: []
  type: TYPE_PRE
  zh: '[PRE8]'
- en: The output files are located in the `C:\ProgramData\NavContainerHelper\Extensions\Original-<ApplicationVersion>-<localization>-al` directory.
  id: totrans-289
  prefs: []
  type: TYPE_NORMAL
  zh: 输出文件位于 `C:\ProgramData\NavContainerHelper\Extensions\Original-<ApplicationVersion>-<localization>-al`
    目录中。
- en: 'In this directory, we have to search for the converted AL standard object for
    order confirmation. Just type `Standard Sales Order` into the file explorer search
    field and three objects will be available to be copied and renamed:'
  id: totrans-290
  prefs: []
  type: TYPE_NORMAL
  zh: 在此目录中，我们需要查找已转换的订单确认的 AL 标准对象。只需在文件资源管理器的搜索框中输入 `Standard Sales Order`，即可找到三个可复制并重命名的对象：
- en: '`Report 1305 - Standard Sales – Order Conf..al`'
  id: totrans-291
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`Report 1305 - Standard Sales – Order Conf..al`'
- en: '`Standard Sales – Order Conf..docx`'
  id: totrans-292
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`Standard Sales – Order Conf..docx`'
- en: '`` `Standard Sales – Order Conf..rdlc` ``'
  id: totrans-293
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`` `Standard Sales – Order Conf..rdlc` ``'
- en: 'The following screenshot shows this:'
  id: totrans-294
  prefs: []
  type: TYPE_NORMAL
  zh: 以下截图显示了这一点：
- en: '![](img/0e5f656c-2357-49e7-8650-f293354a5b78.png)'
  id: totrans-295
  prefs: []
  type: TYPE_IMG
  zh: '![](img/0e5f656c-2357-49e7-8650-f293354a5b78.png)'
- en: 'Copy these files into the `.\Src\CustomerCategory\report` directory and rename
    them as follows:'
  id: totrans-296
  prefs: []
  type: TYPE_NORMAL
  zh: 将这些文件复制到 `.\Src\CustomerCategory\report` 目录，并按照以下方式重命名它们：
- en: '`Rep50115.PacktSalesOrderConf.al`'
  id: totrans-297
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`Rep50115.PacktSalesOrderConf.al`'
- en: '`Rep50115.PacktSalesOrderConf.docx`'
  id: totrans-298
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`Rep50115.PacktSalesOrderConf.docx`'
- en: '`Rep50115.PacktSalesOrderConf.rdl`'
  id: totrans-299
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`Rep50115.PacktSalesOrderConf.rdl`'
- en: The next step is to renumber the AL report within the allowed customization
    range to avoid duplicate object IDs and then change its properties to use the
    appropriate `.docx` and `.rdl` files.
  id: totrans-300
  prefs: []
  type: TYPE_NORMAL
  zh: 下一步是重新编号 AL 报告，在允许的自定义范围内，以避免重复的对象 ID，然后更改其属性，使用适当的 `.docx` 和 `.rdl` 文件。
- en: 'Edit `Rep50115.PacktSalesOrderConf.al` in Visual Studio Code and change the
    name and properties, as shown in the following code:'
  id: totrans-301
  prefs: []
  type: TYPE_NORMAL
  zh: 在 Visual Studio Code 中编辑 `Rep50115.PacktSalesOrderConf.al`，并按以下代码更改名称和属性：
- en: '[PRE9]'
  id: totrans-302
  prefs: []
  type: TYPE_PRE
  zh: '[PRE9]'
- en: Now, we have to let the application understand that every time standard report
    1305 is invoked, it should be substituted with custom report 50115 instead. This
    is easily done by subscribing to a specific event called `OnAfterSubstituteReport`,
    which is published through the `ReportManagement` codeunit.
  id: totrans-303
  prefs: []
  type: TYPE_NORMAL
  zh: 现在，我们必须让应用程序理解，每次调用标准报告 1305 时，都应该用自定义报告 50115 替代。这可以通过订阅一个名为 `OnAfterSubstituteReport`
    的特定事件轻松实现，该事件是通过 `ReportManagement` 代码单元发布的。
- en: 'Edit the `Cod50100.CustomerCategoryMgt_PKT.al` file, which is contained in
    `.\Src\CustomerCategory\codeunit`, and add the following code:'
  id: totrans-304
  prefs: []
  type: TYPE_NORMAL
  zh: 编辑 `Cod50100.CustomerCategoryMgt_PKT.al` 文件，该文件位于 `.\Src\CustomerCategory\codeunit`，并添加以下代码：
- en: '[PRE10]'
  id: totrans-305
  prefs: []
  type: TYPE_PRE
  zh: '[PRE10]'
- en: At this stage, if you build (*Ctrl* + *Shift* + *B*) and publish (*F5*) the
    extension, the whole (code and layouts) standard sales order report will automatically be
    replaced behind the scenes with the custom one.
  id: totrans-306
  prefs: []
  type: TYPE_NORMAL
  zh: 此时，如果你构建 (*Ctrl* + *Shift* + *B*) 并发布 (*F5*) 扩展，整个（代码和布局）标准销售订单报告将自动在后台被自定义报告替代。
- en: Now, it is time to make the appropriate changes to the custom sales order report
    code and Word layout to print out the Customer Category field in the document
    header and print out GIFT for every item line that has a 100% discount.
  id: totrans-307
  prefs: []
  type: TYPE_NORMAL
  zh: 现在，是时候对自定义销售订单报告代码和 Word 布局进行适当的修改，以便在文档头部打印客户类别字段，并且对于每个有 100% 折扣的项行打印 GIFT。
- en: 'Edit `Rep50115.PacktSalesOrderConf.al` in Visual Studio Code and add the following
    columns in the dataset section of the Header data item:'
  id: totrans-308
  prefs: []
  type: TYPE_NORMAL
  zh: 在 Visual Studio Code 中编辑 `Rep50115.PacktSalesOrderConf.al`，并在 Header 数据项的数据集部分添加以下列：
- en: '[PRE11]'
  id: totrans-309
  prefs: []
  type: TYPE_PRE
  zh: '[PRE11]'
- en: 'Add a label for the gift description:'
  id: totrans-310
  prefs: []
  type: TYPE_NORMAL
  zh: 为礼品描述添加标签：
- en: '[PRE12]'
  id: totrans-311
  prefs: []
  type: TYPE_PRE
  zh: '[PRE12]'
- en: 'Then, change the IF conditional statement related to the discount percentage
    in the `OnAfterGetRecord` trigger for the `Line` data item:'
  id: totrans-312
  prefs: []
  type: TYPE_NORMAL
  zh: 然后，更改 `OnAfterGetRecord` 触发器中与折扣百分比相关的 IF 条件语句，以便 `Line` 数据项使用：
- en: '[PRE13]'
  id: totrans-313
  prefs: []
  type: TYPE_PRE
  zh: '[PRE13]'
- en: Everything is now ready to work as expected. We simply need to display the Customer
    Category column in the report layout.
  id: totrans-314
  prefs: []
  type: TYPE_NORMAL
  zh: 一切已经准备好，可以按预期工作了。我们只需在报告布局中显示客户类别列。
- en: Just build the app (*Ctrl* + *Shift* + *B*) and publish (*F5*) it in the online
    sandbox.
  id: totrans-315
  prefs: []
  type: TYPE_NORMAL
  zh: 只需构建应用程序 (*Ctrl* + *Shift* + *B*) 并在在线沙盒中发布 (*F5*) 它。
- en: 'Go to Report Layout Selections, filter the list for report 50115, and click
    on Custom Layouts*.* The following screenshot shows the filtered report layout
    selections:'
  id: totrans-316
  prefs: []
  type: TYPE_NORMAL
  zh: 转到报告布局选择，筛选报告 50115 的列表，然后点击自定义布局*.* 以下截图显示了筛选后的报告布局选择：
- en: '![](img/27b2fc9f-32b5-4686-9180-cade66f4a819.png)'
  id: totrans-317
  prefs: []
  type: TYPE_IMG
  zh: '![](img/27b2fc9f-32b5-4686-9180-cade66f4a819.png)'
- en: 'Create a new layout and choose Insert Word layout:'
  id: totrans-318
  prefs: []
  type: TYPE_NORMAL
  zh: 创建一个新布局并选择插入 Word 布局：
- en: '![](img/0ac56c82-df7e-499b-935e-82bcb3d7bb2c.png)'
  id: totrans-319
  prefs: []
  type: TYPE_IMG
  zh: '![](img/0ac56c82-df7e-499b-935e-82bcb3d7bb2c.png)'
- en: 'Export the custom Word layout we just created. In the Word layout, remove the
    `CustomerAddress8` field and instead, add the following:'
  id: totrans-320
  prefs: []
  type: TYPE_NORMAL
  zh: 导出我们刚刚创建的自定义 Word 布局。在 Word 布局中，删除 `CustomerAddress8` 字段，并添加以下内容：
- en: CustomerCategory_PKT_Lbl as plaintext
  id: totrans-321
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: CustomerCategory_PKT_Lbl 作为纯文本
- en: A space, a colon (:), and another space
  id: totrans-322
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 一个空格，一个冒号（:），再加一个空格
- en: CustomerCategory_PKT as plaintext
  id: totrans-323
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: CustomerCategory_PKT 作为纯文本
- en: 'This is how it appears:'
  id: totrans-324
  prefs: []
  type: TYPE_NORMAL
  zh: 这是它的显示方式：
- en: '![](img/53f9eda1-6c54-4d8b-b0b9-4283d33b2ff7.png)'
  id: totrans-325
  prefs: []
  type: TYPE_IMG
  zh: '![](img/53f9eda1-6c54-4d8b-b0b9-4283d33b2ff7.png)'
- en: Save the layout and import it back into the customer layout record.
  id: totrans-326
  prefs: []
  type: TYPE_NORMAL
  zh: 保存布局并将其导入回客户布局记录。
- en: You could also use this Word layout in the standard extension and replace the
    original report 50115 `.docx` file with this one if you intend to use this version
    as part of your standard extension deployment.
  id: totrans-327
  prefs: []
  type: TYPE_NORMAL
  zh: 如果你打算将此版本作为标准扩展部署的一部分使用，你也可以在标准扩展中使用此 Word 布局，并用此布局替换原始报告 50115 的 `.docx` 文件。
- en: 'Run any sales order that has a gift line and customer category assigned to
    inspect the result. It should look like this:'
  id: totrans-328
  prefs: []
  type: TYPE_NORMAL
  zh: 运行任何包含礼品行和客户类别的销售订单，检查结果。它应该如下所示：
- en: '![](img/82220419-63d0-4f13-a06f-5acff256a1db.png)'
  id: totrans-329
  prefs: []
  type: TYPE_IMG
  zh: '![](img/82220419-63d0-4f13-a06f-5acff256a1db.png)'
- en: This concludes our section related to converting a C/AL report into AL. Next,
    let's learn how feature limitation works on RDL and Word reports.
  id: totrans-330
  prefs: []
  type: TYPE_NORMAL
  zh: 这部分内容是关于将 C/AL 报告转换为 AL 的最后一个环节。接下来，我们来学习 RDL 和 Word 报告的功能限制如何工作。
- en: Feature limitation when developing an RDL or Word layout report
  id: totrans-331
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 开发 RDL 或 Word 布局报告时的功能限制
- en: Basically—and historically—professional report development could/should be done
    by developing RDL report layouts with Visual Studio and the RDLC report extension
    installed. The Word document layout has more limitations than RDL and its main
    advantage is that it is quite popular and easy to adopt by power users.
  id: totrans-332
  prefs: []
  type: TYPE_NORMAL
  zh: 基本上——而且历史上——专业的报告开发应该通过使用 Visual Studio 和已安装的 RDLC 报告扩展来开发 RDL 报告布局。Word 文档布局的限制比
    RDL 更多，其主要优点是它非常流行，并且易于被高级用户采用。
- en: 'The major pain points you might find when developing layouts are typically
    related to documents. The most commonly known ones are as follows:'
  id: totrans-333
  prefs: []
  type: TYPE_NORMAL
  zh: 在开发布局时，您可能会遇到的主要痛点通常与文档相关。最常见的问题如下：
- en: '**Header and footer space is always retained**: Report headers and footers
    have static content, and they have been engineered so that they are always displayed
    on every page if they are present. Nevertheless, with RDL, you could use the typical
    `SetData` function in the body and the `GetData` function in the header. An example
    of this trick can be found in the standard object 206 Sales Invoice RDL layout.'
  id: totrans-334
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**始终保留页眉和页脚空间**：报告的页眉和页脚具有静态内容，并且已经设计为如果存在，它们将在每个页面上始终显示。然而，在 RDL 中，您可以在主体部分使用典型的
    `SetData` 函数，在页眉中使用 `GetData` 函数。这个技巧的一个示例可以在标准对象 206 销售发票的 RDL 布局中找到。'
- en: '**There''s no easy way to mimic the** `PlaceInBottom` **property for a document
    report from the old classic client report**: When developing a document, you might
    be asked to generate an entire document, but the totals (VAT, totals per group,
    and so on) must be always printed at the bottom, always in the same place, only
    on the last page. This problem arises because a Dynamics 365 Business Central
    document report could be considered as *a batch of multiple documents and multiple
    copies* rather than a single report. This implies that the breakdown for renumbering
    pages must be done for every document number and copy number. An example is the
    *report 205 Sales Order*.'
  id: totrans-335
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**无法轻松模拟旧经典客户端报告中的** `PlaceInBottom` **属性**：在开发文档时，您可能会被要求生成整个文档，但总计（如增值税、每组总计等）必须始终打印在最后一页的底部，并且总是在相同的位置。这个问题出现的原因是，Dynamics
    365 Business Central 文档报告可以被视为*一批多个文档和多个副本*，而不是单一报告。这意味着重新编号页面的拆分必须针对每个文档编号和副本编号进行。一个例子是*报告
    205 销售订单*。'
- en: In standard document reports, totals are never placed at the bottom of the page;
    they are printed right after the last document line. This means that they could
    be printed anywhere on a page, or even be on an extra page. There is no feasible
    way to print a batch of the document and the totals printed at the bottom of the
    last page for every document and copy.
  id: totrans-336
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 在标准的文档报告中，总计通常不会放在页面底部；它们是在最后一条文档线之后打印的。这意味着它们可能打印在页面的任何位置，甚至可能出现在额外的页面上。没有可行的方法可以将文档批次及其总计始终打印在最后一页的底部。
- en: '**Complexity in implementing running totals**: Typically, with documents, you
    would like to implement running totals at the bottom of the page that are reported
    at the top of the next page, such as To be Continued and continue labels when
    printing the ledger or some transactional entries.'
  id: totrans-337
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**实现汇总总计的复杂性**：通常，在文档中，您可能希望在页面底部实现运行总计，并在下一页的顶部报告这些总计，例如打印账簿或一些交易条目时的“待续”或“继续”标签。'
- en: 'With the old classic client report designer, you could resolve this by adding
    a `transheader`/`transfooter`. These artifacts no longer exist with RDL or Word
    layout reports. With a Word layout report, there is no feasible solution. With
    RDL, you might implement running totals, but only with header and footer sections.
    This is an old but useful development reference: [https://blogs.msdn.microsoft.com/nav/2011/06/06/transfooter-and-transheader-functionality-in-rdlcssrs-reports-revisited/](https://blogs.msdn.microsoft.com/nav/2011/06/06/transfooter-and-transheader-functionality-in-rdlcssrs-reports-revisited/).'
  id: totrans-338
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 使用旧经典客户端报告设计器时，您可以通过添加 `transheader` / `transfooter` 来解决这个问题。随着 RDL 或 Word 布局报告的出现，这些元素不再存在。使用
    Word 布局报告时，没有可行的解决方案。使用 RDL，您可能会实现运行总计，但仅限于页眉和页脚部分。这是一个旧的但有用的开发参考：[https://blogs.msdn.microsoft.com/nav/2011/06/06/transfooter-and-transheader-functionality-in-rdlcssrs-reports-revisited/](https://blogs.msdn.microsoft.com/nav/2011/06/06/transfooter-and-transheader-functionality-in-rdlcssrs-reports-revisited/)。
- en: 'Considering Word layouts only, the design limitations you might also frequently
    hit are as follows:'
  id: totrans-339
  prefs: []
  type: TYPE_NORMAL
  zh: 仅考虑 Word 布局时，您可能经常遇到的设计限制如下：
- en: '**No conditional formatting**: If you need to set the visibility of a control,
    change a field value within the layout, or set any conditional formatting, this
    is not possible with Word. A typical example is when you need to print a blank
    character instead of zero. This must be done in the dataset, and values have to
    be sent to the document already formatted as strings (blank or with a numeric
    value).'
  id: totrans-340
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**没有条件格式化**：如果你需要设置控件的可见性、更改布局中的字段值或设置任何条件格式化，这是在 Word 中无法实现的。一个典型的例子是当你需要打印一个空白字符而不是零时。这必须在数据集中完成，且值必须已经以字符串形式（空白或数值）发送到文档。'
- en: '**No totaling formulas**: There is no equivalent to RDL `=SUM` functions or
    similar. Value calculations must be done through AL code and the result added
    to the dataset.'
  id: totrans-341
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**没有合计公式**：没有等同于 RDL 的 `=SUM` 函数或类似的功能。值的计算必须通过 AL 代码完成，然后将结果添加到数据集中。'
- en: '**Having nested repeaters in the same table is a challenge**: Since it is not
    possible to conditionally trigger the visibility of a table line, there is a tradeoff
    between a good-looking layout and different data items in the same table. A typical
    example is comment lines under a sales line or an additional description/barcode
    line under a sales shipment line.'
  id: totrans-342
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**在同一个表格中嵌套重复项是一个挑战**：由于无法有条件地触发表格行的可见性，因此在表格中创建一个既美观又能展示不同数据项的布局是一个折中方案。一个典型的例子是在销售行下的评论行，或者在销售出货行下的额外描述/条形码行。'
- en: These might be achieved by adding a nested table structure repeater within the
    lines repeater, which maps the extra additional information. The nested table
    structure can be freely defined, as long as it spans a set of merged cells in
    the outer table. When you develop this, be aware that if there is no extra additional
    information, at least one empty instance of the nested structure will be included.
  id: totrans-343
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 这些可能通过在行重复项中添加一个嵌套的表格结构重复项来实现，这样可以映射额外的附加信息。嵌套表格结构可以自由定义，只要它横跨外部表格中合并的单元格集合。当你开发时，要注意，如果没有额外的附加信息，至少会包含一个空的嵌套结构实例。
- en: The best solution would be to use a buffer table in the dataset and create the
    exact line structure as it has to be printed in the layout.
  id: totrans-344
  prefs: []
  type: TYPE_NORMAL
  zh: 最佳的解决方案是使用数据集中的缓冲区表，并创建与布局中需要打印的精确行结构相同的结构。
- en: If you come across one or more of these limitations, then probably the best
    and easiest solution is to develop an RDL layout report instead.
  id: totrans-345
  prefs: []
  type: TYPE_NORMAL
  zh: 如果你遇到一个或多个这样的限制，那么可能最好的和最简单的解决方案是开发一个 RDL 布局报告。
- en: Understanding report performance considerations
  id: totrans-346
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 理解报告的性能考虑因素
- en: With Dynamics 365 Business Central online, there are performance considerations
    that need to be taken into account.
  id: totrans-347
  prefs: []
  type: TYPE_NORMAL
  zh: 使用 Dynamics 365 Business Central 在线时，有一些性能考虑因素需要考虑。
- en: Currently, both Word and RDL built-in layouts are rendered in the same application
    domain process when they run with `SAVEASPDF` or `SAVEAS` statements.
  id: totrans-348
  prefs: []
  type: TYPE_NORMAL
  zh: 目前，Word 和 RDL 内置布局在使用 `SAVEASPDF` 或 `SAVEAS` 语句时，都在同一应用程序域进程中渲染。
- en: Since RDL layouts might enable some external code artifacts that may potentially
    affect data within the same application domain, it has been decided to run every
    custom RDL report layout in isolated mode. It's worth noticing that if you develop
    a report and declare `DefaultLayout` as RDL and the `RDLLayout` property, this
    is considered a built-in layout and should render in the same application domain.
  id: totrans-349
  prefs: []
  type: TYPE_NORMAL
  zh: 由于 RDL 布局可能会启用一些外部代码构件，这些构件可能会影响同一应用程序域中的数据，因此决定以隔离模式运行每个自定义 RDL 报告布局。值得注意的是，如果你开发了一个报告并声明
    `DefaultLayout` 为 RDL 和 `RDLLayout` 属性，这被视为内置布局，应在同一应用程序域中渲染。
- en: Word layouts, no matter whether they are built-in or custom-made, do not run
    in isolation.
  id: totrans-350
  prefs: []
  type: TYPE_NORMAL
  zh: 无论是内置的还是自定义制作的，Word 布局都不会在隔离模式下运行。
- en: Enabling application domain isolation for custom RDL layouts provides a more
    secure and reliable processing environment. However, the drawback is that it could
    considerably increase the rendering time.
  id: totrans-351
  prefs: []
  type: TYPE_NORMAL
  zh: 启用自定义 RDL 布局的应用程序域隔离提供了一个更加安全和可靠的处理环境。然而，缺点是可能会显著增加渲染时间。
- en: Whenever you develop RDL reports for Dynamics 365 Business Central online, you
    must also test performance with the `SAVEASPDF` or `SAVEAS` statements within
    an online sandbox or a Docker-contained sandbox with the `customsettings.config`
    file server parameter, ReportAppDomainIsolation, set to `true`.
  id: totrans-352
  prefs: []
  type: TYPE_NORMAL
  zh: 每当你为 Dynamics 365 Business Central 在线开发 RDL 报告时，必须在在线沙箱或使用 `customsettings.config`
    文件服务器参数 `ReportAppDomainIsolation` 设置为 `true` 的 Docker 容器沙箱中，测试使用 `SAVEASPDF`
    或 `SAVEAS` 语句的性能。
- en: Other performance considerations that are valid for both Word and RDL report
    layouts are based on dataset optimization.
  id: totrans-353
  prefs: []
  type: TYPE_NORMAL
  zh: 其他适用于Word和RDL报表布局的性能考虑因素基于数据集优化。
- en: 'These are the equations to keep in mind when developing the data structure
    of the AL report. Let''s consider that the dataset is an in-memory table (`X axis
    = columns` and `Y axis = rows`):'
  id: totrans-354
  prefs: []
  type: TYPE_NORMAL
  zh: 这些是开发AL报表数据结构时需要牢记的公式。我们假设数据集是一个内存表（`X轴 = 列` 和 `Y轴 = 行`）：
- en: '[PRE14]'
  id: totrans-355
  prefs: []
  type: TYPE_PRE
  zh: '[PRE14]'
- en: 'You can use the following links to optimize standard reports or your own custom
    reports:'
  id: totrans-356
  prefs: []
  type: TYPE_NORMAL
  zh: 你可以使用以下链接来优化标准报表或你自定义的报表：
- en: '[https://blogs.msdn.microsoft.com/nav/2014/03/09/rdlc-report-and-performance-in-microsoft-dynamics-nav/](https://blogs.msdn.microsoft.com/nav/2014/03/09/rdlc-report-and-performance-in-microsoft-dynamics-nav/)'
  id: totrans-357
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[https://blogs.msdn.microsoft.com/nav/2014/03/09/rdlc-report-and-performance-in-microsoft-dynamics-nav/](https://blogs.msdn.microsoft.com/nav/2014/03/09/rdlc-report-and-performance-in-microsoft-dynamics-nav/)'
- en: '[https://blogs.msdn.microsoft.com/nav/2016/05/20/rdlc-report-and-performance-in-microsoft-dynamics-nav-2015-and-2016/](https://blogs.msdn.microsoft.com/nav/2016/05/20/rdlc-report-and-performance-in-microsoft-dynamics-nav-2015-and-2016/)'
  id: totrans-358
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[https://blogs.msdn.microsoft.com/nav/2016/05/20/rdlc-report-and-performance-in-microsoft-dynamics-nav-2015-and-2016/](https://blogs.msdn.microsoft.com/nav/2016/05/20/rdlc-report-and-performance-in-microsoft-dynamics-nav-2015-and-2016/)'
- en: '[https://blogs.msdn.microsoft.com/nav/2015/03/17/a-couple-of-rdlc-performance-optimization-tips/](https://blogs.msdn.microsoft.com/nav/2015/03/17/a-couple-of-rdlc-performance-optimization-tips/)'
  id: totrans-359
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[https://blogs.msdn.microsoft.com/nav/2015/03/17/a-couple-of-rdlc-performance-optimization-tips/](https://blogs.msdn.microsoft.com/nav/2015/03/17/a-couple-of-rdlc-performance-optimization-tips/)'
- en: Summary
  id: totrans-360
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 总结
- en: In this chapter, we have learned which tools to use to develop reports with
    AL. We saw how to create RDL and Word layouts and which tools are supported. We
    got a better understanding of the creation of reports and how to use them. We
    have also explained how to use `txt2al.exe` to convert a C/AL report into an AL
    report and refactor it to be reused within the standard application with a practical
    example.
  id: totrans-361
  prefs: []
  type: TYPE_NORMAL
  zh: 在本章中，我们学习了如何使用哪些工具来开发AL报表。我们了解了如何创建RDL和Word布局，以及支持的工具。我们对报表的创建和使用有了更深入的理解。我们还解释了如何使用`txt2al.exe`将C/AL报表转换为AL报表，并通过实际示例重构它以便在标准应用中重用。
- en: In the end, we learned that there are some reporting limitations, a few workarounds,
    and some performance considerations that can help you become a master in AL report
    development.
  id: totrans-362
  prefs: []
  type: TYPE_NORMAL
  zh: 最后，我们了解到在AL报表开发中存在一些报表限制，几种解决方法，以及一些性能考虑因素，这些都能帮助你成为AL报表开发的高手。
- en: In the next chapter, we'll learn how to build an automated test for Dynamics
    365 Business Central to check for application business process consistency and
    improve the robustness of our development solutions.
  id: totrans-363
  prefs: []
  type: TYPE_NORMAL
  zh: 在下一章中，我们将学习如何为Dynamics 365 Business Central构建自动化测试，以检查应用程序的业务流程一致性，并提高我们开发解决方案的健壮性。
