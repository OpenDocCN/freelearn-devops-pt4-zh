# 第十五章：评估

# 第一章

1.  正确。在传统组织中，开发通常负责创建软件变更，而运维则负责维护目标系统的稳定性。由于变更本身带有风险，可能破坏稳定性，因此运维通常对变更持抵触态度。

1.  错误。理论上，虽然可以单独实践不同的 DevOps 实践，但真正的价值在于将它们结合起来。例如，没有持续集成和测试自动化的持续部署不仅几乎没有意义，甚至会很危险，因为没有持续集成和测试自动化提供的质量保证，持续部署变更是极具风险的。

1.  错误答案是第 4 项。DevOps 不是一个职位名称，而是一种文化运动。实际上，在开发和运维之间创建一个新的 DevOps 团队，通常与 DevOps 哲学相悖。与其说是两个目标各自独立的团队或部门，不如说现在有了三个。

1.  Fastlaning 是一种加速处理未计划的高优先级工作而非计划工作的方法，同时保持整个团队的单一冲刺看板。

1.  DevOps 有很多定义。一些常见的主要元素包括商业价值、最终用户、持续部署、自动化和协作。

# 第二章

1.  集中式和去中心化版本控制之间的主要区别在于，在去中心化版本控制系统中，每个用户都拥有源代码的完整历史。而在集中式系统中，只有服务器拥有完整历史。去中心化系统在与服务器断开连接时表现最佳，而集中式系统通常允许更详细的访问控制。

1.  正确。Git 是最著名的去中心化版本控制系统。

1.  正确答案是第 3 项。Rebasing 不是分支策略，而是合并策略。

1.  在使用 Git 时，拉取请求用于请求将一个分支的更改合并到另一个分支。拉取请求可以被审查、批准或拒绝。为了强制使用拉取请求，可以使用 Git 策略。

1.  正确答案是第 2 项。Trunk-based 开发不是合并策略，而是分支策略。

# 第三章

1.  错误。持续集成是指将每个开发人员的工作与他们同事的工作至少每天集成一次，并对集成后的源代码进行构建和测试。仅仅运行每日构建并不等同于持续集成。

1.  正确。经典的构建流水线总是与源代码库连接的。可能在构建流水线中并未使用这些源代码，但连接始终存在。

1.  错误。可以创建一个直接从某个阶段开始的 YAML 流水线。链接到源代码仓库不再是强制性的。

1.  正确答案是 1：服务连接。服务连接在包含需要调用外部工具的管道的组织或项目中进行配置。一旦配置了服务连接，它可以从一个或多个管道中使用。

1.  正确答案是 1 和 3：对封闭网络的访问以及安装额外软件的能力。自托管代理部署在由你拥有的基础设施上。这意味着你可以将它们部署在你控制的网络上，从而使它们能够访问该网络。由于代理部署在你的基础设施上，你还可以决定安装哪些软件（以及不安装哪些软件）。任务和扩展任务会在代理执行作业之前自动下载到代理上。你可以拥有任意数量的并行管道而无需使用自托管代理。然而，为此你需要向微软购买额外的并行执行。

# 第四章

1.  错误。也可以通过定时触发或手动触发新发布。

1.  所有答案都是正确的。

1.  答案 2 和 3 是正确的。基于环的部署和金丝雀部署都只将应用程序的新版本暴露给有限的用户群体。功能开关也用于逐步曝光，但它们并不是用来限制部署的风险，而是用来限制新功能发布的风险。

1.  正确。部署组用于执行来自发布管道的任务，不是在组中的一个代理上执行，而是在所有代理上执行。部署组的目的是在运行代理的机器上部署软件。

1.  一个可能的优势是，Azure DevOps 保留了所有步骤的端到端可追溯性。如果你还在 Azure DevOps 中管理工作项和源代码，你将保持从工作项到发布的端到端可追溯性，而且这一切仍然可以使用 App Center 进行实际的部署。

# 第五章

1.  错误。一个包的版本可以在多个视图中可见。

1.  错误。管道工件只能从 Azure DevOps 内的其他管道中使用。

1.  正确。Azure Artifact feeds 可以用于将通用包共享给其他产品。这使得你可以在 Azure DevOps 中编译应用程序，将二进制文件作为通用包上传，然后在另一个产品中重新下载它。这在使用其他部署工具时非常有用，例如 Octopus Deploy。

1.  正确答案是 2 和 4。答案 1 是错误的，因为包引用（无论是在`.csproj`文件中还是在`nuget.config`文件中）应该仅按名称和版本引用包。答案 3 是错误的，因为`consumer`不是 Azure Artifact feeds 中的有效访问级别。正确的访问级别是 reader（或更高），因此答案 2 是正确的。答案 4 也是正确的。你需要将包的位置添加到你的 NuGet 配置中。

1.  一个动机可能是解决方案的大小。如果编译和测试解决方案需要的时间过长，以至于开发人员需要等待反馈，那么将解决方案拆分成较小的部分可能更好。这可以缩短开发人员的反馈周期，从而提高开发速度。另一个动机可能是多个团队正在开发一个应用程序，并且他们希望增加团队之间的隔离度。

# 第六章

1.  正确。ARM 模板允许你为 Azure 资源组中的所有资源指定最终状态。应用 ARM 模板将始终导致创建缺失的资源并更新现有的资源。如果指定了 `complete` 部署模式，即使模板中没有的资源也会被删除。

1.  正确答案是第 2 点。模块、Run As 帐户和变量都是在第六章，*基础设施与配置即代码*中讨论的构件。

1.  错误。ARM 模板参数允许引用 Azure Key Vault 中的值，从而避免用户在源代码管理中输入密钥或其他敏感信息。在部署时，这些机密会被检索并在 Azure 中使用，前提是启动操作的身份具有对该 Key Vault 的访问权限。

1.  正确。你可以在 Azure 自动化帐户中定义一个或多个计划，并将这些计划与 Runbook 关联起来。

1.  实践基础设施即代码可以带来许多好处。两个常被提及的例子是防止配置漂移和能够按需创建新环境。配置漂移通过在预定计划内重新应用相同的基础设施规范来防止。按需创建环境可以用来快速创建新的测试环境，执行测试后再将其删除。这可以带来更可重复的测试结果，并可能节省测试基础设施的成本。

# 第七章

1.  正确。Entity Framework 和 Entity Framework Core 都内置支持在对架构定义进行更改后生成迁移。

1.  错误。大多数基于迁移的方法使用一个额外的表格来跟踪哪些迁移已经应用到数据库中。

1.  正确。基于最终状态的方法通过将当前架构与目标架构进行比较来工作。这会生成一个一次性的 SQL 脚本，执行该脚本将数据库架构更新到目标状态。每次运行之间没有存储状态。

1.  正确答案是 1 和 2。如果正确地并行运行，可以显著减少变更风险。如果出现问题，你可以随时移除所有新的代码和数据库副本，从一个正常运行的状态重新开始。确保两个环境都正常工作，还可以对生产工作负载进行非常精确的性能测量。然而，缺点之一是，周期时间实际上很可能会增加。你必须将多个较小的变更逐一推送到生产环境中，这样会增加总的时间消耗。

1.  错误。你的模式（无论是隐式的还是以数据对象形式捕获的）仍然会发生变化。然而，只有当你从数据库中读取以前版本的对象时，变化才会显现。实际上，你只是在延迟处理模式变化的问题。

1.  你可以选择不使用数据库级的编码技术，如存储过程和触发器。你将逻辑从数据库中提取出来，能减少必须做的数据库变更的总次数。

# 第八章

1.  正确。在单元测试中，单个组件是被隔离测试的。在面向对象语言中，这通常是一个单独的类。

1.  错误。在集成测试中，验证的是一组组件的正确工作，而不是整个组装好的系统。如果测试的是整个组装并部署的系统，这被称为系统测试。

1.  答案 2 是正确的。测试金字塔建议进行大量单元测试，以验证尽可能多的需求。只有那些无法通过单元测试覆盖的风险，才会添加集成测试，从而减少集成测试的数量。系统测试的数量更少，仅用于覆盖那些单元测试或集成测试未能覆盖的风险。

1.  答案 3 是正确的。所有其他类型的测试都在本章中介绍。

1.  这里可以提到的两种技术是代码审查和管道门控。代码审查让开发者检查同事的工作，帮助彼此保持高质量。管道门控则可以用来阻止应用的构建或版本在某些条件不满足时进一步传播。例如，条件可以包括某些质量指标，或最低的测试覆盖率或测试结果标准。

# 第九章

1.  错误。为了安全地创建和交付软件，整个过程，尤其是管道，必须得到保障。仅在最后添加安全措施是行不通的，因为安全必须贯穿交付过程的每一个步骤。

1.  OWASP **Zed Attack Proxy**（**ZAP**）可以用于这类测试。

1.  正确。在现代应用中，多达 80%的代码可能来自开源库或框架。

1.  正确答案是 1、2、4 和 6。没有 Azure DevOps 安全变量或 Azure DevOps 密钥库这种东西。

1.  Azure Policy 可以用于禁止或列出不希望出现的 Azure 配置，通常与基础设施配置或资源配置相关。Azure Security Center 可以用于识别和修复运行时的安全风险。

# 第十章

1.  错误。Azure 发出的平台指标由每个独立服务定义，无法更改。

1.  93 天。这个数字保证了至少有三个月的历史数据。

1.  正确。自定义指标可以通过 SDK 或 REST API 在你自己的应用程序代码中计算并发送到 Application Insights。

1.  警报疲劳。

1.  正确。Azure 允许创建包含 Webhooks 的操作组，在触发警报时调用这些 Webhooks。

# 第十一章

1.  错误。一个可能的缺点是失去市场竞争优势。如果竞争对手知道你接下来要开发什么，他们可能会在这一方面有所准备。

1.  可能的担忧是某些用户或用户群体比其他人更为活跃，这可能导致公众意见与实际听到的意见之间存在差异。此外，关于公开路线图的反馈很可能只来自现有用户，而潜在用户可能不会就他们缺失的功能对你的路线图发表评论。

1.  本章讨论的两个示例是社交媒体渠道上的情感分析和支持请求的数量与严重性。

1.  答案 3 是正确的。假设陈述了一种信念，即某个功能是必要的——这是假设的部分。第二部分是需要观察的可衡量的用户反馈，直到这个信念得到确认，这被称为确认阈值。假设还没有得出结论。

1.  用户访谈或焦点小组的潜在好处是，它们通常在较小规模下进行，不仅可以衡量反馈，还可以理解背后的原因。另一个好处是，参与者可以被精心选择，以代表所有用户或特定的用户群体。

# 第十二章

1.  容器对 DevOps 的好处包括一致性、关注点的分离和平台的可移植性。

1.  正确：根据主机操作系统的不同，容器的托管位置并不重要。

1.  是的，这是可能的。可以通过添加 Docker 支持和项目级别来实现。

1.  `RUN`命令用于安装组件或在构建容器镜像的过程中执行操作。

1.  节点和 Pod 可以在 Azure Kubernetes Service 中调度。它们都可以手动或自动扩展。

# 第十三章

1.  错误。某些信息可以传递到其他地区，或在全球范围内可用。例如，有时当选择的区域的容量不足时，代理会在其他区域运行。

1.  工作项 | 项目 | 组织 | 区域。Azure DevOps 组织是用户可以创建的顶级构建。每个组织位于一个特定区域，由微软维护。在一个组织内，可以创建一个或多个项目。反过来，一个项目可以包含许多工作项，例如用户故事、功能或史诗。

1.  错误。一般建议是保持项目数量适中：项目越少越好。隔离性和非常严格的授权边界可能是选择使用多个项目的原因。

1.  授权和许可。可以设置授权，以便每个单独用户或一组用户可以访问的权限。分配给用户的许可还可以限制某些功能的使用。例如，拥有利益相关者许可的用户不能使用源代码控制。

1.  端到端可追溯性。在执行工作管理、源代码控制、构建、工件和部署时，如果使用单一工具，就可以追踪到某个用户故事是如何交付给用户的。
