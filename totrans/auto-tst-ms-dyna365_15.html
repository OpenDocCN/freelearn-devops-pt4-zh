<html><head></head><body>
        <section>

                            <header>
                    <h1 class="header-title">Setting Up VS Code and Using the GitHub Project</h1>
                </header>
            
            <article>
                
<p>This is a book about writing automated tests in Microsoft Dynamics 365 Business Central, not about how to develop extensions with VS Code and the AL language. It is assumed that you know how to use VS Code in conjunction with the AL development language and how Dynamics 365 Business Central works as a platform and an application. Based on this, we dived straight into coding in <a href="1e679d13-4037-48e2-b8ae-f550f507f8c9.xhtml" target="_blank">Chapter 2</a>, <em>The Testability Framework</em>, without explaining anything about the development tools we are using, and continued to do that in the following chapters.</p>
<p>In this appendix, however, we pay some attention to VS Code and AL development, and the code examples to be found in the repository on GitHub.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">VS Code and AL development</h1>
                </header>
            
            <article>
                
<p>If you are new to extension development with VS Code and the AL language, you might want to practice this first. There are various resources out there, but a very comprehensive one, though not too voluminous, is <em>Dynamics 365 Business Central</em> <em>Development Quick Start Guide</em> by Stefano Demiliani and Duilio Tacconi.</p>
<div class="packt_infobox">Here is a link to the Packt page where you also can order the book: <a href="https://www.packtpub.com/business/dynamics-365-business-central-development-quick-start-guide">https://www.packtpub.com/business/dynamics-365-business-central-development-quick-start-guide</a><a href="https://www.packtpub.com/business/dynamics-365-business-central-development-quick-start-guide"/></div>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">VS Code project</h1>
                </header>
            
            <article>
                
<p>In <em>Dynamics 365 Business Central</em><span> </span><em>Development Quick Start Guide</em>, Stefano Demiliani and Duilio Tacconi explain in a practical way how to set up a new extension project in VS Code, start programming in AL, and deploy the extension to Business Central. The projects you will find in the GitHub repository for this book have been created in the same way: for each chapter there is a separate folder containing the AL code objects and the <kbd>app.json</kbd> file. If you have been working on extensions already, you will notice that one major resource is missing: the <kbd>launch.json</kbd>.</p>
<div class="packt_infobox">Note that we will discuss the structure of the GitHub repository in more detail in the following sections.</div>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">launch.json</h1>
                </header>
            
            <article>
                
<p>To be able to use a chapter folder as a complete VS Code AL extension project folder, you need to add a <kbd>launch.json</kbd> file to it. The <kbd>launch.json</kbd> file is typically stored in the <kbd>.vscode</kbd> subfolder of the project folder and contains information on the Business Central installation that the extension will be launched on. To get a <kbd>.vscode</kbd> folder with a <kbd>launch.json</kbd> file, follow these steps:</p>
<ol>
<li>Open VS Code with the AL Language extension installed</li>
<li>Use the <kbd>AL: GO!</kbd> command to create a new VS Code AL project</li>
<li>In this project, configure the <kbd>launch.json</kbd> file to set up a relation with the Business Central installation you are going to perform your test coding on</li>
<li>Copy this <kbd>.vscode</kbd> folder to the chapter project folder you want to work with</li>
</ol>
<p>Your <kbd>launch.json</kbd> might look somewhat like this:</p>
<pre>{<br/>   "version": "0.2.0",<br/>    "configurations": [<br/>        {<br/>            "type": "al",<br/>            "request": "launch",<br/>            "name": "Your own server",<br/>            "server": "http://localhost",<br/>            "serverInstance": "BC130",<br/>            "authentication": "Windows",<br/>            "port": 7049,<br/>            "startupObjectId": 130401,<br/>            "startupObjectType": "Page",<br/>            "breakOnError": true,<br/>            "launchBrowser": true<br/>        }<br/>    ]<br/>}</pre>
<p>Compared to the default <kbd>launch.json </kbd>file, you will note that I have added/updated a couple of useful keywords, such as <kbd>startupObjectId</kbd>, the startup page 130401, which is the <kbd>Test Tool</kbd> page.</p>
<div class="packt_infobox">You will find more details in <em>Dynamics 365 Business Central</em><span> </span><em>Development Quick Start Guide,</em><span> by Stefano Demiliani and Duilio Tacconi.</span></div>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">app.json</h1>
                </header>
            
            <article>
                
<p>The <kbd>app.json</kbd> file, also called the manifest, defines the meta description of the extension and has been provided for each chapter folder already on GitHub. Here is the one for <a href="56634efe-664c-421a-9582-b2a6ae69722a.xhtml" target="_blank">Chapter 5</a>, <a href="0f8efb81-438e-48ed-9f7f-bcfa5caa8e92.xhtml" target="_blank">Chapter 6</a>, <a href="bb9ee41e-4c60-4a27-8fad-5343adfcd86a.xhtml" target="_blank">Chapter 7</a>, and <a href="795b3870-b6f5-43be-953c-0ffd01db9102.xhtml" target="_blank">Chapter 9</a> only listing relevant parts:</p>
<pre>{<br/>  "id": "e26890f8-fafe-49c6-8951-2c1457921f9b",<br/>  "name": "LookupValue",<br/>  "publisher": "fluxxus.nl",<br/>  "brief": "LookupValue extension for book Automated Testing in<br/>               Microsoft Dynamics 365 Business Central",<br/>  "description": "LookupVale extension as basis to test examples<br/>                     in chapters 5, 6, and 7 for book Automated<br/>                     Testing in Microsoft Dynamics 365 Business<br/>                     Central written by Luc van Vugt and published<br/>                     by Packt",<br/>  "version": "1.0.0.0",<br/>  "platform": "14.0.0.0",<br/>  "application": "14.0.0.0",<br/>  "test": "14.0.0.0",<br/>  "idRange": {<br/>    "from": 50000,<br/>    "to": 81099<br/>  },<br/>  "runtime": "2.4",<br/>  "showMyCode": true<br/>}</pre>
<p>Instead of using the <kbd>app.json</kbd> file, as provided on GitHub, you might also use the <kbd>app.json</kbd> file of a newly created VS Code AL project folder, such as the one created previously, to get a <kbd>launch.json</kbd> file. If you do that, make sure that your extension has a different (and unique) name and ID, as I already, while working on this book, deployed the extension <kbd>LookupValue</kbd> a zillion times.</p>
<div class="packt_infobox packt_tip">In <span><span class="packt_screen">Tip #10</span> of the</span> <em>Top tips and tricks on how to create Per-tenant extensions</em> blog (<a href="https://simplanova.com/top-tips-tricks-per-tenant-extensions/">https://simplanova.com/top-tips-tricks-per-tenant-extensions/</a>), Dmitry Katson explains what happens if your extension is not unique and how to make it unique.</div>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">The GitHub repository</h1>
                </header>
            
            <article>
                
<p>The various code examples we used in this book have been uploaded in a dedicated GitHub repository. This repository can be accessed through this link: <a href="https://github.com/PacktPublishing/Automated-Testing-in-Microsoft-Dynamics-365-Business-Central" target="_blank">https://github.com/PacktPublishing/Automated-Testing-in-Microsoft-Dynamics-365-Business-Central</a>.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Structure of the GitHub repository</h1>
                </header>
            
            <article>
                
<p>On the main page of this repository, you will find the following folders:</p>
<ul>
<li><kbd>ATDD Scenarios</kbd></li>
<li><kbd>Chapter 2</kbd></li>
<li><kbd>Chapter 5 (LookupValue Extension)</kbd></li>
<li><kbd>Chapter 6 (LookupValue Extension)</kbd></li>
<li><kbd>Chapter 7 (LookupValue Extension) - refactored and completed</kbd></li>
<li><kbd>Chapter 7 (LookupValue Extension)</kbd></li>
<li><kbd>Chapter 9 (LookupValue Extension)</kbd></li>
<li><kbd>LookupValue Extension (app only)</kbd></li>
<li><kbd>LookupValue Test Extension (test only)</kbd></li>
</ul>
<p>In this section, we will discuss what the various folders contain. Notice that GitHub puts them in alphabetical order. This does not relate to the order in which the folders are used in the book. However, I will elaborate on the order of the book.</p>
<div class="packt_infobox">Like any other GitHub repository, ours also contains a <kbd>LICENSE</kbd> and <kbd>README.md</kbd> file.</div>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Chapter 2</h1>
                </header>
            
            <article>
                
<p>This folder contains the code examples from <a href="1e679d13-4037-48e2-b8ae-f550f507f8c9.xhtml" target="_blank">Chapter 2</a>, <em>The Testability Framework</em>, including the <kbd>MyTestsExecutor</kbd> page and the <kbd>app.json</kbd> file that allows you to deploy the code as an extension.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">ATDD Scenarios</h1>
                </header>
            
            <article>
                
<p>This folder holds the following two Excel files:</p>
<ul>
<li><kbd>Clean sheet.xlsx</kbd></li>
<li><kbd>LookupValue.xlsx</kbd></li>
</ul>
<p>The <kbd>LookupValue</kbd> file contains a listing of all <strong>Acceptance Test-Driven Development</strong> (<strong>ATDD</strong>) scenarios, that is <kbd>GIVEN</kbd>-<kbd>WHEN</kbd>-<kbd>THEN</kbd>, detailing the full customer wish, as introduced in <a href="56634efe-664c-421a-9582-b2a6ae69722a.xhtml" target="_blank">Chapter 5</a>, <em>From Customer Wish to Test Automation - The Basics</em>, for our <kbd>LookupValue</kbd> extension. This was elaborated on further in <a href="56634efe-664c-421a-9582-b2a6ae69722a.xhtml" target="_blank">Chapter 5</a> <a href="56634efe-664c-421a-9582-b2a6ae69722a.xhtml" target="_blank"/>through to <a href="bb9ee41e-4c60-4a27-8fad-5343adfcd86a.xhtml" target="_blank">Chapter 7</a>.</p>
<p>The <kbd>Clean sheet.xlsx</kbd> file is a ready to use clean version to use to write your own ATDD scenarios.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">LookupValue Extension (app only)</h1>
                </header>
            
            <article>
                
<p>This folder contains the application code of the <kbd>LookupValue</kbd> extension, the application code we have been writing test code for in <a href="56634efe-664c-421a-9582-b2a6ae69722a.xhtml" target="_blank">Chapter 5</a>,<a href="56634efe-664c-421a-9582-b2a6ae69722a.xhtml" target="_blank"/> <a href="56634efe-664c-421a-9582-b2a6ae69722a.xhtml" target="_blank"/><a href="0f8efb81-438e-48ed-9f7f-bcfa5caa8e92.xhtml" target="_blank">Chapter 6</a>,<a href="0f8efb81-438e-48ed-9f7f-bcfa5caa8e92.xhtml" target="_blank"/> <a href="bb9ee41e-4c60-4a27-8fad-5343adfcd86a.xhtml" target="_blank">Chapter 7</a>, and <a href="795b3870-b6f5-43be-953c-0ffd01db9102.xhtml" target="_blank">Chapter 9</a>, including the <kbd>app.json</kbd> file that allows you to deploy the code as an extension. Notice that it already contains a <kbd>Test Codeunits</kbd> folder with the bare structure of the first codeunit build in <a href="56634efe-664c-421a-9582-b2a6ae69722a.xhtml" target="_blank">Chapter 5</a>.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Chapter 5 (LookupValue Extension)</h1>
                </header>
            
            <article>
                
<p>Starting from the code in the <kbd>LookupValue Extension (app only)</kbd> folder, this folder adds the completed code examples from <a href="56634efe-664c-421a-9582-b2a6ae69722a.xhtml" target="_blank">Chapter 5</a>, <em>From Customer Wish to Test Automation - The Basics</em>, to the extension. It also includes the <kbd>app.json</kbd> file that allows you to deploy the code as an extension.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Chapter 6 (LookupValue Extension)</h1>
                </header>
            
            <article>
                
<p>Starting from the code in the <kbd>Chapter 5 (LookupValue Extension)</kbd> folder, this folder adds the completed code examples from <a href="0f8efb81-438e-48ed-9f7f-bcfa5caa8e92.xhtml" target="_blank">Chapter 6</a>, <em>From Customer Wish to Test Automation - Next Level</em>. It also includes the <kbd>app.json</kbd> file that allows you to deploy the code as an extension.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Chapter 7 (LookupValue Extension)</h1>
                </header>
            
            <article>
                
<p>Starting from the code in the <kbd>Chapter 6 (LookupValue Extension)</kbd> folder, this folder adds the completed code examples from <a href="bb9ee41e-4c60-4a27-8fad-5343adfcd86a.xhtml" target="_blank">Chapter 7</a>, <em>From Customer Wish to Test Automation - And Some More</em>. It also includes the <kbd>app.json</kbd> file that allows you to deploy the code as an extension.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Chapter 7 (LookupValue Extension) - refactored and completed</h1>
                </header>
            
            <article>
                
<p>This folder contains the refactored and completed application and test code for the whole <kbd>LookupValue</kbd> extension, including the <kbd>app.json</kbd> file that allows you to deploy the code as an extension.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Chapter 9 (LookupValue Extension)</h1>
                </header>
            
            <article>
                
<p>Starting from the code in the <kbd>Chapter 7 (LookupValue Extension) - refactored and completed</kbd> folder, this folder adds the completed code examples from <a href="795b3870-b6f5-43be-953c-0ffd01db9102.xhtml" target="_blank">Chapter 9</a>, <em>Getting Business Central Standard Tests Working on Your Code</em>. It also includes the <kbd>app.json</kbd> file that allows you to deploy the code as an extension.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">LookupValue Test Extension (test only)</h1>
                </header>
            
            <article>
                
<p>As mentioned already in the book, when releasing an extension, it is best practice to separate the application from the test code. For <kbd>AppSource</kbd>, this is even a requirement. This means that the final test extension is built with a dependency on the real extension. This folder contains a separate test extension that belongs to the extension in the <kbd>LookupValue Extension (app only)</kbd> folder.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Notes on the AL code</h1>
                </header>
            
            <article>
                
<p>Now, a final couple of notes on the code on GitHub and the code examples in the book.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">VS Code versus C/SIDE</h1>
                </header>
            
            <article>
                
<p>This book has been focused completely on the modern way of developing a feature, by means of an extension, for Microsoft Dynamics 365 Business Central. The code on GitHub and the code examples in the book are, <span>therefore, </span><span>all in the AL language. But all of the principles that have been presented and used do also apply to developing automated tests in C/SIDE, this being the development environment for Microsoft Dynamics NAV. At this very moment, the standard application and test code of Business Central is still provided by Microsoft in C/SIDE objects.</span></p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Prefix or suffix</h1>
                </header>
            
            <article>
                
<p>When building your own extension, it is best practice to make use of a so-called <em>prefix</em> or <em>suffix</em> in the names of your objects, fields, and controls. We chose not to use a prefix/suffix for the following reasons:</p>
<ul>
<li>The <kbd>LookupValue</kbd> extension is not a registered extension</li>
<li>The use of a prefix/suffix would not contribute to the readability of the code examples</li>
</ul>
<div class="packt_infobox">More information on the usage of a <em>prefix</em> or <em>suffix</em> can be found here: <a href="http://docs.microsoft.com/en-us/dynamics365/business-central/dev-itpro/compliance/apptest-prefix-suffix">http://docs.microsoft.com/en-us/dynamics365/business-central/dev-itpro/compliance/apptest-prefix-suffix</a><a href="http://docs.microsoft.com/en-us/dynamics365/business-central/dev-itpro/compliance/apptest-prefix-suffix"/></div>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Word wrap</h1>
                </header>
            
            <article>
                
<p>When adding code examples to a book, there is always the challenge of how to neatly format long-lined statements to keep the code readable. In the code examples in this book, this has been done by enforcing <em>word wrap,</em> even though the code might not even compile anymore. All of the code in the GitHub repository, however, is technically OK.</p>


            </article>

            
        </section>
    </body></html>