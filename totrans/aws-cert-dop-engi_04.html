<html><head></head><body><div id="sbo-rt-content"><div id="_idContainer046">
			<h1 id="_idParaDest-83"><a id="_idTextAnchor083"/>Chapter 3: Identity and Access Management and Working with Secrets in AWS</h1>
			<p>With a firm understanding of a myriad of fundamental services under our belt, we now move on to <strong class="bold">Identity and Access Management</strong> (<strong class="bold">IAM</strong>).</p>
			<p>Defining the controls and policies that are used to manage access to different <strong class="bold">Amazon Web Services</strong> <strong class="bold">(AWS</strong>) services is what the premise of IAM is all about. This can come in the form of users, groups, policies, and even access, with federated access or short-term credentials. There is also the ability to use outside <strong class="bold">identity providers</strong> (<strong class="bold">IdPs</strong>) to allow users to access your applications. Understanding how to secure secrets using native AWS tools, especially in the context of a <strong class="bold">continuous development</strong> <strong class="bold">(CD</strong>) process, is an enterprise-level skill that is not only present in the DevOps professional exam, but also on the job. </p>
			<p>In this chapter, we're going to cover the following main topics:</p>
			<ul>
				<li>Understanding the Shared Responsibility Model in AWS </li>
				<li>IAM roles, groups, users, and policies</li>
				<li>Using <strong class="bold">AWS Organizations</strong> as part of your guidance </li>
				<li>Integrating federation with an AWS account</li>
				<li>Storing secrets securely in AWS </li>
				<li>Using <strong class="bold">Amazon Cognito</strong> with application authentication</li>
			</ul>
			<h1 id="_idParaDest-84"><a id="_idTextAnchor084"/>Technical requirements</h1>
			<p>As we go through this chapter, you should already have an AWS account created, along with the AWS <strong class="bold">Command-Line Interface</strong> (<strong class="bold">CLI</strong>) <strong class="bold">version 2</strong> (<strong class="bold">v2</strong>) installed so that you can follow along with the hands-on activities presented in this chapter. You will also need more than one AWS account if you are going to practice along with the AWS assume-role exercise. </p>
			<h1 id="_idParaDest-85"><a id="_idTextAnchor085"/>Understanding the Shared Responsibility Model in AWS </h1>
			<p>Although we touched on it briefly in <a href="B17405_01_Final_JM_ePub.xhtml#_idTextAnchor015"><em class="italic">Chapter 1</em></a>, <em class="italic">Amazon Web Service Pillars</em>, understanding <a id="_idIndexMarker281"/>the Shared Responsibility Model is imperative <a id="_idIndexMarker282"/>in order to work with the security of your account, and especially the IAM service. </p>
			<p>The following diagram provides an overview of the model:</p>
			<div>
				<div id="_idContainer027" class="IMG---Figure">
					<img src="Images/Figure_3.1_B17405.jpg" alt="Figure 3.1 – AWS Shared Responsibility Model: Infrastructure as a Service (IaaS) &#13;&#10;" width="516" height="435"/>
				</div>
			</div>
			<p class="figure-caption">Figure 3.1 – AWS Shared Responsibility Model: Infrastructure as a Service (IaaS) </p>
			<p>The essence of this Shared Responsibility Model is about providing flexibility and customer control. With this model there are two major concepts, outlined as follows:</p>
			<ul>
				<li>Who is responsible for <em class="italic">security OF the cloud</em>:<p>This is where AWS holds the responsibility.</p></li>
				<li>Who is responsible for <em class="italic">security IN the cloud</em>:<p>This is where you as the customer hold the responsibility.</p></li>
			</ul>
			<p>AWS controls the global infrastructure, which includes the data centers that host the servers running all of the AWS services. These data centers are run according to security <a id="_idIndexMarker283"/>best practices and a range of security <a id="_idIndexMarker284"/>compliance conventions. Although no customer is allowed to visit an actual data center, independent outside bodies certify and audit the centers and practices to ensure that the controls, policies, and procedures are being followed. </p>
			<p>There are multiple layers in which AWS secures its data centers, outlined as follows:</p>
			<ul>
				<li>At the perimeter layer—The buildings that AWS chooses to house its data and compute <a id="_idIndexMarker285"/>facilities are not disclosed to the public. These facilities also have strict entry requirements, along with intrusion detection and heavy surveillance to protect them. </li>
				<li>At the environmental layer—Before even choosing a location, AWS looks at environmental <a id="_idIndexMarker286"/>risks such as severe weather, flooding, and potential earthquake activity. </li>
				<li>At the infrastructure layer—Inside the building, there is a combination of fire detection <a id="_idIndexMarker287"/>and suppression equipment. </li>
			</ul>
			<p>As a customer, one of the things that you are responsible for is the data you upload, store, and create in your account. You could both store and transmit it unencrypted, depending on what the requirements are for both you and your customers. If this is more stringent than just plaintext data, AWS offers a number of encryption options, or you could manage your own encryption. We will talk more about encrypting data both at rest and in transit later, in <a href="B17405_19_Final_JM_ePub.xhtml#_idTextAnchor447"><em class="italic">Chapter 19</em></a><em class="italic">,</em> <em class="italic">Protecting Data in Flight and at Rest.</em></p>
			<p>Your responsibility on the AWS cloud also lies in who and what you allow to gain access to the various services in your accounts. This is where the IAM service plays a key <a id="_idIndexMarker288"/>role. By default, AWS will not allow access from any application or user to any other services.</p>
			<p>Keeping <a id="_idIndexMarker289"/>the operating <a id="_idIndexMarker290"/>system up to date with any patches and updates on your <strong class="bold">Elastic Compute Cloud</strong> (<strong class="bold">EC2</strong>) instances is also part of your responsibility in the Shared Responsibility Model. There are services such as <strong class="bold">Systems Manager</strong> (<strong class="bold">SSM</strong>) and Amazon Inspector that can help you with this task, identifying <a id="_idIndexMarker291"/>crucial security patches and adhering to a maintenance schedule. If you run the actual infrastructure services, then the ultimate responsibility falls to you. </p>
			<p>How you <a id="_idIndexMarker292"/>allow traffic into your instance via the network layer is also your responsibility. In <a href="B17405_02_Final_JM_ePub.xhtml#_idTextAnchor056"><em class="italic">Chapter 2</em></a>, <em class="italic">Fundamental AWS Services</em>, we discussed the <strong class="bold">virtual private cloud</strong> (<strong class="bold">VPC</strong>) and the tools you have to secure <a id="_idIndexMarker293"/>your network using security groups and <strong class="bold">network access control lists</strong> (<strong class="bold">network ACLs</strong>). Keeping your security rules to only the traffic that you need to allow—and nothing more—prevents outside entities gaining unwanted information from acts such as port scanning and other malicious activities. </p>
			<p>This main shared security and responsibility model that was originally published by AWS reflects the responsibilities around the IaaS model. However, with different <a id="_idIndexMarker294"/>cloud computing models such as <strong class="bold">Platform as a Service</strong> (<strong class="bold">PaaS</strong>), in the case of container service offerings and managed <a id="_idIndexMarker295"/>service offerings that respond more like <strong class="bold">Software as a Service</strong> (<strong class="bold">SaaS</strong>), then Amazon takes even more of the responsibility. </p>
			<p>With the use of containers (especially in the case of Fargate), the security model shifts more to a PaaS model, so more of the responsibilities are pushed to AWS. No longer are you—the customer—responsible for the operating system, since AWS is managing this aspect. You are still, however, responsible for your customer data and the network traffic in and out of the system, as illustrated in the following diagram: </p>
			<div>
				<div id="_idContainer028" class="IMG---Figure">
					<img src="Images/Figure_3.2_B17405.jpg" alt="Figure 3.2 – AWS Shared Responsibility Model: container services&#13;&#10;" width="517" height="379"/>
				</div>
			</div>
			<p class="figure-caption">Figure 3.2 – AWS Shared Responsibility Model: container services</p>
			<p>One of the <a id="_idIndexMarker296"/>main things to understand is that in all <a id="_idIndexMarker297"/>of the Shared Responsibility Models, you are responsible for the protection of your data. This includes how many ports it will be exposed to, along with how it will be encrypted or whether it will be left unencrypted.  </p>
			<h2 id="_idParaDest-86"><a id="_idTextAnchor086"/>Authorization versus authentication</h2>
			<p>As we start to look at IAM, one of the first concepts we need to have a full understanding <a id="_idIndexMarker298"/>of is that of authorization <a id="_idIndexMarker299"/>versus authentication. Although the two terms may sound similar and are used in conjunction with each other quite frequently, understanding the differences between them is important as we move further. </p>
			<h3>Authentication</h3>
			<p>Authentication is the process of verifying who you claim to be. The system is asking who <a id="_idIndexMarker300"/>you are and you are going to respond, many times, with a username and password, but other times with a secure session token. Authentication is answering the questions <em class="italic">Who are you?</em> and <em class="italic">Can you verify who you say you are?</em></p>
			<h3>Authorization</h3>
			<p>Authorization <a id="_idIndexMarker301"/>happens after authentication and establishes what you are allowed to do. Most of the time, it happens after authentication. Rules and policies govern what you are authorized to access. In the <a id="_idIndexMarker302"/>world of computing, this can be relayed through a token, such as a bearer token or a <strong class="bold">JavaScript Object Notation (JSON) Web Token</strong> (<strong class="bold">JWT</strong>) that grants you access to services or <strong class="bold">application processing interfaces</strong> (<strong class="bold">APIs</strong>). </p>
			<p>The processes <a id="_idIndexMarker303"/>of authentication and authorization are illustrated in the following diagram:</p>
			<div>
				<div id="_idContainer029" class="IMG---Figure">
					<img src="Images/Figure_3.3_B17405.jpg" alt="Figure 3.3 – Authentication versus authorization&#13;&#10;" width="447" height="326"/>
				</div>
			</div>
			<p class="figure-caption">Figure 3.3 – Authentication versus authorization</p>
			<p>It can be easy to confuse authentication and authorization since they seem similar, but think of authentication as your picture identification and authorization as a <strong class="bold">radio-frequency identification</strong> (<strong class="bold">RFID</strong>) badge that allows you access. Let's take <a id="_idIndexMarker304"/>a look at another example for further clarity.  </p>
			<h3>A practical example of authorization versus authentication </h3>
			<p>At many large office buildings, you need an ID badge with a photo to enter the building. In most <a id="_idIndexMarker305"/>cases, you are required to wear the badge at <a id="_idIndexMarker306"/>all times to show you have <strong class="bold">authorization</strong> to be in the building without being stopped by security. As you move to the elevator, you might need to scan your badge to access the floor you work on. Pressing <a id="_idIndexMarker307"/>your ID badge, which contains an RFID chip that is tied back to the policy system and your user profile, lets the central system know which floors you are allowed to access. If you work on the third floor, then you are <strong class="bold">authenticated</strong> to press button number 3 and then travel up to the third floor. There might be other doors in the building to which you may or may not have access at all, based on the level of your authentication. </p>
			<h2 id="_idParaDest-87"><a id="_idTextAnchor087"/>Terms to understand for IAM </h2>
			<p>As we begin to talk about the IAM service and its individual components, it's important to <a id="_idIndexMarker308"/>initially lay out the terms we will be using, along with their definitions. There is no need to memorize these terms for the professional exam, but they are the components of the whole service that you are expected to know from the lower exams. These terms are listed out here:</p>
			<ul>
				<li><strong class="bold">Principal</strong>: An application or person that uses either the AWS root account <a id="_idIndexMarker309"/>user, an IAM user, or an IAM role to authenticate to the account and make requests. This is someone or something that can take action on an AWS resource. </li>
				<li><strong class="bold">Resources</strong>: A <a id="_idIndexMarker310"/>resource is an item that you can work with inside of an AWS <a id="_idIndexMarker311"/>account. An example of a resource could include a Lambda function, an EC2 instance, or a <strong class="bold">Simple Storage Service</strong> (<strong class="bold">S3</strong>) bucket. </li>
				<li><strong class="bold">Entities</strong>: An entity can be an IAM user, a federated user, or a user who is coming <a id="_idIndexMarker312"/>in from an IdP, or it can be an assumed IAM role in the context of AWS. It is simply the IAM resource object that AWS uses for authentication. </li>
				<li><strong class="bold">Identities</strong>: The <a id="_idIndexMarker313"/>resources that are used to identify who is using the services are known as identities in IAM. These are your users, groups, and roles. </li>
			</ul>
			<h3>Ways IAM can authenticate with a principal </h3>
			<p>IAM has <a id="_idIndexMarker314"/>several ways in which it can authenticate with a principal, outlined as follows:</p>
			<ul>
				<li><strong class="bold">Username and p</strong><strong class="bold">assword</strong>—A username and password are the initial way to get into the AWS Management Console. </li>
				<li><strong class="bold">Access key and secret access key</strong>—These are long-term security credentials that can be associated with users or the root user. They can be rotated, and a maximum of two access keys can be associated with any user at any single time. </li>
				<li><strong class="bold">Session token</strong>—You can <a id="_idIndexMarker315"/>use an assumed role to take advantage of the <strong class="bold">Security Token Service</strong> (<strong class="bold">STS</strong>) to pass a token that will allow you or your application to gain the allocated access. <p class="callout-heading">Note </p><p class="callout">AWS Management Console users can't use their username and password credentials to run any particular program and access AWS services or underlying infrastructure by default. This all comes with the authorization provided by IAM policies. </p></li>
			</ul>
			<h3>Authorization concepts with IAM </h3>
			<p>As you <a id="_idIndexMarker316"/>look to add authorization to your users and applications, there are two models to be aware of: <strong class="bold">role-based access control</strong> (<strong class="bold">RBAC</strong>) and <strong class="bold">attribute-based access control</strong> (<strong class="bold">ABAC</strong>). We will go over the concepts of each next. </p>
			<h3>RBAC </h3>
			<p>Traditional <a id="_idIndexMarker317"/>access control is based on grouping users and applications into groups (or roles) and then assigning permissions to the group. Many times, these are job functions, and the permissions that are associated with the group deal with the responsibilities of that job function. </p>
			<p>Mapping specific sets of permissions to a role, defining that role as a group in an authentication <a id="_idIndexMarker318"/>service such as <strong class="bold">Active Directory</strong> (<strong class="bold">AD</strong>) or AWS IAM, and then placing users in that group so that they may assume those permissions is defined as RBAC. </p>
			<h3>ABAC </h3>
			<p>There <a id="_idIndexMarker319"/>are three different types <a id="_idIndexMarker320"/>of attributes on which ABAC can base access control, listed here:</p>
			<ul>
				<li>User attributes</li>
				<li>Attributes associated with the system to be accessed </li>
				<li>Current environmental conditions </li>
			</ul>
			<p>In AWS, most of these attributes are managed with tags, account information (that is, account <a id="_idIndexMarker321"/>number, alias, or <strong class="bold">organizational unit</strong> (<strong class="bold">OU</strong>)), and federated data associated with the user. </p>
			<h3>IAM service concepts </h3>
			<p>One of the <a id="_idIndexMarker322"/>most important concepts when using IAM and as you navigate through AWS access is to give only the minimal permissions necessary to do the job, and no more. </p>
			<h1 id="_idParaDest-88"><a id="_idTextAnchor088"/>IAM roles, groups, users, and policies </h1>
			<p>Controlling <a id="_idIndexMarker323"/>access to your resources in IAM comes down to how you <a id="_idIndexMarker324"/>craft your policies that you attach to your users, groups, and <a id="_idIndexMarker325"/>roles. Services themselves assume roles, and users are created <a id="_idIndexMarker326"/>in IAM and are much more easily managed if placed into groups. </p>
			<p class="callout-heading">Note</p>
			<p class="callout">There is a service limit of 500 IAM users per account. </p>
			<h2 id="_idParaDest-89"><a id="_idTextAnchor089"/>IAM policies </h2>
			<p>An IAM policy is a set of permissions expressed as a JSON statement that says which access permissions an entity has. </p>
			<p>As you start to dole out the permissions in your account, you will deal with these IAM policies. There are a number of policies that have been pre-crafted by AWS to help you get started, either to attach to users and groups or for services. Many AWS-based policies will have the resource listed as <strong class="source-inline">*</strong>; however, this allows for any resource to be accessed. There are multiple ways in which we can constrain the amount of resources that can be accessed, even in the case of a simple policy. </p>
			<p>Let's look here at a very simple example of an IAM policy that shows how we can give access to all object actions on all S3 buckets in the account, using wildcards: </p>
			<p class="source-code">{</p>
			<p class="source-code">    "Version": "2012-10-17",</p>
			<p class="source-code">    "Statement": [</p>
			<p class="source-code">        {</p>
			<p class="source-code">            "Sid": "AllS3ObjectActions",</p>
			<p class="source-code">            "Effect": "Allow",</p>
			<p class="source-code">            "Action": "s3:*Object",</p>
			<p class="source-code">            "Resource": ["*"]</p>
			<p class="source-code">        }</p>
			<p class="source-code">    ]</p>
			<p class="source-code">}</p>
			<p>We can, however, restrict <a id="_idIndexMarker327"/>which bucket our user can access by changing the resource line of the policy, as follows: </p>
			<p class="source-code">{</p>
			<p class="source-code">    "Version": "2012-10-17",</p>
			<p class="source-code">    "Statement": [</p>
			<p class="source-code">        {</p>
			<p class="source-code">            "Sid": "AllS3ObjectActions",</p>
			<p class="source-code">            "Effect": "Allow",</p>
			<p class="source-code">            "Action": "s3:*Object",</p>
			<p class="source-code">            "Resource": ["arn:aws:s3:::my-bucket/*"]</p>
			<p class="source-code">        }</p>
			<p class="source-code">    ]</p>
			<p class="source-code">}</p>
			<p>There are a number of different policy types that are available for use in AWS, as outlined in the following list. Each has its own role when it comes to permissions: </p>
			<ul>
				<li>Identity-based policies </li>
				<li>Resource-based policies </li>
				<li>Permissions <a id="_idIndexMarker328"/>boundaries </li>
				<li>Organizations' <strong class="bold">service control policies</strong> (<strong class="bold">SCPs</strong>) </li>
				<li>ACLs </li>
				<li>Session policies </li>
			</ul>
			<p>Now we know <a id="_idIndexMarker329"/>how IAM policies work, along with the different types of policies available, let's look at some of fundamental concepts around IAM policies and how the different types of policies work together to form effective permissions. </p>
			<h3>IAM policy concepts </h3>
			<p>As you start to use IAM, you need to have an understanding of how the service evaluates <a id="_idIndexMarker330"/>policy requests based on its internal logic. Here is an overview of the rules that you need to remember: </p>
			<ul>
				<li>By default, all requests are denied (unless you are the root user). </li>
				<li>If any service has been explicitly denied, this rule takes precedence, even if another rule has the service allowed. </li>
				<li>An explicit <strong class="source-inline">allow</strong> in a policy will override the default implicit <strong class="source-inline">deny</strong>.</li>
				<li>If a SCP, session policy, or permissions boundary grants access to a service then it too will override the implicit <strong class="source-inline">deny</strong>.</li>
			</ul>
			<p>For a deeper understanding of how the rules are processed, I suggest you read the documentation available here: <a href="https://docs.aws.amazon.com/IAM/latest/UserGuide/reference_policies_evaluation-logic.html">https://docs.aws.amazon.com/IAM/latest/UserGuide/reference_policies_evaluation-logic.html</a>.</p>
			<p>In the diagram pictured in <em class="italic">Figure 3.4</em> are three circles. The bottommost circle is the identity-based policy—that is, where the user or group is granting the permissions for that effective user. However, there are other identity policies at play that can limit—or in some cases expand—the effective permissions for a user. The center of where all the policies intersect—and in this case where the arrow is pointing—is the effective permission set for the user, as illustrated here:  </p>
			<div>
				<div id="_idContainer030" class="IMG---Figure">
					<img src="Images/Figure_3.4_B17405.jpg" alt="Figure 3.4 – Effective policy permissions&#13;&#10;" width="450" height="366"/>
				</div>
			</div>
			<p class="figure-caption">Figure 3.4 – Effective policy permissions</p>
			<p>With knowledge <a id="_idIndexMarker331"/>of how these different types of polices interact together to form effective permissions, we can now go about creating our identities in the forms of roles, groups, and users. </p>
			<h3>Identities </h3>
			<p>When you first create your AWS account, the email account you use to sign up with becomes <a id="_idIndexMarker332"/>your AWS root user. Although you have the ability to access the Management Console with this root user, and this user has a full unrestricted set of permissions to all services and resources in your AWS account, it is not recommended that you start creating resources and workloads with this user.  </p>
			<p>In the following diagram, we can see an example of how the root user is at the top of the AWS account structure, and then our groups are inherited by both users and roles: </p>
			<div>
				<div id="_idContainer031" class="IMG---Figure">
					<img src="Images/Figure_3.5_B17405.jpg" alt="Figure 3.5 – IAM users and groups &#13;&#10;" width="465" height="424"/>
				</div>
			</div>
			<p class="figure-caption">Figure 3.5 – IAM users and groups </p>
			<p>Once we have <a id="_idIndexMarker333"/>mapped out which groups we want to create in our account, along with the basis of the permissions that each group or role will be inheriting, we can then go about creating these groups. </p>
			<h3>IAM groups </h3>
			<p>Here are <a id="_idIndexMarker334"/>some important things to know about groups:</p>
			<ul>
				<li>A user can belong to multiple groups, and groups can have multiple users.</li>
				<li>Groups can only contain users, not other groups, hence groups can't be nested inside of each other and inherit privileges. </li>
				<li>Users must be manually added to a group. Upon creation of a user or role, there is no default group where permissions are automatically assigned. </li>
			</ul>
			<h4>Creating IAM groups </h4>
			<p>Before we <a id="_idIndexMarker335"/>actually add our users, let's create our groups and associate the Amazon-managed IAM policies with those groups, as shown in <em class="italic">Figure 3.5</em>. We will make the following groups and then associate the following managed policies with them: </p>
			<div>
				<div id="_idContainer032" class="IMG---Figure">
					<img src="Images/Figure_3.6_B17405.jpg" alt="Figure 3.6 – Groups and their associated managed policies&#13;&#10;" width="1298" height="335"/>
				</div>
			</div>
			<p class="figure-caption">Figure 3.6 – Groups and their associated managed policies</p>
			<p>Now that we know which groups we are going to set up, let's use our CLI to create those groups, as follows:</p>
			<ol>
				<li value="1">Open up your terminal and type the following commands so that we can create our first group (<strong class="source-inline">Admins</strong>):<p class="source-code"><strong class="bold">$aws iam create-group --group-name Admins</strong></p><p>After executing the command, there should be a return somewhat like this:</p><p class="source-code"><strong class="bold">{</strong></p><p class="source-code"><strong class="bold">    "Group": {</strong></p><p class="source-code"><strong class="bold">        "Path": "/",</strong></p><p class="source-code"><strong class="bold">        "GroupName": "Admins",</strong></p><p class="source-code"><strong class="bold">        "GroupId": "AGPAW24Q7QQF4DBRNWTM4",</strong></p><p class="source-code"><strong class="bold">        "Arn": "arn:aws:iam::470066103307:group/Admins",</strong></p><p class="source-code"><strong class="bold">        "CreateDate": "2021-03-11T22:36:46+00:00"</strong></p><p class="source-code"><strong class="bold">    }</strong></p><p class="source-code"><strong class="bold">}</strong></p><p>We can create the rest of the groups the same way by substituting the rest of the group names where the current command has the group name  <strong class="source-inline">Admins</strong> at the end of it.</p></li>
				<li>Now, let's check the current groups in our account, as follows: <p class="source-code"><strong class="bold">$aws iam list-groups --output text</strong></p><p>Notice how I changed the output here—this method for the four groups I'm about <a id="_idIndexMarker336"/>to show is not going to take multiple pages with the spacing that JSON formatting takes up. The output should be similar to what is shown here:</p><p class="source-code"><strong class="bold">GROUPS  arn:aws:iam::470066103307:group/Admins  2021-03-11T22:36:46+00:00       AGPAW24Q7QQF4DBRNWTM4   Admins  /</strong></p><p class="source-code"><strong class="bold">GROUPS  arn:aws:iam::470066103307:group/Billing 2021-03-11T22:41:23+00:00       AGPAW24Q7QQF2FJB3ZW27   Billing /</strong></p><p class="source-code"><strong class="bold">GROUPS  arn:aws:iam::470066103307:group/Developers       2021-03-11T22:54:10+00:00       AGPAW24Q7QQF7NUSSDSWF   Developers      /</strong></p><p class="source-code"><strong class="bold">GROUPS  arn:aws:iam::470066103307:group/Testers 2021-03-11T22:51:26+00:00       AGPAW24Q7QQFZ6FIU6WDA   Testers /</strong></p></li>
				<li>Once we see all the groups listed, we can now start to attach the managed <a id="_idIndexMarker337"/>policies we identified before. However, in using the CLI, we need to know the <strong class="bold">Amazon Resource Name</strong> (<strong class="bold">ARN</strong>) of the policy we want to attach to the group. The good news is that we have already previously identified the exact name of the AWS managed policies we want to attach to our group, and with the CLI we can also combine shell commands such as <strong class="source-inline">grep</strong> to help our search, as illustrated in the following code snippet:<p class="source-code"><strong class="bold">$aws iam list-policies --scope AWS|grep 'AdministratorAccess'</strong></p><p>Notice how we first did the AWS CLI command and then piped the output to the <strong class="source-inline">grep</strong> command to quickly search through the output and find the exact name we were looking for. We were able to use some of the command-line flags to help narrow our initial search; however, there isn't a great option to search for a particular policy name. If you would like to read more <a id="_idIndexMarker338"/>about the options for the command, you can find all flags available on the documentation page listed here: <a href="https://docs.aws.amazon.com/cli/latest/reference/iam/list-policies.html">https://docs.aws.amazon.com/cli/latest/reference/iam/list-policies.html</a>.</p><p>The output should look like this:</p><p class="source-code"><strong class="bold">          "PolicyName": "AdministratorAccess",</strong></p><p class="source-code"><strong class="bold">            "Arn": "arn:aws:iam::aws:policy/AdministratorAccess",</strong></p><p class="source-code"><strong class="bold">            "PolicyName": "AdministratorAccess-Amplify",</strong></p><p class="source-code"><strong class="bold">            "Arn": "arn:aws:iam::aws:policy/AdministratorAccess-Amplify",</strong></p><p class="source-code"><strong class="bold">            "PolicyName": "AdministratorAccess-AWSElasticBeanstalk",</strong></p><p class="source-code"><strong class="bold">            "Arn": "arn:aws:iam::aws:policy/AdministratorAccess-AWSElasticBeanstalk",</strong></p><p class="source-code"><strong class="bold">            "PolicyName": "AWSAuditManagerAdministratorAccess",</strong></p><p class="source-code"><strong class="bold">            "Arn": "arn:aws:iam::aws:policy/AWSAuditManagerAdministratorAccess",</strong></p><p>You'll notice that not only one policy ARN came back—a total of four were returned. We are really looking for a policy named <strong class="source-inline">AdministratorAccess</strong>, which was the first returned result. The others were returned because they had <strong class="source-inline">AdministratorAccess</strong> as part of their name. </p></li>
				<li>Now that we have found the ARN for our managed policy, we can attach it to our group, as illustrated in the following code snippet. Once the IAM policy is attached to the group, any users we add later will automatically assume those permissions: <p class="source-code"><strong class="bold">$aws iam attach-group-policy --policy-arn arn:aws:iam::aws:policy/AdministratorAccess --group-name Admins</strong></p><p>Once you execute this command, it will not give you any return or feedback. </p></li>
				<li>We could <a id="_idIndexMarker339"/>check from the command line to see if our policy was attached to our group by using the following command:<p class="source-code"><strong class="bold">$aws iam list-attached-group-policies --group-name Admins</strong></p><p>This will then bring back the policy we just affixed to the group, as illustrated in the following code snippet:</p><p class="source-code"><strong class="bold">{</strong></p><p class="source-code"><strong class="bold">    "AttachedPolicies": [</strong></p><p class="source-code"><strong class="bold">        {</strong></p><p class="source-code"><strong class="bold">            "PolicyName": "AdministratorAccess",</strong></p><p class="source-code"><strong class="bold">            "PolicyArn": "arn:aws:iam::aws:policy/AdministratorAccess"</strong></p><p class="source-code"><strong class="bold">        }</strong></p><p class="source-code"><strong class="bold">    ]</strong></p><p class="source-code"><strong class="bold">}</strong></p><p>At this point, we're done for the moment. We will need to create our users in order to add them to the group. </p><p class="callout-heading">Note</p><p class="callout">We could have also done this using a CloudFormation script, which would have made it a lot easier to roll back or clean up any groups we just made. We are going to <a id="_idIndexMarker340"/>take a deep dive into CloudFormation and <strong class="bold">Infrastructure as Code</strong> (<strong class="bold">IaC</strong>) in <a href="B17405_07_Final_JM_ePub.xhtml#_idTextAnchor188"><em class="italic">Chapter 7</em></a>,<em class="italic"> Using CloudFormation Templates to Deploy Workloads</em>. </p></li>
			</ol>
			<h3>IAM users </h3>
			<p>An IAM user is a person or application who is credentialed to access and interact with a specified set of AWS services. </p>
			<p>When you <a id="_idIndexMarker341"/>create your account, you are automatically provisioned as a root account user. </p>
			<p>After creating a user, they start with no permissions, nor are they authorized to perform any actions on AWS resources until you or another administrator (or person with IAM permissions) grant them access via an inline policy, attach a managed policy to their user, or add them to a group.  </p>
			<p>IAM users cannot be associated with more than one AWS account.</p>
			<p>The user's section <a id="_idIndexMarker342"/>of IAM is also where you store each individual user's <strong class="bold">Secure Shell</strong> (<strong class="bold">SSH</strong>) keys to access the AWS Git service CodeCommit. We don't dive deep into CodeCommit until <a href="B17405_08_Final_JM_ePub.xhtml#_idTextAnchor212"><em class="italic">Chapter 8</em></a>,<em class="italic"> Creating Workloads with CodeCommit and CodeBuild </em>; however, understanding how the keys, users, and IAM permissions interact is important, especially if you want your users to have the ability to self-manage, add, remove, and rotate their own SSH keys. </p>
			<p>If you would like to create more users with specified roles for your account then you can do so with the new roles that you have just created, using the steps outlined in <a href="B17405_02_Final_JM_ePub.xhtml#_idTextAnchor056"><em class="italic">Chapter 2</em></a>,<em class="italic"> Fundamental AWS Services,</em> to create a user. </p>
			<h3>Roles </h3>
			<p>IAM roles allow <a id="_idIndexMarker343"/>you to empower services, applications, and other AWS services to have access without hardcoding credentials such as access key and secret access key directly into the application—or in the case of a user, even create an access key and secret access key pair. </p>
			<p>Roles are also extremely useful when switching between accounts. If you have multiple accounts—let's say, development, testing, and production accounts—you can use your user in the development account and then create a role in the other two accounts, which are allowed to be assumed by your main user. </p>
			<p>Another advantage to roles is that they can be assumed by multiple instances of the same service (for example, EC2/Lambda). Just as in IAM groups, if you need to add more permissions or remove permissions from a role's policy, those changes take effect almost immediately. </p>
			<p>In the case of EC2, you would use an <strong class="bold">instance profile</strong> to pass a role to an EC2 instance. An instance profile <a id="_idIndexMarker344"/>can only contain one role, and this is a hard service limit that cannot be increased. If the permission needs of the instance change, you can remove the current role attached to the instance profile and then attach a different role that contains a distinct set of permissions.</p>
			<p>Roles and role <a id="_idIndexMarker345"/>assumption are also a way to provide access to third parties who may also have their own AWS account but may need limited access to your account. This could be a third-party partner or an auditor who may just need read-only access. </p>
			<p class="callout-heading">Note</p>
			<p class="callout">For this exercise we will need two accounts, as follows:</p>
			<p class="callout"><strong class="bold">Account A</strong>: This will be the account where we will create a role that we will allow to be assumed. </p>
			<p class="callout"><strong class="bold">Account B</strong>: This will be the account we have been working on previously and will use one of our previously created users to assume the role and go to the other account. </p>
			<p>Before you start, it would be a good idea to know the account numbers and have them in a text document labeled <em class="italic">Account A</em> and <em class="italic">Account B</em>. This will make things easier when we start to go through the process of setting up the role. If you don't know your AWS account number, then the easiest way to find it is to click on your username on the top of the main menu. When the drop-down menu appears, then one of the items in that menu is <strong class="bold">Account</strong>, with your account number. </p>
			<p>We will first go into <em class="italic">Account A</em> and create a role to be assumed, as follows: </p>
			<ol>
				<li value="1">Sign in to the console with a user on <em class="italic">Account A</em> who has either Admin user privileges or the ability to create IAM users and roles.</li>
				<li>Navigate to the IAM service at <a href="https://console.aws.amazon.com/iam/home">https://console.aws.amazon.com/iam/home</a>.</li>
				<li>In the left-hand menu, click <strong class="bold">Roles</strong>. </li>
				<li>Once the <strong class="bold">Roles</strong> screen appears in the main window, click the blue button labeled <strong class="bold">Create Role</strong>. </li>
				<li>The type of trusted identity you want to choose on the next screen is <strong class="bold">Another AWS account</strong>, as illustrated in the following screenshot: <div id="_idContainer033" class="IMG---Figure"><img src="Images/Figure_3.7_B17405.jpg" alt="Figure 3.7 – Creating an IAM role&#13;&#10;" width="1105" height="238"/></div><p class="figure-caption">Figure 3.7 – Creating an IAM role</p></li>
				<li>Enter the <a id="_idIndexMarker346"/>account number of <em class="italic">Account B</em> into the <strong class="bold">Account</strong> field and then press the <strong class="bold">Next: Permissions</strong> button at the bottom of the page. </li>
				<li>On the <strong class="bold">Attach Permissions Policies</strong> page, in the search box type <strong class="source-inline">S3FullAccess</strong>. This should bring up the <strong class="source-inline">AmazonS3FullAccess</strong> policy. Click the box next to this policy name. After you have checked the box, as illustrated in the following screenshot, then click the blue button at the bottom of the page, labeled <strong class="bold">Next: Tags</strong>:<div id="_idContainer034" class="IMG---Figure"><img src="Images/Figure_3.8_B17405.jpg" alt="Figure 3.8 – IAM S3 full access policy &#13;&#10;" width="559" height="176"/></div><p class="figure-caption">Figure 3.8 – IAM S3 full access policy </p></li>
				<li>We are not adding any tags in this exercise, so just click the blue button at the bottom of the screen that says <strong class="bold">Next: Review</strong>. </li>
				<li>Once we get to the <strong class="bold">Review</strong> page, we can then name our role <strong class="source-inline">AssumeS3</strong>; if you would <a id="_idIndexMarker347"/>like to type a description, you can do so (see the example description in the following screenshot), but this is not necessary. Make sure that everything looks correct and then click the <strong class="bold">Create role</strong> button at the bottom: </li>
			</ol>
			<div>
				<div id="_idContainer035" class="IMG---Figure">
					<img src="Images/Figure_3.9_B17405.jpg" alt="Figure 3.9 – IAM assume S3 role review &#13;&#10;" width="581" height="415"/>
				</div>
			</div>
			<p class="figure-caption">Figure 3.9 – IAM assume S3 role review </p>
			<p>Now that we have our role set up in <em class="italic">Account A</em>, we can log out of this account and then log back in to <em class="italic">Account B</em> so that we can use this new role we created to switch from our main role to the <strong class="source-inline">AssumeS3</strong> role in <em class="italic">Account A</em>, as follows: </p>
			<ol>
				<li value="1">Once we have logged in, then click on your name in the top right-hand menu to expose the drop-down menu (we did this previously to find our account numbers). </li>
				<li>With the drop-down menu exposed, click on the menu item labeled <strong class="bold">Switch Roles</strong>, as illustrated in the following screenshot:<div id="_idContainer036" class="IMG---Figure"><img src="Images/Figure_3.10_B17405.jpg" alt="Figure 3.10 – Switching roles from AWS Management Console&#13;&#10;" width="240" height="380"/></div><p class="figure-caption">Figure 3.10 – Switching roles from AWS Management Console</p></li>
				<li>Now, on the <strong class="bold">Switch Roles</strong> screen, click the blue button labeled <strong class="bold">Switch Role</strong>.</li>
				<li>On the <a id="_idIndexMarker348"/>next screen, you will be presented with three textboxes to fill out, as follows: <p>a. In the box labeled <strong class="bold">Account</strong>, cut and paste the account number from <em class="italic">Account A</em>.</p><p>b. In the box labeled <strong class="bold">Role</strong>, type in the name of the role we created previously (<strong class="source-inline">AssumeS3</strong>).</p><p>c. In the box labeled <strong class="bold">Display Name</strong>, type in <strong class="source-inline">AccountA_S3</strong>, as illustrated in the following screenshot:</p><div id="_idContainer037" class="IMG---Figure"><img src="Images/Figure_3.11_B17405.jpg" alt="Figure 3.11 – Assuming role in Account A &#13;&#10;" width="598" height="310"/></div><p class="figure-caption">Figure 3.11 – Assuming role in Account A </p><p>With this information entered, you are now ready to switch roles. </p></li>
				<li>After entering all this information, click the blue <strong class="bold">Switch Role</strong> button. </li>
				<li>You should now be in <em class="italic">Account A</em> with the <strong class="source-inline">AssumeS3</strong> permissions signified by the color at the top of the menu bar, along with the display name of the role, as illustrated in the following screenshot: </li>
			</ol>
			<div>
				<div id="_idContainer038" class="IMG---Figure">
					<img src="Images/Figure_3.12_B17405.jpg" alt="Figure 3.12 – AWS Management Console showing successful role switch &#13;&#10;" width="250" height="72"/>
				</div>
			</div>
			<p class="figure-caption">Figure 3.12 – AWS Management Console showing successful role switch </p>
			<p>We've just <a id="_idIndexMarker349"/>seen how roles can help us manage the permissions in our own account, as well as giving us the ability to take on a defined permission set in another account. Next, we will look at both ways to put limits in place from an account level with permissions boundaries, along with some IAM best practices. </p>
			<h3>Permissions boundaries </h3>
			<p>Permissions boundaries are an advanced feature of IAM that allows you to use AWS managed <a id="_idIndexMarker350"/>policies but set the maximum resource limits for those policies. In practical usage, permissions boundaries can be extremely helpful to allow you to take an AWS managed policy that has the permissions you need for a service and attach it to a user, group, or role and then keep that entity from going outside of the resources they need to access using the permissions boundary policy. </p>
			<p>If we refer back to <em class="italic">Figure 3.4</em>, look where the identity-based policy intersects with the permissions boundary policy. In the middle of those two policies is the effective policy for the entity. Most managed policies provided by AWS allow for a full scope <a id="_idIndexMarker351"/>in the <strong class="bold">Resource</strong> field, denoted with an asterisk (<strong class="source-inline">*</strong>). For most organizations, both large and small, this is too wide open a permission set. Not only does this present a security concern across different sectors of an organization, but also limiting the access helps mitigate any blast radius that a user could cause in an accidental situation. </p>
			<h3>IAM best practices </h3>
			<p>Let's take <a id="_idIndexMarker352"/>a look at some best practices when using IAM, as follows:</p>
			<ul>
				<li>Don't use the root account for day-to-day access. Only use the root account for the initial setup of administrative users and in emergency/break-glass scenarios. </li>
				<li>Always set up <strong class="bold">multi-factor authentication</strong> (<strong class="bold">MFA</strong>) for your root user. Also, it's a <a id="_idIndexMarker353"/>best practice to put MFA in place for any account administrators. Try to put MFA in place for all users.</li>
				<li>Set up a password policy that requires users to set a strong password that needs to be rotated on a regular basis. </li>
				<li>Don't set permissions directly to users; instead, use groups or allow users to assume roles—set permission sets to the roles and allow users to assume the roles.</li>
				<li>Don't allow secrets to be left in plaintext in code. Use a secret store such as Secrets Manager or Parameter Store to securely store secrets.</li>
			</ul>
			<p>In the next section, we will learn about using <strong class="bold">AWS Organizations</strong> as part of your guidance.</p>
			<h1 id="_idParaDest-90"><a id="_idTextAnchor090"/>Using AWS Organizations as part of your guidance </h1>
			<p><strong class="bold">AWS Organizations</strong> is a service that helps you consolidate multiple AWS accounts for <a id="_idIndexMarker354"/>ease of management and billing. Not only does AWS Organizations help you create new accounts under the organizational umbrella quickly and easily, but it also provides features for governance that are not available in a standalone AWS account. </p>
			<p>The two features of relevance to IAM are OUs and SCPs.</p>
			<h2 id="_idParaDest-91"><a id="_idTextAnchor091"/>Separation with OUs </h2>
			<p>To understand OUs, we need <a id="_idIndexMarker355"/>to initially look at two basic concepts, as follows:</p>
			<ul>
				<li>Organization</li>
				<li>Root </li>
			</ul>
			<p>An <strong class="bold">organization</strong> is an entity that you create to unify the different AWS accounts under your <a id="_idIndexMarker356"/>control so that you can oversee them as a single unit. There is one master account assigned to an organization that can then branch off into zero or more units. Many times, organizations are organized in a tree-like configuration, with the root account at the top and the OUs and child accounts branching out underneath. </p>
			<p>The <strong class="bold">root</strong> is the <a id="_idIndexMarker357"/>origin container for all other accounts in your organization. If you apply an SCP to the root account, it trickles down and hence gets applied to all organizational accounts and child accounts that are part of the organization. </p>
			<p>An OU is simply a container for grouping accounts under the root account. Organizational accounts can be nested inside of other OU units creating the hierarchy of your organization, with the root account sitting at the top. </p>
			<h3>Features of organizations</h3>
			<p>Organizations allow you to centrally manage policies across AWS accounts. This helps you <a id="_idIndexMarker358"/>improve control over your AWS environment by using <strong class="bold">AWS Organizations</strong> to create a group of accounts and then attaching policies to a specified group, establishing that the correct policies are applied across those accounts without a need for any custom scripting. </p>
			<p>You can integrate AWS <strong class="bold">single sign-on</strong> (<strong class="bold">SSO</strong>) to simply provision access for your users to <a id="_idIndexMarker359"/>different accounts in your organizations, in a single place.</p>
			<p>SCPs allow organizations to administer permission guardrails to AWS services, resources, and regions.  </p>
			<p><strong class="bold">AWS Organizations</strong> also allows you to easily set up consolidated billing, using a single payment method for all of the accounts in an organization. This allows you to benefit from pricing advantages such as aggregated usage and volume discounts on different services that would not be available if all accounts were separated. </p>
			<h2 id="_idParaDest-92"><a id="_idTextAnchor092"/>SCPs </h2>
			<p>SCPs are a <a id="_idIndexMarker360"/>tool that you can use <a id="_idIndexMarker361"/>to manage policies throughout a specific OU or throughout your entire organization, through inheritance. They can either enhance or limit the scope of the permissions that your users currently have, and they are at their most effective when combined with advanced IAM constructs such as <strong class="source-inline">Condition</strong>, <strong class="source-inline">ArnNotLike</strong>, <strong class="source-inline">StringNotLike</strong>, and specific regions to provide the guardrails that your organization agrees upon, to ensure that users don't intentionally or unintentionally perform inappropriate actions. </p>
			<h3>Example of a SCP </h3>
			<p>The following <a id="_idIndexMarker362"/>code snippet provides an example of a SCP that you could attach at the root level of your organization to make sure that if anyone were going to delete an EC2 or <strong class="bold">Relational Database Service</strong> (<strong class="bold">RDS</strong>) instance, then a multi-factor device would first need <a id="_idIndexMarker363"/>to be present for verification: </p>
			<p class="source-code">{</p>
			<p class="source-code">  "Version": "2012-10-17",</p>
			<p class="source-code">  "Statement": [</p>
			<p class="source-code">    {</p>
			<p class="source-code">      "Sid": "DenyDeleteandTerminateWhenMFAIsNotPresent",</p>
			<p class="source-code">      "Effect": "Deny",</p>
			<p class="source-code">      "Action": [</p>
			<p class="source-code">        "rds:Delete*",</p>
			<p class="source-code">        "ec2:TerminateInstances"</p>
			<p class="source-code">      ],</p>
			<p class="source-code">      "Resource": "*",</p>
			<p class="source-code">      "Condition": {"BoolIfExists": {"aws:MultiFactorAuthPresent": false}}</p>
			<p class="source-code">    }</p>
			<p class="source-code">  ]</p>
			<p class="source-code">}</p>
			<p>You'll notice <a id="_idIndexMarker364"/>how the SCP syntax looks almost exactly like the normal IAM policy syntax, containing an <strong class="source-inline">Effect</strong>, <strong class="source-inline">Action</strong>, <strong class="source-inline">Resource</strong>, and <strong class="source-inline">SID</strong>. This SCP actually has an optional value of a condition, which is where we are checking to see whether the MFA exists and if not, then the action is denied.</p>
			<h1 id="_idParaDest-93"><a id="_idTextAnchor093"/>Integrating federation with an AWS account </h1>
			<p>If the <a id="_idIndexMarker365"/>users who will be accessing <a id="_idIndexMarker366"/>your account already have an authentication method, then there are a few different methods to incorporate federation into your AWS account. </p>
			<p><em class="italic">"Identity federation is a system of trust between two parties for the purpose of authenticating users and conveying information needed to authorize access to resources. In this system, an Identity Provider (IdP) is responsible for user authentication, and a service provider (SP), such as a service or application, controls access to resources."</em> (AWS, 2021)</p>
			<p>When you incorporate federation, then your users are going to use STS to request a session for authorization into your account. </p>
			<p>A session consists of the following:</p>
			<ul>
				<li>An access key </li>
				<li>A secret access key </li>
				<li>A security token </li>
				<li>An expiration date (for when the security token is no longer valid) </li>
			</ul>
			<p>A federated <a id="_idIndexMarker367"/>token by default will <a id="_idIndexMarker368"/>expire in 12 hours, but can be set to time out in as little as 15 minutes or as long as 36 hours. </p>
			<p>Federated tokens are handed out from the STS service via a few different request types, a couple of which are listed here:</p>
			<ul>
				<li><strong class="source-inline">GetFederatedToken</strong></li>
				<li><strong class="source-inline">AssumeRoleWithSAML</strong></li>
			</ul>
			<h2 id="_idParaDest-94"><a id="_idTextAnchor094"/>When would you use federation?</h2>
			<p>There are <a id="_idIndexMarker369"/>a few scenarios where federation makes perfect sense to use in your environment or accounts. The first would be if you have a <strong class="bold">Security Assertion Markup Language</strong> (<strong class="bold">SAML</strong>) 2.0-compatible corporate <a id="_idIndexMarker370"/>directory. Examples of this would be <strong class="bold">AD Federation Service</strong> (<strong class="bold">AD FS</strong>), Okta, Shibboleth, and many <a id="_idIndexMarker371"/>others. When your directory is SAML 2.0-compliant, then you can configure it to provide SSO access to the AWS Management Console. </p>
			<p>Even if the directory isn't SAML 2.0-compliant, you still have the ability to furnish SSO to your users. In this case, though, you will need to produce an identity broker application to provide SSO access. </p>
			<p>The second scenario in which you would likely use federation is if your users have identity management through a third party such as a web identity. In this case, the web IdP provides the authentication step, and then you can use federation <a id="_idIndexMarker372"/>to grant your users AWS access to the services they need. We will discuss this more when we talk about the use of the AWS Cognito service later in the chapter. </p>
			<h2 id="_idParaDest-95"><a id="_idTextAnchor095"/>Using AD federation with IAM</h2>
			<p>When you <a id="_idIndexMarker373"/>use AD FS to provide access to your <a id="_idIndexMarker374"/>account, the flow happens in the following order:</p>
			<ol>
				<li value="1">The user (or application) requests a session from the federation proxy. </li>
				<li>The user is then authenticated via AD to ensure that they are an active user and have permissions to access the AWS cloud. </li>
				<li>Next, AD determines the quantity of permissions the user is entitled to receive.</li>
				<li>Then, the federation proxy initiates a <strong class="source-inline">GetFederationToken</strong> request from the STS service in the AWS account. </li>
				<li>The STS service then responds with the federated token (including the access key, secret key, and session token). </li>
				<li>The federation proxy then passes the token to the user. </li>
				<li>The user is then able to make API calls to the AWS account. </li>
			</ol>
			<p>Using federation to authenticate to your AWS account is especially useful if you have a large organization and don't want to manage users in both AD and AWS IAM. It can also help you get around the service limit of 500 IAM users per account. </p>
			<p>AWS offers a number of different <em class="italic">flavors</em> of AD depending on your needs, which we will look at next. </p>
			<h3>AWS Directory Service </h3>
			<p>AWS provides <a id="_idIndexMarker375"/>a multitude of different options for using AD in the cloud according to your needs. There are three levels of the AWS Directory Service offered, and each serves a different purpose. </p>
			<h3>AWS Directory Service for Microsoft AD (MS AD)</h3>
			<p>If you are looking to run a managed service Enterprise version of AD in the cloud, then the AWS AD service is an excellent option. This service can handle up to 50,000 users <a id="_idIndexMarker376"/>and up to 200,000 AD objects. It also has the ability to be implemented in a highly available fashion across multiple regions. Multi-Region replication is only supported in the Enterprise edition of AWS Managed MS AD. </p>
			<p>If you have more than 5,000 users and don't currently have an AD server or the need to manage users and/or AD objects in the AWS cloud, then AWS Directory Service is your best option. </p>
			<p>One disadvantage of using this service is if you run into performance issues, you don't have a lot of knobs and levers to pull. This is, after all, a managed service and is supposed to take administrative tasks off your plate. This is also not fitting for web federation. </p>
			<h4>AD connector </h4>
			<p>If you <a id="_idIndexMarker377"/>already have an AD server on-premises and you want a way to quickly extend this to the cloud, then an AD connector is a good option. An AD connector doesn't cache information in the cloud, but rather serves as a proxy for your on-premises AD server. This also means that you can't make any changes to the AD connector in the cloud. All changes and updates have to take place on the on-premises server.  </p>
			<h4>Simple AD </h4>
			<p>Simple AD comes in two different sizes: small and large. The small version can support <a id="_idIndexMarker378"/>up to 500 users and 2,000 objects and the large version can support up to 5,000 users and 20,000 objects. If these numbers don't support the growth rate of your organization, then you need to consider an alternative solution such as MS AD. </p>
			<p>Simple AD does support Kerberos-based SSO authentication and can be spun up using a CloudFormation script. </p>
			<p class="callout-heading">Important note </p>
			<p class="callout">Simple AD is based on Samba 4 and isn't true MS AD. It won't support TRUST with other AD systems. It also doesn't support items such as MFA, PowerShell, AWS SSO, or Amazon Chime. While it is a good option if you only have a small set of users <a id="_idIndexMarker379"/>or if you are trying to provide a <strong class="bold">fully qualified domain name</strong> (<strong class="bold">FQDN</strong>) for a small number of Windows machines in the cloud, be mindful of its limitations—especially when reading through exam questions. </p>
			<h2 id="_idParaDest-96"><a id="_idTextAnchor096"/>AWS SSO </h2>
			<p>Even with the vast offerings of AWS, there are still other services you or your customers <a id="_idIndexMarker380"/>probably want to incorporate as SaaS offerings that require authentication. Rather than making users verify themselves to each and every <strong class="bold">service provider</strong> (<strong class="bold">SP</strong>), AWS makes this simple with its own SSO service. </p>
			<p>This is even <a id="_idIndexMarker381"/>the case if you are using AD, be it on-premises or Azure-based AD. You might be using third-party authentication such as Okta or Ping Identity, and SSO can be incorporated with these services as well. </p>
			<p>Where AWS SSO really eases the burden from administrators is when you are managing multiple AWS accounts, as you can map your users and their roles quickly and easily to accounts with a single point of entry. There is no longer a need to set up a SAML token or to go through the process of showing users which account to use to switch roles. </p>
			<h2 id="_idParaDest-97"><a id="_idTextAnchor097"/>Choosing a user identity strategy </h2>
			<p>With all of these different methods to manage your users and different ways to manage <a id="_idIndexMarker382"/>their authorization, you might need some guidelines on when to use each method. </p>
			<p>If you have a small group, then that size of team is usually best served by using IAM groups. </p>
			<p>If you want to use federation to manage your user logins and you already have an AD in place, then SAML federation via AD is going to be the correct route. </p>
			<p>If you want federation and you don't yet have an AD and you want the extra features <a id="_idIndexMarker383"/>that AD provides, such as providing <strong class="bold">Domain Name System</strong> (<strong class="bold">DNS</strong>) management to Windows instances, then you can go to AWS Directory Services. </p>
			<p>However, if you want federation and don't want the hassle of setting up and managing AD or the licensing costs, then AWS SSO is going to be your best option. </p>
			<h1 id="_idParaDest-98"><a id="_idTextAnchor098"/>Storing secrets securely in AWS </h1>
			<p>Being a DevOps engineer and codifying our infrastructure and applications for deployment <a id="_idIndexMarker384"/>through deployment pipelines doesn't take out the necessity of credentialing items such as usernames <a id="_idIndexMarker385"/>and passwords or third-party API authentication from our application. It does, however, present a need to authenticate on a much more secure and repeatable basis so that development and testing aren't hindered, along with only sharing access only with those who absolutely need to know. Not every developer who is working on a system needs a username and password to the database if they are all using the same application. You can also limit the management overhead of having to change the credentials every time there is a personal change if you, instead of passing the credentials out to every developer, have the developer request the credentials <a id="_idIndexMarker386"/>from a secrets <a id="_idIndexMarker387"/>manager. Although there are third-party solutions that perform this task, AWS does provide two different native services that allow for secrets management, and even secrets rotation. </p>
			<h2 id="_idParaDest-99"><a id="_idTextAnchor099"/>AWS Secrets Manager </h2>
			<p>You can use Secrets Manager to store, rotate, monitor, and control access to secrets such <a id="_idIndexMarker388"/>as database credentials, API keys, and <strong class="bold">Open Authorization</strong> (<strong class="bold">OAuth</strong>) tokens. One of the main features of Secrets Manager is that it allows for automatic rotation of secrets using AWS Lambda functions. </p>
			<p>There is no <a id="_idIndexMarker389"/>longer a need to place hardcoded secrets in your IaC or application code, or even to download to your instances at startup and have them stored in an unencrypted vulnerable state. You can now retrieve secrets when you need them simply and securely, with a call to Secrets Manager. </p>
			<p>Access to Secrets Manager is also governed by IAM policies. Users or roles must have been granted access to either the Secrets Manager service as a whole or the specific instance of Secrets Manager in order to perform operations such as storing and retrieving secrets. </p>
			<p>Another feature of Secrets Manager is that every time a secret is accessed, an audit trail is left. This is a valuable feature in highly compliant industries. </p>
			<p>You might be wondering: <em class="italic">Just what is a secret?</em> Well, in the context of Secrets Manager, a secret is typically a set of credentials (username and password) and the connection details that you use to access a secured device. </p>
			<h3>The basic structure of a secret in Secrets Manager </h3>
			<p>In Secrets Manager, a secret contains encrypted secret text and several metadata <a id="_idIndexMarker390"/>elements that express the secret and define how Secrets Manager should deal with the secret, as illus<a id="_idTextAnchor100"/>trated in the following diagram: </p>
			<div>
				<div id="_idContainer039" class="IMG---Figure">
					<img src="Images/Figure_3.13_B17405.jpg" alt="Figure 3.13 – Anatomy of a secret in Secrets Manager &#13;&#10;" width="1086" height="415"/>
				</div>
			</div>
			<p class="figure-caption">Figure 3.13 – Anatomy of a secret in Secrets Manager </p>
			<p>Now that we have seen how Secrets Manager stores and versions the secrets that we place into it for safekeeping, let's go through an exercise of creating and storing a secret using AWS Secrets Manager. </p>
			<h3>Creating and storing a secret in AWS Secrets Manager </h3>
			<p>In the <a id="_idIndexMarker391"/>following exercise, we are going to <a id="_idIndexMarker392"/>store a secret securely using the AWS Management Console and AWS Secrets Manager. Proceed as follows:</p>
			<ol>
				<li value="1">Open up your browser and go back to the Amazon web console. You may have to log in if your session has expired. In the search bar at the top, type <strong class="source-inline">Secrets Manager</strong> to have the <strong class="bold">Secrets Manager</strong> icon appear. Click on the icon to go to the main <strong class="bold">AWS Secrets Manager</strong> page, as illustrated in the following screenshot: <div id="_idContainer040" class="IMG---Figure"><img src="Images/Figure_3.14_B17405.jpg" alt="Figure 3.14 – The main Secrets Manager page &#13;&#10;" width="776" height="494"/></div><p class="figure-caption">Figure 3.14 – The main Secrets Manager page </p></li>
				<li>On either <a id="_idIndexMarker393"/>the main <strong class="source-inline">Secrets Manager</strong> page <a id="_idIndexMarker394"/>or the <strong class="bold">secrets list</strong> page, once you have entered into the <strong class="bold">Secrets Manager</strong> section of the console, click <strong class="bold">Store a new secret</strong>.</li>
				<li>On the <strong class="bold">Store a new secret</strong> page, choose <strong class="bold">Other type of secrets</strong>, as illustrated in the following screenshot:<div id="_idContainer041" class="IMG---Figure"><img src="Images/Figure_3.15_B17405.jpg" alt="Figure 3.15 – Choosing the secret type on the Store a new secret page&#13;&#10;" width="460" height="134"/></div><p class="figure-caption">Figure 3.15 – Choosing the secret type on the Store a new secret page</p></li>
				<li>Under <strong class="bold">Specify the key/value pairs to be stored in this secret</strong>, choose <strong class="bold">Secret key/value</strong> so that you can type in the secret as key-value pairs, as illustrated in the following screenshot:<div id="_idContainer042" class="IMG---Figure"><img src="Images/Figure_3.16_B17405.jpg" alt="Figure 3.16 – Adding the key pair and values to your secret in Secrets Manager &#13;&#10;" width="404" height="203"/></div><p class="figure-caption">Figure 3.16 – Adding the key pair and values to your secret in Secrets Manager </p></li>
				<li>For <strong class="bold">Select the encryption key</strong>, choose <strong class="source-inline">DefaultEncryptionKey</strong>, as illustrated <a id="_idIndexMarker395"/>in the following screenshot:<div id="_idContainer043" class="IMG---Figure"><img src="Images/Figure_3.17_B17405.jpg" alt="Figure 3.17 – Secrets Manager encryption&#13;&#10;" width="1224" height="190"/></div><p class="figure-caption">Figure 3.17 – Secrets Manager encryption</p></li>
				<li>In the <a id="_idIndexMarker396"/>first box, type <strong class="source-inline">username</strong>. In the second box, type <strong class="source-inline">devopspro</strong>.</li>
				<li>Choose <strong class="bold">+ Add row</strong> to add a second key-value pair. </li>
				<li>In the first box, type <strong class="source-inline">password</strong>. In the second box, type <strong class="source-inline">MyTopSecretP@ssword#</strong>.<p>Once we have typed in the values for our secret, we can view it in a JSON context before moving on to ensure it is correct.</p></li>
				<li>Choose <strong class="bold">Plaintext</strong> above the boxes to see the JSON version of the secret text that will be stored in the <strong class="source-inline">SecretString</strong> field of the secret. </li>
				<li>For <strong class="bold">Select the encryption key</strong>, leave it set at the default value <strong class="source-inline">DefaultEncryptionKey</strong> and click <strong class="bold">Next</strong>.</li>
				<li>Under <strong class="bold">Secret name and description</strong>, for <strong class="bold">Secret name</strong>, type <strong class="source-inline">chapter3/SecretManager</strong>. This stores your secret in a virtual <strong class="source-inline">chapter3</strong> folder.</li>
				<li>For <strong class="bold">Description</strong>, type something such as <strong class="source-inline">Secret Manager Tutorial</strong> and click <strong class="bold">Next</strong>.</li>
				<li>We don't <a id="_idIndexMarker397"/>need to rotate this secret, so choose <strong class="bold">Disable automatic rotation</strong>, and then click <strong class="bold">Next</strong>.</li>
				<li>On the <strong class="bold">Review</strong> page, you can check all of the settings that you have chosen. If you <a id="_idIndexMarker398"/>are using the secret within an application, be sure to review the <strong class="bold">Sample code</strong> section that has cut-and-paste-enabled code that you can put into your own applications to use this secret to retrieve the credentials. Each tab has the same code in different programming languages. </li>
				<li>To save your changes, choose <strong class="bold">Store</strong>.</li>
			</ol>
			<h3>Retrieving your secret from Secrets Manager </h3>
			<p>Now that <a id="_idIndexMarker399"/>we know how to use the AWS Management Console to save a secret, we will use the AWS CLI to retrieve the secret and see that it has been stored successfully. Proceed as follows:</p>
			<ol>
				<li value="1">Open up your terminal if you closed it previously, and type the following command so that we can retrieve the secret:<p class="source-code"><strong class="bold">$aws secretsmanager list-secrets</strong></p><p>After executing the preceding command, there should be a return somewhat like this:</p><p class="source-code"><strong class="bold">{</strong></p><p class="source-code"><strong class="bold">    "SecretList": [</strong></p><p class="source-code"><strong class="bold">        {</strong></p><p class="source-code"><strong class="bold">            "ARN": "arn:aws:secretsmanager:us-east-2:470066103307:secret:chapter3/SecretManager-qBEqSh",</strong></p><p class="source-code"><strong class="bold">            "Name": "chapter3/SecretManager",</strong></p><p class="source-code"><strong class="bold">            "Description": "Secret Manager Tutorial",</strong></p><p class="source-code"><strong class="bold">            "LastChangedDate": "2021-03-15T21:55:53.828000-04:00",</strong></p><p class="source-code"><strong class="bold">            "Tags": [],</strong></p><p class="source-code"><strong class="bold">            "SecretVersionsToStages": {</strong></p><p class="source-code"><strong class="bold">                "83e08e0f-00d6-46d2-b05a-223041403f19": [</strong></p><p class="source-code"><strong class="bold">                    "AWSCURRENT"</strong></p><p class="source-code"><strong class="bold">                ]</strong></p><p class="source-code"><strong class="bold">            },</strong></p><p class="source-code"><strong class="bold">            "CreatedDate": "2021-03-15T21:55:53.783000-04:00"</strong></p><p class="source-code"><strong class="bold">        }</strong></p><p class="source-code"><strong class="bold">    ]</strong></p><p class="source-code"><strong class="bold">}</strong></p></li>
				<li>Now that <a id="_idIndexMarker400"/>we can see our secret with the name <strong class="source-inline">chapter3/SecretManager</strong> stored in Secrets Manager, we can go about retrieving the secret by running the following command: <p class="source-code"><strong class="bold">$aws secretsmanager get-secret-value --secret-id chapter3/SecretManager</strong></p><p>Since we are authorized to get the value of the secret with our user, we should see the secret being returned as follows:</p><p class="source-code"><strong class="bold">{</strong></p><p class="source-code"><strong class="bold">    "ARN": "arn:aws:secretsmanager:us-east-2:470066103307:secret:chapter3/SecretManager-qBEqSh",</strong></p><p class="source-code"><strong class="bold">    "Name": "chapter3/SecretManager",</strong></p><p class="source-code"><strong class="bold">    "VersionId": "83e08e0f-00d6-46d2-b05a-223041403f19",</strong></p><p class="source-code"><strong class="bold">    "SecretString": "{\"username\":\"devopspro\",\"password\":\"MyTopSecretP@ssword!\"}",</strong></p><p class="source-code"><strong class="bold">    "VersionStages": [</strong></p><p class="source-code"><strong class="bold">        "AWSCURRENT"</strong></p><p class="source-code"><strong class="bold">    ],</strong></p><p class="source-code"><strong class="bold">    "CreatedDate": "2021-03-15T21:55:53.810000-04:00"</strong></p><p class="source-code"><strong class="bold">}</strong></p><p>You will see both the username and password returned unencrypted in the <strong class="source-inline">SecretString</strong> field for you to use. You should also notice that it has returned the current value by default. We could have also asked Secrets Manager to return us back to the previous version of the secret stored if we needed that version of the secret. </p></li>
			</ol>
			<p>We just <a id="_idIndexMarker401"/>used AWS Secrets Manager to successfully create, store, and retrieve a secret. One of the reasons why we could retrieve the secret is because our IAM role gives us the permissions to do so. Next, we will look at the other service that AWS offers for safekeeping of secrets: SSM Parameter Store. </p>
			<h2 id="_idParaDest-100"><a id="_idTextAnchor101"/>SSM Parameter Store </h2>
			<p><strong class="bold">Parameter Store</strong> is a managed <a id="_idIndexMarker402"/>service from AWS to store strings. These <a id="_idIndexMarker403"/>can be plaintext strings or, in the case of using it as a secrets manager, it can store encrypted data. Access to the parameters is governed by IAM policy access. </p>
			<p>Parameter Store is more flexible than Secrets Manager and if you store standard parameters there is no charge, but there is a limit of 10,000 parameters.</p>
			<p>Secrets and <a id="_idIndexMarker404"/>values stored in Parameter Store can be accessed from many different AWS services, including the following:</p>
			<ul>
				<li>EC2</li>
				<li><strong class="bold">Elastic Container Service</strong> (<strong class="bold">ECS</strong>)</li>
				<li>Secrets Manager </li>
				<li>AWS Lambda </li>
				<li>CloudFormation </li>
				<li>CodePipeline</li>
				<li>CodeBuild </li>
				<li>CodeDeploy </li>
			</ul>
			<p>If you or your <a id="_idIndexMarker405"/>team are looking for a central way to separate your secrets and configuration data from your code base, along with the ability to store different values for different environments, then Parameter Store could be a good option for you. </p>
			<h3>Secrets Manager versus Parameter Store </h3>
			<p>As we look at the different services that allow us to store secrets securely in AWS, we might <a id="_idIndexMarker406"/>wonder why we <a id="_idIndexMarker407"/>would choose one over the other. Let's take a quick comparison of the two services and see the main differences, as follows:</p>
			<ul>
				<li>If you are looking for an option that won't add any more to your budget, then SSM Parameter Store is the right choice for you and your organization. </li>
				<li>If you want the ability to store plaintext secrets, then SSM Parameter Store has this ability. AWS Secrets Manager cannot store values in plaintext. </li>
			</ul>
			<p>Both <a id="_idIndexMarker408"/>services are proportionately secure as both can use <strong class="bold">Key Management Service</strong> (<strong class="bold">KMS</strong>) to securely encrypt values at rest.</p>
			<p>If you want the ability to automatically rotate secrets, then AWS Secrets Manager needs to be your service choice. (With Parameter Store, you would have to rotate the secrets manually.) </p>
			<h1 id="_idParaDest-101"><a id="_idTextAnchor102"/>Using Cognito with application authentication </h1>
			<p>Cognito is a service that allows web and mobile applications to authenticate to your platform <a id="_idIndexMarker409"/>using either username <a id="_idIndexMarker410"/>and password or third-party identification social IdPs such as Amazon, Facebook, or Google. The three main functions of <strong class="bold">Amazon Cognito</strong> are user management, authentication, and synchronization. Cognito can be used to coordinate the authentication of external users to your applications via third-party IdPs. You can also federate your users with any SAML-based IdP. </p>
			<p>Some of the advantages of using Cognito include the following:</p>
			<ul>
				<li>Ease of setup, whereby you can have an authentication and authorization system that <a id="_idIndexMarker411"/>integrates into your AWS services up and running in a matter of minutes, versus the amount of time it would take you for custom programming to do the same task.</li>
				<li>You can quickly and easily integrate MFA into <strong class="bold">Amazon Cognito</strong>. </li>
				<li>Cognito metrics are easily monitored using the CloudWatch service, with no extra effort or coding.</li>
				<li>Any API calls made to the Cognito service are recorded to CloudTrail (assuming you have turned on CloudTrail for the account and region). </li>
			</ul>
			<h2 id="_idParaDest-102"><a id="_idTextAnchor103"/>Where would you use Cognito?</h2>
			<p>As you build <a id="_idIndexMarker412"/>out an application for external customers (customers that are not part of your company) and you want these customers to have the same experience no matter what type of device they are using, this is a case to use AWS Cognito. Cognito allows users to have a similar login experience whether they are <a id="_idIndexMarker413"/>using a mobile device, tablet, laptop, or <strong class="bold">virtual machine</strong> (<strong class="bold">VM</strong>). </p>
			<p>Another <a id="_idIndexMarker414"/>case for using Cognito is if you want <a id="_idIndexMarker415"/>to quickly incorporate <strong class="bold">two-factor authentication</strong> (<strong class="bold">2FA</strong>) such as email or <strong class="bold">Simple Message Service</strong> (<strong class="bold">SMS</strong>) authentication into your application. </p>
			<h2 id="_idParaDest-103"><a id="_idTextAnchor104"/>User pools</h2>
			<p>The first main <a id="_idIndexMarker416"/>component of Cognito is user pools. Essentially, user pools <a id="_idIndexMarker417"/>present sign-up and sign-in services. Understand these facts about user pools:</p>
			<ul>
				<li>They provide sign-up and sign-in services. </li>
				<li>User pools <a id="_idIndexMarker418"/>have a built-in <strong class="bold">user interface</strong> (<strong class="bold">UI</strong>) that is customizable. </li>
				<li>They allow for sign-in via social IdPs such as Amazon, Google, Facebook, and Apple, along with SAML IdPs from your user pool. </li>
				<li>They allow for security features such as MFA authentication, can check for compromised credentials, and have account takeover protection.</li>
				<li>User pools have phone and email verification.</li>
				<li>User pools allow for customized workflows along with user migration via AWS Lambda triggers.</li>
			</ul>
			<p>Once you have successfully authenticated a user with a user pool, then Cognito issues a JWT that can be used to authorize access to either your AWS credentials or your APIs, as illustrated in the following diagram:  </p>
			<div>
				<div id="_idContainer044" class="IMG---Figure">
					<img src="Images/Figure_3.18_B17405.jpg" alt="Figure 3.18 – Cognito user pool authentication&#13;&#10;" width="650" height="144"/>
				</div>
			</div>
			<p class="figure-caption">Figure 3.18 – Cognito user pool authentication</p>
			<p>With an <a id="_idIndexMarker419"/>understanding of user pools and what function they serve, we can <a id="_idIndexMarker420"/>look at the other main component of <strong class="bold">Amazon Cognito</strong>: identity pools. </p>
			<h2 id="_idParaDest-104"><a id="_idTextAnchor105"/>Identity pools </h2>
			<p>The second main component of <strong class="bold">Amazon Cognito</strong> is that of identity pools. Identity pools <a id="_idIndexMarker421"/>provide the credentials to access AWS services. With an identity pool, you can create unique identities for your users that give <a id="_idIndexMarker422"/>them temporary access credentials to AWS services.</p>
			<p>If you look at the workflow shown in <em class="italic">Figure 3.17</em>, you will see that the user initiates the login (usually from an application on their device) with the web IdP. Once authenticated with the web IdP, a <strong class="source-inline">GetId</strong> call is passed to Amazon Cognito, which then validates the request. The app will then make a <strong class="source-inline">GetCredentialsForIdentity</strong> request. Cognito will once again validate this request. At this point, Cognito will call out to the STS service and get a short-lived token for the services the app is authorized for and will then pass that back on to the application, as illustrated in the following diagram: </p>
			<div>
				<div id="_idContainer045" class="IMG---Figure">
					<img src="Images/Figure_3.19_B17405.jpg" alt="Figure 3.19 – Cognito identity pool authorization flow &#13;&#10;" width="539" height="416"/>
				</div>
			</div>
			<p class="figure-caption">Figure 3.19 – Cognito identity pool authorization flow </p>
			<p>Identity pools also allow you to define your own custom developer-authenticated <a id="_idIndexMarker423"/>identities in addition to the social IdPs supported for <a id="_idIndexMarker424"/>authentication. You can do this in the Cognito console by choosing <strong class="bold">Custom</strong>, setting your own name, and then using the sample code provided by AWS as the base for creating your new custom federated identity pool. </p>
			<p class="callout-heading">Tip to remember</p>
			<p class="callout">User pools provide the authentication, and identity pools provide the authorization.</p>
			<h1 id="_idParaDest-105"><a id="_idTextAnchor106"/>Summary</h1>
			<p>In this chapter, we learned about authentication and authorization methods in AWS. We talked about how to authorize users either with username and password or via federation using the IAM service and then authenticating them using IAM policies. <strong class="bold">AWS Organizations</strong> also showed us how we could further restrict the authorization settings using SCPs. We looked at different models of federation with services such as AD, AWS SSO, and Cognito. We also looked at how to securely store secrets as we start to work with our applications using Secrets Manager or SSM Parameter Store. </p>
			<p>In the next chapter, we will wrap up our section on AWS fundamentals with a look at the NoSQL service DynamoDB.</p>
			<h1 id="_idParaDest-106"><a id="_idTextAnchor107"/>Review questions </h1>
			<ol>
				<li value="1">In the Shared Responsibility Model presented by AWS for IaaS, who is responsible for operating system security and patching? </li>
				<li>What are the major differences between a user and a role from the choices presented here?<p>a. A role can be assumed by multiple principals; a user cannot be assumed.</p><p>b. A role uses long-term credentials. </p><p>c. A role can be part of a group. </p><p>d. A role does not use long-term credentials. </p></li>
				<li>Which comes first: authorization or authentication?</li>
				<li>Which native service in AWS that stores secrets offers automatic secret rotation?</li>
				<li>A company wants to extend their current AD into the AWS cloud but doesn't want to manage more servers. Which service is the best choice for them? <p>a. AWS Simple Directory Service </p><p>b. AWS Cognito </p><p>c. AWS User Pools </p><p>d. AWS AD Connector </p></li>
			</ol>
			<h1 id="_idParaDest-107"><a id="_idTextAnchor108"/>Review answers </h1>
			<ol>
				<li value="1">The customer is responsible for operating system patching and security. </li>
				<li>a and d.</li>
				<li>Authentication.</li>
				<li>AWS Secrets Manager.</li>
				<li>d.</li>
			</ol>
		</div>
	</div></body></html>