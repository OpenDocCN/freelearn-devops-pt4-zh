- en: In the previous chapter, you learned about ARM templates, and so far, we have
    been dealing with architectural concerns and their solutions in Azure in general.
    However, this chapter is not based on generalized architecture. In fact, it explores
    one of the most disruptive technologies of this century. This chapter will discuss
    the details of the **Internet of Things** (**IoT**) and Azure.
  id: totrans-0
  prefs: []
  type: TYPE_NORMAL
  zh: 在上一章中，你学习了ARM模板，到目前为止，我们一直在处理Azure中的架构问题及其解决方案。然而，本章并非基于通用的架构。事实上，它探讨了本世纪最具颠覆性的技术之一。本章将讨论**物联网**（**IoT**）和Azure的细节。
- en: Azure IoT refers to a collection of Microsoft-managed cloud services that can
    connect, monitor, and control billions of IoT assets. In other words, an IoT solution
    comprises one or more IoT devices that constantly communicate with one or more
    back-end servers in the cloud.
  id: totrans-1
  prefs: []
  type: TYPE_NORMAL
  zh: Azure物联网指的是一组由微软管理的云服务，这些服务可以连接、监控和控制数十亿个物联网资产。换句话说，物联网解决方案包括一个或多个物联网设备，这些设备会不断与云端的一台或多台后端服务器进行通信。
- en: 'This chapter will cover the following topics:'
  id: totrans-2
  prefs: []
  type: TYPE_NORMAL
  zh: 本章将涵盖以下主题：
- en: Azure and IoT
  id: totrans-3
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: Azure与物联网
- en: An overview of Azure IoT
  id: totrans-4
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: Azure物联网概述
- en: Device management
  id: totrans-5
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 设备管理
- en: Registering devices
  id: totrans-6
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 注册设备
- en: Device-to-IoT-hub communication
  id: totrans-7
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 设备与物联网中心的通信
- en: Scaling IoT solutions
  id: totrans-8
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 扩展物联网解决方案
- en: High availability for IoT solutions
  id: totrans-9
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: IoT解决方案的高可用性
- en: IoT protocols
  id: totrans-10
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 物联网协议
- en: Using message properties to route messages
  id: totrans-11
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 使用消息属性路由消息
- en: IoT
  id: totrans-12
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 物联网（IoT）
- en: The internet was invented in the 1980s and later became widely available. Almost
    everyone moved toward having a presence on the internet and started creating their
    own static web pages. Eventually, the static content became dynamic and could
    be generated on the fly, based on context. In nearly all cases, a browser was
    needed to access the internet. There were a plethora of browsers available, and
    without them, using the internet was a challenge.
  id: totrans-13
  prefs: []
  type: TYPE_NORMAL
  zh: 互联网是在1980年代发明的，随后逐渐变得普及。几乎每个人都开始在互联网上建立自己的存在，并开始创建自己的静态网页。最终，静态内容变得动态，可以根据上下文即时生成。在几乎所有的情况下，都需要一个浏览器才能访问互联网。当时有大量的浏览器可供选择，没有它们，使用互联网将变得困难重重。
- en: During the first decade of this century, there was an interesting development
    that was emerging—the rise of handheld devices, such as mobile phones and tablets.
    Mobile phones started becoming cheaper and were available ubiquitously. The hardware
    and software capabilities of these handheld devices were improving considerably,
    and so much so that people started using browsers on their mobile devices rather
    than on their desktops. But one particularly distinct change was the rise of mobile
    apps. These mobile apps were downloaded from a store and connected to the internet
    to talk to back-end systems. Toward the end of the last decade, there were millions
    of apps available with almost every conceivable functionality built into them.
    The back-end system for these apps was built on the cloud so that they could be
    scaled rapidly. This was the age of connecting applications and servers.
  id: totrans-14
  prefs: []
  type: TYPE_NORMAL
  zh: 在本世纪的第一个十年中，出现了一个有趣的发展——手持设备的兴起，如手机和平板电脑。手机开始变得更加便宜，并且无处不在。这些手持设备的硬件和软件能力得到了显著提高，甚至人们开始使用手机浏览器而非桌面浏览器。但一个特别明显的变化是移动应用的兴起。这些移动应用从商店下载，并通过互联网连接到后端系统。在上个十年末期，市场上涌现了数百万个应用，几乎每一种可想象的功能都被内置其中。这些应用的后端系统建立在云上，以便快速扩展。这是应用程序与服务器连接的时代。
- en: 'But was this the pinnacle of innovation? What was the next evolution of the
    internet? Well, another paradigm has now been taking center stage: IoT. Instead
    of just mobile and tablet devices connecting to the internet, why can''t other
    devices connect to the internet? Previously, such devices were available only
    in select markets; they were costly, not available to the masses, and had limited
    hardware and software capabilities. However, since the first part of this decade,
    the commercialization of these devices has been growing on a grand scale. These
    devices are becoming smaller and smaller, are more capable in terms of hardware
    and software, have more storage and compute power, can connect to the internet
    on various protocols, and can be attached to almost anything. This is the age
    of connecting devices to servers, applications, and other devices.'
  id: totrans-15
  prefs: []
  type: TYPE_NORMAL
  zh: 但这就是创新的巅峰吗？互联网的下一个发展是什么？实际上，另一个范式现在正逐步成为主流：物联网。与仅有移动设备和平板设备连接互联网不同，为什么其他设备不能连接互联网呢？过去，这类设备仅在特定市场中可用；它们昂贵，难以普及，且硬件和软件功能有限。然而，自本十年初以来，这些设备的商业化正在大规模发展。这些设备变得越来越小，硬件和软件能力更强，存储和计算能力更大，可以通过多种协议连接互联网，并且几乎可以附加到任何物体上。这是连接设备到服务器、应用程序和其他设备的时代。
- en: This has led to the formulation of the idea that IoT applications can change
    the way that industries are operating. Newer solutions that were previously unheard
    of are beginning to be realized. Now, these devices can be attached to anything;
    they can get information and send it to a back-end system that can assimilate
    information from all the devices and either take action on or report incidents.
  id: totrans-16
  prefs: []
  type: TYPE_NORMAL
  zh: 这促使了一个观点的形成，即物联网应用可以改变各行业的运作方式。以前闻所未闻的全新解决方案现在开始得以实现。现在，这些设备可以连接到任何东西；它们可以获取信息并将其发送到后端系统，后端系统能够从所有设备中整合信息，并对其采取行动或报告事件。
- en: IoT sensors and controls can be leveraged in many business use cases. For example,
    they can be used in vehicle tracking systems, which can track all the vital parameters
    of a vehicle and send those details to a centralized data store for analysis.
    Smart city initiatives can also make use of various sensors to track pollution
    levels, temperature, and street congestion. IoT has also found its way into agriculture-related
    activities, such as measuring soil fertility, humidity, and more. You can visit
    Microsoft Technical Case Studies for IoT, at [https://microsoft.github.io/techcasestudies/#technology=IoT&sortBy=featured](https://microsoft.github.io/techcasestudies/#technology=IoT&sortBy=featured),
    for real-life examples of how organizations leverage Azure IoT.
  id: totrans-17
  prefs: []
  type: TYPE_NORMAL
  zh: 物联网传感器和控制设备可以在许多商业应用场景中得到利用。例如，它们可以用于车辆追踪系统，这些系统可以追踪车辆的所有重要参数，并将这些数据发送到集中式数据存储进行分析。智能城市计划也可以利用各种传感器来追踪污染水平、温度和街道拥堵情况。物联网还在农业相关活动中找到了应用，比如测量土壤肥力、湿度等。你可以访问
    [https://microsoft.github.io/techcasestudies/#technology=IoT&sortBy=featured](https://microsoft.github.io/techcasestudies/#technology=IoT&sortBy=featured)
    了解关于组织如何利用 Azure IoT 的真实案例。
- en: Before we explore the tools and services related to IoT, we will first cover
    IoT architecture in detail.
  id: totrans-18
  prefs: []
  type: TYPE_NORMAL
  zh: 在我们探索与物联网相关的工具和服务之前，我们将首先详细介绍物联网架构。
- en: IoT architecture
  id: totrans-19
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 物联网架构
- en: Before getting into Azure and its features and services regarding IoT, it is
    important to understand the various components that are needed to create end-to-end
    IoT solutions.
  id: totrans-20
  prefs: []
  type: TYPE_NORMAL
  zh: 在深入了解与物联网相关的 Azure 及其功能和服务之前，了解构建端到端物联网解决方案所需的各种组件非常重要。
- en: Consider that IoT devices across the globe are sending millions of messages
    every second to a centralized database. Why is this data being collected? Well,
    the answer is to extract rich information about events, anomalies, and outliers
    that are to do with whatever those devices are monitoring.
  id: totrans-21
  prefs: []
  type: TYPE_NORMAL
  zh: 想象一下，全球范围内的物联网设备每秒都在向集中数据库发送数百万条消息。为什么要收集这些数据呢？答案是为了提取关于事件、异常和离群值的丰富信息，这些都与这些设备监控的内容相关。
- en: Let's understand this in more detail.
  id: totrans-22
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们更详细地理解这一点。
- en: 'IoT architecture can be divided into distinct phases, as follows:'
  id: totrans-23
  prefs: []
  type: TYPE_NORMAL
  zh: 物联网架构可以分为以下几个不同的阶段：
- en: '**Connectivity**: This phase involves a connection being made between a device
    and the IoT service.'
  id: totrans-24
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '**连接性**：此阶段涉及设备与物联网服务之间的连接。'
- en: '**Identity**: After connecting to the IoT service, the first thing that happens
    is the identification of the device and ensuring that it is allowed to send device
    telemetry to the IoT service. This is done using an authentication process.'
  id: totrans-25
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '**身份**: 连接到物联网服务后，首先进行设备的识别，并确保它被允许向物联网服务发送设备遥测数据。这通过认证过程完成。'
- en: '**Capture**: During this phase, the device telemetry is captured and received
    by the IoT service.'
  id: totrans-26
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '**捕获**: 在这个阶段，设备遥测数据被捕获并被物联网服务接收。'
- en: '**Ingestion**: In this phase, the IoT service ingests the device telemetry.'
  id: totrans-27
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '**摄入**: 在这个阶段，物联网服务摄取设备遥测数据。'
- en: '**Storage**: The device telemetry is stored. It could be a temporary or permanent
    store.'
  id: totrans-28
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '**存储**: 设备遥测数据被存储。它可以是临时存储或永久存储。'
- en: '**Transformation**: The telemetry data is transformed for further processing.
    This includes augmenting existing data and inferring data.'
  id: totrans-29
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '**转换**: 遥测数据被转换以供进一步处理。这包括增加现有数据和推断数据。'
- en: '**Analytics**: The transformed data is used to find patterns, anomalies, and
    insights.'
  id: totrans-30
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '**分析**: 转换后的数据用于发现模式、异常和洞见。'
- en: '**Presentation**: The insights are shown as dashboards and reports. Additionally,
    new alerts can be generated that could invoke automation scripts and processes.'
  id: totrans-31
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '**呈现**: 洞见以仪表板和报告的形式展示。此外，还可以生成新的警报，可能会调用自动化脚本和流程。'
- en: '*Figure 17.1* shows a generic IoT-based architecture. Data is generated or
    collected by devices and sent over to the cloud gateway. The cloud gateway, in
    turn, sends the data to multiple back-end services for processing. Cloud gateways are optional
    components; they should be used when the devices themselves are not capable of
    sending requests to back-end services, either because of resource constraints
    or the lack of a reliable network. These cloud gateways can collate data from
    multiple devices and send it to back-end services. The data can then be processed
    by back-end services and shown as insights or dashboards to users:'
  id: totrans-32
  prefs: []
  type: TYPE_NORMAL
  zh: '*图17.1*展示了一个通用的基于物联网的架构。数据由设备生成或收集，并发送到云网关。云网关将数据发送到多个后端服务进行处理。云网关是可选组件；当设备本身由于资源限制或缺乏可靠网络而无法向后端服务发送请求时，应使用它们。这些云网关可以整合多个设备的数据并将其发送到后端服务。然后，后端服务可以处理数据并向用户显示为洞察或仪表板：'
- en: '![A generic IoT application architecture showing how the data path connects
    the IP-capable devices, Existing IoT devices, Lower Power devices, the Gateway,
    and the Cloud Gateway.](img/B15432_17_01.jpg)'
  id: totrans-33
  prefs: []
  type: TYPE_IMG
  zh: '![展示一个通用的物联网应用架构，显示数据路径如何连接IP设备、现有物联网设备、低功率设备、网关和云网关。](img/B15432_17_01.jpg)'
- en: 'Figure 17.1: A generic IoT application architecture'
  id: totrans-34
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图17.1：一个通用的物联网应用架构
- en: Now that we are clear about the architecture, let's go ahead and understand
    how IoT devices communicate with other devices.
  id: totrans-35
  prefs: []
  type: TYPE_NORMAL
  zh: 现在我们清楚了架构，让我们继续了解物联网设备如何与其他设备通信。
- en: Connectivity
  id: totrans-36
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 连通性
- en: IoT devices need to communicate to connect to other devices. There are various
    connectivity types; for example, connectivity could exist between devices in a
    region, between devices and a centralized gateway, and between devices and an
    IoT platform.
  id: totrans-37
  prefs: []
  type: TYPE_NORMAL
  zh: 物联网设备需要通信以连接到其他设备。有各种各样的连接类型；例如，设备之间可以在一个区域内连接，设备与集中网关之间可以连接，设备与物联网平台之间也可以连接。
- en: In all such cases, IoT devices need connectivity capability. This capability
    could be in the form of internet connectivity, Bluetooth, infrared, or any other
    near-device communication.
  id: totrans-38
  prefs: []
  type: TYPE_NORMAL
  zh: 在所有这些情况下，物联网设备需要连接能力。这种能力可以是互联网连接、蓝牙、红外线或任何其他近设备通信形式。
- en: However, some IoT devices might not have the capability to connect to the internet.
    In these cases, they can connect to a gateway that in turn has connectivity to
    the internet.
  id: totrans-39
  prefs: []
  type: TYPE_NORMAL
  zh: 然而，一些物联网设备可能无法连接到互联网。在这些情况下，它们可以连接到一个有能力连接到互联网的网关。
- en: IoT devices use protocols to send messages. The major protocols are the **Advanced
    Message Queuing Protocol** (**AMQP**) and the **Message Queue Telemetry Transport** (**MQTT**)
    protocol.
  id: totrans-40
  prefs: []
  type: TYPE_NORMAL
  zh: 物联网设备使用协议发送消息。主要协议包括**高级消息队列协议（AMQP）**和**消息队列遥测传输协议（MQTT）**。
- en: 'Device data should be sent to an IT infrastructure. The MQTT protocol is a
    device-to-server protocol that devices can use to send telemetry data and other
    information to servers. Once the server receives a message through the MQTT protocol,
    it needs to transport the message to other servers using a reliable technology
    that is based on messages and queues. AMQP is the preferred protocol for moving
    messages between servers in an IT infrastructure in a reliable and predictable
    manner:'
  id: totrans-41
  prefs: []
  type: TYPE_NORMAL
  zh: 设备数据应发送到IT基础设施。MQTT协议是一种设备到服务器的协议，设备可以使用它将遥测数据和其他信息发送到服务器。一旦服务器通过MQTT协议接收到消息，它需要使用基于消息和队列的可靠技术将消息传输到其他服务器。AMQP是将消息可靠且可预测地传输到IT基础设施中其他服务器的首选协议：
- en: '![A block diagram showing the flow of messages between ‘Servers using the AMQP
    protocol’ and ‘Devices using the MQTT protocol’.](img/B15432_17_02.jpg)'
  id: totrans-42
  prefs: []
  type: TYPE_IMG
  zh: '![显示使用AMQP协议的“服务器”和使用MQTT协议的“设备”之间消息流动的框图。](img/B15432_17_02.jpg)'
- en: 'Figure 17.2: Workings of the MQTT and AMQP protocols'
  id: totrans-43
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图17.2：MQTT和AMQP协议的工作原理
- en: Servers receiving initial messages from IoT devices should send those messages
    to other servers for whatever processing is necessary, such as saving to logs,
    evaluation, analytics, and presentation.
  id: totrans-44
  prefs: []
  type: TYPE_NORMAL
  zh: 接收来自物联网设备初始消息的服务器应将这些消息发送到其他服务器进行必要的处理，如保存日志、评估、分析和展示。
- en: Some devices do not have the capability to connect to the internet or do not
    support protocols that are compatible with other server technologies. To enable
    these devices to work with an IoT platform and the cloud, intermediate gateways
    can be used. Gateways help in onboarding devices whose connectivity and networking
    capability is slow and not consistent; such devices may use protocols that are
    not standard, or their capabilities may be limited in terms of resources and power.
  id: totrans-45
  prefs: []
  type: TYPE_NORMAL
  zh: 一些设备无法连接到互联网，或者不支持与其他服务器技术兼容的协议。为了使这些设备能够与物联网平台和云端协同工作，可以使用中间网关。网关有助于接入那些连接性差、网络能力不稳定的设备；这些设备可能使用非标准的协议，或者它们在资源和功率方面可能有局限。
- en: In such circumstances, when devices need additional infrastructure to connect
    to back-end services, client gateways can be deployed. These gateways receive
    messages from near devices, and forward (or push) them to the IT infrastructure
    and the IoT platform for further consumption. These gateways are capable of protocol
    translation if required.
  id: totrans-46
  prefs: []
  type: TYPE_NORMAL
  zh: 在这种情况下，当设备需要额外的基础设施来连接到后端服务时，可以部署客户端网关。这些网关接收来自接近设备的消息，并将其转发（或推送）到IT基础设施和物联网平台进行进一步处理。这些网关在需要时能够进行协议转换。
- en: In this section, you learned about how communication is implemented with other
    devices and about the role that gateways play in terms of communication. In the
    next section, we're going to talk about identity.
  id: totrans-47
  prefs: []
  type: TYPE_NORMAL
  zh: 在本节中，你了解了如何与其他设备进行通信以及网关在通信中扮演的角色。在下一节中，我们将讨论身份。
- en: Identity
  id: totrans-48
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 身份
- en: IoT devices should be registered with a cloud platform. Devices that are not
    registered should not be allowed to connect to a cloud platform. The devices should
    be registered and be assigned an identity. A device should send its identity information
    when connecting to the cloud. If the device fails to send this identity information,
    the connectivity should fail. You will see, later in this chapter, how to generate
    an identity for a device using a simulated application. As you already know, IoT
    devices are deployed to capture information, and in the next section, we will
    briefly talk about the capture process.
  id: totrans-49
  prefs: []
  type: TYPE_NORMAL
  zh: 物联网设备应在云平台上注册。未注册的设备不应允许连接到云平台。设备应注册并分配一个身份。设备在连接云时应发送其身份信息。如果设备未能发送此身份信息，则连接应失败。在本章后面的内容中，你将看到如何使用模拟应用为设备生成身份。正如你已经知道的，物联网设备用于捕获信息，在下一节中，我们将简要讨论捕获过程。
- en: Capture
  id: totrans-50
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 捕获
- en: IoT devices should be able to capture information. They should have the capability,
    for example, to read or monitor the moisture content in the air or in soil. This
    information can be captured based on frequency—maybe even once per second. Once
    the information is captured, the device should be able to send it across to the
    IoT platform for processing. If a device can't connect to the IoT platform directly,
    it can connect to an intermediary cloud gateway instead and have that push the
    captured information.
  id: totrans-51
  prefs: []
  type: TYPE_NORMAL
  zh: IoT 设备应能够捕捉信息。例如，它们应该能够读取或监控空气或土壤中的水分含量。此类信息可以基于频率进行捕捉——也许甚至每秒一次。信息捕获后，设备应能够将其发送到
    IoT 平台进行处理。如果设备无法直接连接到 IoT 平台，它可以连接到中介云网关，并通过该网关将捕获的信息推送出去。
- en: The size of captured data and the frequency of capture are the most important
    things for the device. Whether a device should have local storage to be able to
    temporarily store captured data is another important aspect that should be considered.
    For instance, a device can work in offline mode if there is enough local storage
    available. Even mobile devices sometimes act as IoT devices connected to various
    instruments and have the capability to store data. Once we have captured the data,
    we need to ingest it to an IoT platform for further analysis, and in the next
    section, we will explore ingestion.
  id: totrans-52
  prefs: []
  type: TYPE_NORMAL
  zh: 捕获数据的大小和捕获频率是设备最重要的因素。设备是否应该具备本地存储，以便暂时存储捕获的数据，是另一个需要考虑的重要方面。例如，如果设备有足够的本地存储，它可以在离线模式下工作。即使是移动设备，有时也作为连接到各种仪器的
    IoT 设备，并且具备存储数据的能力。一旦我们捕获了数据，我们需要将其注入到 IoT 平台进行进一步分析，在下一节中，我们将探索注入。
- en: Ingestion
  id: totrans-53
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 注入
- en: Data captured and generated by devices should be sent to an IoT platform that
    is capable of ingesting and consuming this data to extract meaningful information
    and insights out of it. The ingestion service is a crucial service because its
    availability and scalability affect the throughput of incoming data. If data starts
    getting throttled due to scalability issues, or if data is not able to be ingested
    due to availability issues, then it will be lost and the dataset might get biased
    or skewed. We have the data captured and we need a place to store this data. In
    the next section, you'll learn about storage.
  id: totrans-54
  prefs: []
  type: TYPE_NORMAL
  zh: 设备捕获和生成的数据应当发送到能够摄取和消费这些数据的 IoT 平台，以从中提取有意义的信息和见解。注入服务是至关重要的服务，因为其可用性和可扩展性会影响传入数据的吞吐量。如果由于可扩展性问题而导致数据被限制，或由于可用性问题无法摄取数据，那么数据将会丢失，数据集可能会受到偏倚或失真。我们已经捕获了数据，需要一个地方来存储这些数据。在下一节中，你将了解存储。
- en: Storage
  id: totrans-55
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 存储
- en: IoT solutions generally deal with millions or even billions of records, spanning
    terabytes or even petabytes of data. This is valuable data that can provide insights
    on operations and their health. This data needs to be stored in such a way that
    analytics can be performed on it. Storage should be readily available for analytics,
    applications, and services to consume it. Storage solutions should provide adequate
    throughput and latency from a performance perspective, and be highly available,
    scalable, and secure. The next section deals with data transformation, which is
    needed to store and analyze data.
  id: totrans-56
  prefs: []
  type: TYPE_NORMAL
  zh: IoT 解决方案通常处理数百万甚至数十亿条记录，涉及数 TB 甚至 PB 级别的数据。这些数据是有价值的，可以提供有关运营及其健康状况的见解。必须以这样的方式存储这些数据，以便能够对其进行分析。存储应当能随时供分析、应用程序和服务使用。存储解决方案应该从性能角度提供足够的吞吐量和延迟，并且要具有高可用性、可扩展性和安全性。下一节将讨论数据转换，这是存储和分析数据所必需的。
- en: Transformation
  id: totrans-57
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 转换
- en: IoT solutions are generally data-driven and have considerably high volumes of
    data to deal with. Imagine that every car has a device and each one sends messages
    every five seconds. If there were a million cars sending messages, this would
    be equal to 288 million messages per day and 8 billion messages per month. Together,
    this data has lots of hidden information and insights; however, making sense of
    this kind of data just by looking at it is difficult.
  id: totrans-58
  prefs: []
  type: TYPE_NORMAL
  zh: IoT 解决方案通常是数据驱动的，并且需要处理大量数据。假设每辆车都有一个设备，并且每个设备每五秒钟发送一次消息。如果有一百万辆车发送消息，这相当于每天
    2.88 亿条消息，每月 80 亿条消息。所有这些数据中都隐藏着大量信息和见解；然而，仅仅通过查看这些数据来理解它是非常困难的。
- en: The data that is captured and stored by IoT devices can be consumed to solve
    business problems, but not all data that is captured is of importance. Just a
    subset of data might be needed to solve a problem. Additionally, the data that
    the IoT devices gather might not be consistent either. To ensure that the data
    is consistent and not biased or skewed, appropriate transformations should be
    executed upon it to make it ready for analysis. During transformation, data is
    filtered, sorted, removed, enriched, and transformed into a structure, such that
    the data can be consumed by components and applications further downstream. We
    need to perform some analytics with the transformed data before presenting it.
    As the next step in the workflow, we will discuss analytics.
  id: totrans-59
  prefs: []
  type: TYPE_NORMAL
  zh: 物联网设备捕获并存储的数据可以用来解决业务问题，但并非所有捕获的数据都很重要。只需要一部分数据就能解决问题。此外，物联网设备收集的数据可能也不一致。为了确保数据的一致性，并避免偏差或失真，应该对其进行适当的转换，使其准备好进行分析。在转换过程中，数据会被过滤、排序、删除、丰富并转化为结构化格式，以便下游的组件和应用能够使用。我们需要对转换后的数据进行一些分析，然后再进行呈现。作为工作流程中的下一步，我们将讨论分析。
- en: Analytics
  id: totrans-60
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 分析
- en: The data transformed in the previous step becomes the input for the analytics
    step. Depending on the problem at hand, there are different types of analytics
    that can be performed on transformed data.
  id: totrans-61
  prefs: []
  type: TYPE_NORMAL
  zh: 在前一步骤中转换的数据成为分析步骤的输入。根据手头的问题，可以对转换后的数据执行不同类型的分析。
- en: 'The following are the different types of analytics that can be performed:'
  id: totrans-62
  prefs: []
  type: TYPE_NORMAL
  zh: 以下是可以执行的不同类型的分析：
- en: '**Descriptive analytics**: This type of analytics helps in finding patterns and details
    about the status of the IoT devices and their overall health. This stage identifies
    and summarizes the data for further consumption by more advanced stages of analytics.
    It will help in summarization, finding statistics related to probability, identifying
    deviation, and other statistical tasks.'
  id: totrans-63
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**描述性分析**：这种分析有助于发现物联网设备的状态和整体健康状况的模式和细节。此阶段识别并总结数据，以供更高级的分析阶段进一步使用。它有助于数据总结、与概率相关的统计分析、偏差识别以及其他统计任务。'
- en: '**Diagnostic analytics**: This type of analytics is more advanced than descriptive
    analytics. It builds on descriptive analytics and tries to answer queries about
    why certain things have happened. That is, it tries to find the root causes of
    events. It tries to find answers using advanced concepts, such as hypothesis and
    correlation.'
  id: totrans-64
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**诊断性分析**：这种分析比描述性分析更为先进。它在描述性分析的基础上，尝试回答为什么某些事情会发生的问题。也就是说，它试图找出事件的根本原因。它使用高级概念，如假设和相关性，来寻找答案。'
- en: '**Predictive analytics**: This type of analytics tries to predict things that
    have a high probability of happening in the future. It generates predictions that
    are based on past data; regression is one of the examples that is based on past
    data. Predictive analytics could, for example, predict the price of a car, the
    behavior of stock on the stock market, when a car tire will burst, and more.'
  id: totrans-65
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**预测性分析**：这种分析尝试预测未来发生的高概率事件。它基于过去的数据生成预测；回归分析是基于过去数据的一个例子。例如，预测汽车的价格、股市中的股票行为、汽车轮胎何时会爆裂等。'
- en: '**Prescriptive analytics**: This type of analytics is the most advanced. This
    stage helps in identifying the action that should be performed to ensure that
    the health of devices and solutions does not degrade, and identifying proactive
    measures to undertake. The results of this stage of analytics can help in avoiding
    future issues and eliminating problems at their root causes.'
  id: totrans-66
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**规范性分析**：这种分析是最先进的。此阶段帮助识别应采取的行动，以确保设备和解决方案的健康状况不会恶化，并识别需要采取的预防措施。此阶段的分析结果有助于避免未来的问题并从根本上消除问题。'
- en: In the final stage, the output from analytics is presented in a human-readable
    manner for a wider audience to understand and interpret. In the next part, we
    will discuss presentation.
  id: totrans-67
  prefs: []
  type: TYPE_NORMAL
  zh: 在最后阶段，分析结果以人类可读的方式呈现，供更广泛的受众理解和解读。在接下来的部分，我们将讨论呈现。
- en: Presentation
  id: totrans-68
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 呈现
- en: Analytics help in identifying answers, patterns, and insights based on data.
    These insights also need to be available to all stakeholders in formats that they
    can understand. To this end, dashboards and reports can be generated, statistically
    or dynamically, and then be presented to stakeholders. Stakeholders can consume
    these reports for further action and improve their solutions continuously.
  id: totrans-69
  prefs: []
  type: TYPE_NORMAL
  zh: 分析有助于基于数据识别答案、模式和见解。这些见解还需要以相关方能够理解的格式呈现给所有利益相关者。为此，仪表板和报告可以以统计或动态的方式生成，并展示给利益相关者。利益相关方可以利用这些报告采取进一步行动，并不断改进他们的解决方案。
- en: As a quick recap of all the preceding steps, we started off this section by
    looking at connectivity, where we introduced gateways for sending the data from
    devices that don't support the standard protocols. Then, we talked about identity
    and how data is captured. The captured data is then ingested and stored for further
    transformation. After transformation, analytics is done on the data before it's
    presented to all stakeholders. As we are working on Azure, in the next section,
    we will cover what Azure IoT is and consider the basics concepts that we have
    learned about so far from an Azure standpoint.
  id: totrans-70
  prefs: []
  type: TYPE_NORMAL
  zh: 为了快速回顾前面的步骤，我们首先从连接性开始，介绍了用于将数据从不支持标准协议的设备发送到网关的方法。接着，我们讨论了身份验证和数据捕获。捕获的数据随后会被摄取并存储，以便进一步转换。转换后，数据将进行分析，最后呈现给所有相关方。由于我们正在使用
    Azure，在下一节中，我们将介绍什么是 Azure IoT，并从 Azure 的角度回顾我们至今所学的基本概念。
- en: Azure IoT
  id: totrans-71
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: Azure IoT
- en: 'Now you''ve learned about the various stages of end-to-end IoT solutions; each
    of these stages is crucial and their proper implementation is a must for any solution''s
    success. Azure provides lots of services for each of these stages. Apart from
    these services, Azure provides Azure IoT Hub, which is Azure''s core IoT service
    and platform. It is capable of hosting complex, highly available, and scalable
    IoT solutions. We will dive deep into IoT Hub after going through some other services:'
  id: totrans-72
  prefs: []
  type: TYPE_NORMAL
  zh: 现在，您已经了解了端到端物联网解决方案的各个阶段；每个阶段都至关重要，正确的实施对于任何解决方案的成功都是必须的。Azure 为这些阶段提供了大量服务。除了这些服务，Azure
    还提供了 Azure IoT Hub，这是 Azure 的核心物联网服务和平台。它能够托管复杂、高可用、可扩展的物联网解决方案。我们将在深入了解其他服务后，进一步探讨
    IoT Hub：
- en: '![A table listing the devices and services for IoT applications. ](img/B15432_17_03.jpg)'
  id: totrans-73
  prefs: []
  type: TYPE_IMG
  zh: '![列出用于物联网应用的设备和服务的表格](img/B15432_17_03.jpg)'
- en: 'Figure 17.3: List of devices and services for IoT solutions'
  id: totrans-74
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图 17.3：物联网解决方案的设备和服务列表
- en: In the next section, we will follow a similar pattern as we did for our coverage
    of IoT architecture to learn about communication, identity, capture, ingestion,
    storage, transformation, analytics, and presentation with Azure IoT.
  id: totrans-75
  prefs: []
  type: TYPE_NORMAL
  zh: 在下一节中，我们将遵循与之前讨论物联网架构时相似的模式，学习如何通过 Azure IoT 进行通信、身份验证、数据捕获、数据摄取、存储、转换、分析和呈现。
- en: Connectivity
  id: totrans-76
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 连接性
- en: 'IoT Hub provides all the important protocol suites for devices to connect to
    IoT hubs. It offers:'
  id: totrans-77
  prefs: []
  type: TYPE_NORMAL
  zh: IoT Hub 提供了所有重要的协议套件，使设备能够连接到 IoT 中心。它提供：
- en: '**HTTPS**: The HyperText Transport Protocol Secure method uses certificates
    consisting of a pair of keys, known as private-public keys, that are used to encrypt
    and decrypt data between a device and IoT Hub. It provides one-way communication
    from a device to the cloud.'
  id: totrans-78
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**HTTPS**：超文本传输安全协议（HTTPS）方法使用由一对密钥组成的证书，称为私钥和公钥，用于加密和解密设备与 IoT Hub 之间的数据。它提供从设备到云的一种单向通信。'
- en: '**AMQP**: AMQP is an industry standard for sending and receiving messages between
    applications. It provides a rich infrastructure for the security and reliability
    of messages, and that is one of the reasons why it is quite widely used within
    the IoT space. It provides both device-to-Hub as well as Hub-to-device capabilities,
    and devices can use it to authenticate using **Claims-Based Security** (**CBS**)
    or **Simple Authentication and Security Layer** (**SASL**). It is used primarily
    in scenarios where there are field gateways, and a single identity related to
    multiple devices can transmit telemetry data to the cloud.'
  id: totrans-79
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**AMQP**：AMQP 是一种行业标准，用于在应用程序之间发送和接收消息。它提供了丰富的基础设施来确保消息的安全性和可靠性，这也是它在物联网领域广泛使用的原因之一。它提供设备到
    IoT Hub 和 IoT Hub 到设备的双向通信能力，设备可以使用 **基于声明的安全性**（**CBS**）或 **简单身份验证和安全层**（**SASL**）进行身份验证。它主要用于存在现场网关的场景，在这些场景中，多个设备关联的单一身份可以将遥测数据传输到云端。'
- en: '**MQTT**: MQTT is an industry standard for sending and receiving messages between
    applications. It provides both device-to-Hub as well as Hub-to-device capabilities.
    It is used primarily in scenarios where each device has its own identity and authenticates
    directly with the cloud.'
  id: totrans-80
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**MQTT**：MQTT 是用于在应用程序之间发送和接收消息的行业标准。它提供设备到 Hub 以及 Hub 到设备的功能。它主要用于每个设备都有自己身份并直接与云进行身份验证的场景。'
- en: In the next section, we will discuss identity and how devices are authenticated.
  id: totrans-81
  prefs: []
  type: TYPE_NORMAL
  zh: 在下一部分，我们将讨论身份和设备如何进行身份验证。
- en: Identity
  id: totrans-82
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 身份
- en: IoT Hub provides services for authenticating devices. It offers an interface
    for generating unique identity hashes for each device. When devices send messages
    containing a hash, IoT Hub can authenticate them, after checking in its own database
    for the existence of such a hash. Now let's see how data is captured.
  id: totrans-83
  prefs: []
  type: TYPE_NORMAL
  zh: IoT Hub 提供设备身份验证服务。它提供一个接口，用于为每个设备生成唯一的身份哈希。当设备发送包含哈希的消息时，IoT Hub 可以通过检查其数据库中是否存在该哈希来进行身份验证。接下来，我们将了解数据是如何被捕获的。
- en: Capture
  id: totrans-84
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 捕获
- en: Azure provides IoT gateways, which enable devices that do not comply with IoT
    Hub to be adapted and to push data. Local or intermediary gateways can be deployed
    near devices in such a way that multiple devices can connect to a single gateway
    to capture and send their information. Similarly, multiple clusters of devices
    with local gateways can also be deployed. There can be a cloud gateway deployed
    on the cloud itself, which is capable of capturing and accepting data from multiple
    sources and ingesting it for IoT Hub. As discussed previously, we need to ingest
    the data that we capture. In the next section, you will learn about ingestion
    with IoT Hub.
  id: totrans-85
  prefs: []
  type: TYPE_NORMAL
  zh: Azure 提供 IoT 网关，使得不符合 IoT Hub 标准的设备能够适配并推送数据。可以在设备附近部署本地或中介网关，使多个设备能够连接到单一网关以捕获并发送它们的信息。同样，可以部署多个设备集群及其本地网关。还可以在云端部署云网关，能够从多个来源捕获和接收数据，并将其摄取到
    IoT Hub。正如前面讨论的那样，我们需要摄取我们捕获的数据。在下一部分，你将学习如何使用 IoT Hub 进行数据摄取。
- en: Ingestion
  id: totrans-86
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 摄取
- en: An IoT hub can be a single point of contact for devices and other applications.
    In other words, the ingestion of IoT messages is the responsibility of the IoT
    Hub service. There are other services, such as Event Hubs and the Service Bus
    messaging infrastructure, that can ingest incoming messages; however, the benefits
    and advantages of using IoT Hub to ingest IoT data far outweigh those of using
    Event Hubs and Service Bus messaging. In fact, IoT Hub was made specifically for
    the purpose of ingesting IoT messages within the Azure ecosystem so that other
    services and components can act on them. The ingested data is stored to storage.
    Before we do any kind of transformation or analytics, let's explore the role of
    storage in the workflow in the next section.
  id: totrans-87
  prefs: []
  type: TYPE_NORMAL
  zh: IoT 中心可以作为设备和其他应用程序的单一接入点。换句话说，IoT 消息的摄取是 IoT Hub 服务的责任。还有其他服务，例如事件中心和服务总线消息传递基础设施，也可以摄取传入的消息；然而，使用
    IoT Hub 来摄取 IoT 数据的好处远大于使用事件中心和服务总线消息传递的好处。事实上，IoT Hub 的设计就是为了在 Azure 生态系统内摄取
    IoT 消息，以便其他服务和组件可以对其进行处理。摄取的数据被存储到存储中。在进行任何形式的转换或分析之前，我们将在下一部分探讨存储在工作流中的作用。
- en: Storage
  id: totrans-88
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 存储
- en: 'Azure provides multiple ways of storing messages from IoT devices. These include
    storing relational data, schema-less NoSQL data, and blobs:'
  id: totrans-89
  prefs: []
  type: TYPE_NORMAL
  zh: Azure 提供多种存储 IoT 设备消息的方式。这些方式包括存储关系数据、无模式的 NoSQL 数据和 Blob：
- en: '**SQL Database**: SQL Database provides storage for relational data, JSON,
    and XML documents. It provides a rich SQL-query language and it uses a full-blown
    SQL server as a service. Data from devices can be stored in SQL databases if it
    is well defined and the schema will not need to undergo changes frequently.'
  id: totrans-90
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**SQL 数据库**：SQL 数据库提供关系型数据、JSON 和 XML 文档的存储。它提供丰富的 SQL 查询语言，并且使用完整的 SQL 服务器作为服务。如果设备数据定义明确且模式不需要频繁更改，它可以存储在
    SQL 数据库中。'
- en: '**Azure Storage**: Azure Storage provides Table and Blob storage. Table storage
    helps in storing data as entities, where the schema is not important. Blobs help
    in storing files in containers as blobs.'
  id: totrans-91
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**Azure 存储**：Azure 存储提供表格存储和 Blob 存储。表格存储帮助以实体的形式存储数据，其中模式不重要。Blob 存储帮助将文件以
    Blob 的形式存储在容器中。'
- en: '**Cosmos DB**: Cosmos DB is a full-blown enterprise-scale NoSQL database. It
    is available as a service that is capable of storing schema-less data. It is a
    globally distributed database that can span continents, providing high availability
    and scalability of data.'
  id: totrans-92
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**Cosmos DB**：Cosmos DB 是一个完整的企业级 NoSQL 数据库。它作为一项服务提供，能够存储无模式的数据。它是一个全球分布式数据库，可以跨洲提供数据的高可用性和可扩展性。'
- en: '**External data sources**: Apart from Azure services, customers can bring or
    use their own data stores, such as a SQL server on Azure virtual machines, and
    can use them to store data in a relational format.'
  id: totrans-93
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**外部数据源**：除了 Azure 服务外，客户还可以使用自己的数据存储，如在 Azure 虚拟机上的 SQL 服务器，并将其用于以关系格式存储数据。'
- en: The next section is on transformation and analytics.
  id: totrans-94
  prefs: []
  type: TYPE_NORMAL
  zh: 下一部分将讲解转换与分析。
- en: Transformation and analytics
  id: totrans-95
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 转换与分析
- en: 'Azure provides multiple resources to execute jobs and activities on ingested
    data. Some of them are listed here:'
  id: totrans-96
  prefs: []
  type: TYPE_NORMAL
  zh: Azure 提供多个资源来执行对输入数据的作业和活动。以下是其中的一些：
- en: '**Data Factory**: Azure Data Factory is a cloud-based data integration service
    that allows us to create data-driven workflows in the cloud for orchestrating
    and automating data movement and data transformation. Azure Data Factory helps
    to create and schedule data-driven workflows (called pipelines) that can ingest
    data from disparate data stores; process and transform data by using compute services
    such as **Azure HDInsight**, **Hadoop, Spark**, **Azure Data Lake Analytics**,
    **Azure Synapse Analytics**, and **Azure Machine Learning**; and publish output
    data to a data warehouse for **Business Intelligence** (**BI**) applications rather
    than a traditional **Extract-Transform-Load** (**ETL**) platform.'
  id: totrans-97
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**数据工厂**：Azure 数据工厂是一个基于云的数据集成服务，允许我们在云中创建基于数据的工作流，用于协调和自动化数据移动和数据转换。Azure
    数据工厂帮助创建和安排基于数据的工作流（称为管道），这些工作流可以从不同的数据存储中提取数据；通过使用计算服务（如 **Azure HDInsight**、**Hadoop、Spark**、**Azure
    数据湖分析**、**Azure Synapse Analytics** 和 **Azure 机器学习**）处理和转换数据；并将输出数据发布到数据仓库，用于
    **商业智能** (**BI**) 应用，而不是传统的 **提取-转换-加载** (**ETL**) 平台。'
- en: '**Azure Databricks**: Databricks provides a complete, managed, end-to-end Spark
    environment. It can help in the transformation of data using Scala and Python.
    It also provides a SQL library to manipulate data using traditional SQL syntax.
    It is more performant than Hadoop environments.'
  id: totrans-98
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**Azure Databricks**：Databricks 提供一个完整的、托管的端到端 Spark 环境。它可以通过 Scala 和 Python
    帮助进行数据转换。它还提供了一个 SQL 库，使用传统的 SQL 语法来操作数据。它比 Hadoop 环境更具性能。'
- en: '**Azure HDInsight**: Microsoft and Hortonworks have come together to help companies
    by offering a big data analytics platform with Azure. HDInsight is a high-powered,
    fully managed cloud service environment powered by Apache Hadoop and Apache Spark
    using Microsoft Azure HDInsight. It helps in accelerating workloads seamlessly
    using Microsoft and Hortonworks'' industry-leading big data cloud service.'
  id: totrans-99
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**Azure HDInsight**：微软和 Hortonworks 联手为公司提供一个大数据分析平台与 Azure 结合使用。HDInsight
    是一个由 Apache Hadoop 和 Apache Spark 提供支持的强大、完全托管的云服务环境，利用 Microsoft Azure HDInsight。它帮助通过
    Microsoft 和 Hortonworks 的行业领先的大数据云服务无缝加速工作负载。'
- en: '**Azure Stream Analytics**: This is a fully managed, real-time, data analytics
    service that helps in performing computation and transformation on streaming data.
    Stream Analytics can examine high volumes of data flowing from devices or processes,
    extract information from the data stream, and look for patterns, trends, and relationships.'
  id: totrans-100
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**Azure Stream Analytics**：这是一个完全托管的实时数据分析服务，帮助对流数据进行计算和转换。Stream Analytics
    可以检查来自设备或流程的海量数据，提取数据流中的信息，并寻找模式、趋势和关系。'
- en: '**Machine Learning**: Machine learning is a data science technique that allows
    computers to use existing data to forecast future behaviors, outcomes, and trends.
    Using machine learning, computers learn behaviors based on the model we create.
    Azure Machine Learning is a cloud-based predictive analytics service that makes
    it possible to quickly create and deploy predictive models as analytics solutions.
    It provides a ready-to-use library of algorithms to create models on an internet-connected
    PC and deploy predictive solutions quickly.'
  id: totrans-101
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**机器学习**：机器学习是一种数据科学技术，允许计算机使用现有数据预测未来的行为、结果和趋势。通过机器学习，计算机根据我们创建的模型学习行为。Azure
    机器学习是一个基于云的预测分析服务，使得快速创建和部署预测模型成为可能。它提供了一个现成的算法库，可以在连接互联网的 PC 上创建模型并快速部署预测解决方案。'
- en: '**Azure Synapse Analytics**: Formerly known as Azure Data Warehouse. Azure
    Synapse Analytics provides analytics services that are ideal for enterprise data
    warehousing and big data analytics. It supports direct streaming ingestion, which
    can be integrated with Azure IoT Hub.'
  id: totrans-102
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**Azure Synapse Analytics**：前身为 Azure 数据仓库。Azure Synapse Analytics 提供适用于企业数据仓库和大数据分析的分析服务。它支持直接流式数据摄取，并可以与
    Azure IoT Hub 集成。'
- en: Now that you are familiar with the transformation and analytics tools used in
    Azure for the data ingested by IoT devices, let's go ahead and learn about how
    this data can be presented.
  id: totrans-103
  prefs: []
  type: TYPE_NORMAL
  zh: 现在，您已经熟悉了 Azure 中用于处理 IoT 设备摄取数据的转换和分析工具，接下来我们来学习如何呈现这些数据。
- en: Presentation
  id: totrans-104
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 演示
- en: After appropriate analytics have been conducted on data, the data should be
    presented to stakeholders in a format that is consumable by them. There are numerous
    ways in which insights from data can be presented. These include presenting data
    through web applications that are deployed using Azure App Service, sending data
    to notification hubs that can then notify mobile applications, and more. However,
    the ideal approach for presenting and consuming insights is using **Power BI** reports
    and dashboards. Power BI is a Microsoft visualization tool that is used to render
    dynamic reports and dashboards on the internet.
  id: totrans-105
  prefs: []
  type: TYPE_NORMAL
  zh: 在对数据进行适当分析后，数据应该以可供利益相关者消费的格式呈现。有多种方式可以呈现数据洞察，包括通过使用 Azure App Service 部署的 Web
    应用程序呈现数据，向通知中心发送数据，然后通知移动应用程序等。然而，展示和消费洞察的理想方法是使用 **Power BI** 报告和仪表板。Power BI
    是微软的可视化工具，用于在互联网上呈现动态报告和仪表板。
- en: To conclude, Azure IoT is closely aligned with the basic concepts of IoT architecture.
    It follows the same process; however, Azure gives us the freedom to choose different
    services and dependencies based on our requirements. In the next section, we will
    focus on Azure IoT Hub, a service hosted in the cloud and completely managed by
    Azure.
  id: totrans-106
  prefs: []
  type: TYPE_NORMAL
  zh: 总结来说，Azure IoT 与物联网架构的基本概念紧密契合。它遵循相同的流程；然而，Azure 赋予我们根据需求选择不同服务和依赖项的自由。在下一节中，我们将重点介绍
    Azure IoT Hub，这是一个托管在云中的服务，由 Azure 完全管理。
- en: Azure IoT Hub
  id: totrans-107
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: Azure IoT Hub
- en: IoT projects are generally complex in nature. The complexity arises because
    of the high volume of devices and data. Devices are embedded across the world,
    for example, monitoring and auditing devices that are used to store data, transform
    and analyze petabytes of data, and finally take actions based on insights. Moreover,
    these projects have long gestation periods, and their requirements keep changing
    because of timelines.
  id: totrans-108
  prefs: []
  type: TYPE_NORMAL
  zh: 物联网项目通常具有较高的复杂性。这种复杂性源于设备和数据的庞大数量。设备遍布全球，例如用于存储数据的监控和审计设备，处理和分析 PB 级数据，并最终根据洞察采取行动。此外，这些项目通常周期长，其需求因时间表的变化而不断变化。
- en: If an enterprise wants to embark on a journey with an IoT project sooner rather
    than later, then it will quickly realize that the problems we have mentioned are
    not easily solved. These projects require enough hardware in terms of computing
    and storage to cope, and services that can work with high volumes of data.
  id: totrans-109
  prefs: []
  type: TYPE_NORMAL
  zh: 如果企业希望尽早开始物联网项目，它将很快意识到我们提到的问题并非易于解决。这些项目需要足够的计算和存储硬件来应对，并且需要能够处理大量数据的服务。
- en: 'IoT Hub is a platform that is built to enable the faster, better, and easier
    delivery of IoT projects. It provides all the necessary features and services,
    including the following:'
  id: totrans-110
  prefs: []
  type: TYPE_NORMAL
  zh: IoT Hub 是一个旨在实现更快速、更优质、更简便的物联网项目交付的平台。它提供了所有必要的功能和服务，包括以下内容：
- en: Device registration
  id: totrans-111
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 设备注册
- en: Device connectivity
  id: totrans-112
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 设备连接
- en: Field gateways
  id: totrans-113
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 现场网关
- en: Cloud gateways
  id: totrans-114
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 云网关
- en: Implementation of industry protocols, such as AMQP and the MQTT protocol
  id: totrans-115
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 实现行业协议，如 AMQP 和 MQTT 协议
- en: A hub for storing incoming messages
  id: totrans-116
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 存储传入消息的中心
- en: The routing of messages based on message properties and content
  id: totrans-117
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 基于消息属性和内容的消息路由
- en: Multiple endpoints for different types of processing
  id: totrans-118
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 用于不同类型处理的多个端点
- en: Connectivity to other services on Azure for real-time analytics and more
  id: totrans-119
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 与 Azure 上其他服务的连接，用于实时分析等
- en: We have covered an overview of Azure IoT Hub, so let's take a deep dive to understand
    more about the protocols and how the devices are registered with Azure IoT Hub.
  id: totrans-120
  prefs: []
  type: TYPE_NORMAL
  zh: 我们已经概述了 Azure IoT Hub，现在让我们深入了解协议以及设备如何在 Azure IoT Hub 中注册。
- en: Protocols
  id: totrans-121
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 协议
- en: Azure IoT Hub natively supports communication over the MQTT, AMQP, and HTTP
    protocols. In some cases, devices or field gateways might not be able to use one
    of these standard protocols and will require protocol adaptation. In such cases,
    custom gateways can be deployed. The Azure IoT protocol gateway can enable protocol
    adaptation for IoT Hub endpoints by bridging the traffic to and from IoT Hub.
    In the next section, we will discuss how devices are registered with Azure IoT
    Hub.
  id: totrans-122
  prefs: []
  type: TYPE_NORMAL
  zh: Azure IoT Hub 原生支持通过 MQTT、AMQP 和 HTTP 协议进行通信。在某些情况下，设备或现场网关可能无法使用这些标准协议之一，并需要协议适配。在这种情况下，可以部署自定义网关。Azure
    IoT 协议网关可以通过桥接流量到 IoT Hub，启用 IoT Hub 端点的协议适配。下一部分将讨论设备如何注册到 Azure IoT Hub。
- en: Device registration
  id: totrans-123
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 设备注册
- en: Devices should be registered before they can send messages to IoT Hub. The registration
    of devices can be done manually using the Azure portal or it can be automated
    using the IoT Hub SDK. Azure also provides sample simulation applications, through
    which it becomes easy to register virtual devices for development and testing
    purposes. There is also a Raspberry Pi online simulator that can be used as a
    virtual device, and then, obviously, there are other physical devices that can
    be configured to connect to IoT Hub.
  id: totrans-124
  prefs: []
  type: TYPE_NORMAL
  zh: 设备在向 IoT Hub 发送消息之前需要进行注册。设备注册可以通过 Azure 门户手动完成，也可以通过 IoT Hub SDK 自动完成。Azure
    还提供了示例模拟应用程序，通过这些应用程序，可以轻松地为开发和测试目的注册虚拟设备。此外，还有一个可以作为虚拟设备使用的树莓派在线模拟器，当然，其他可以连接到
    IoT Hub 的物理设备也可以进行配置。
- en: If you want to simulate a device from a local PC that is generally used for
    development and testing purposes, then there are tutorials available in the Azure
    documentation in multiple languages. These are available at [https://docs.microsoft.com/azure/iot-hub/iot-hub-get-started-simulated](https://docs.microsoft.com/azure/iot-hub/iot-hub-get-started-simulated).
  id: totrans-125
  prefs: []
  type: TYPE_NORMAL
  zh: 如果你想模拟一个通常用于开发和测试目的的本地 PC 设备，可以在 Azure 文档中找到多种语言的教程。这些教程可在[https://docs.microsoft.com/azure/iot-hub/iot-hub-get-started-simulated](https://docs.microsoft.com/azure/iot-hub/iot-hub-get-started-simulated)访问。
- en: The Raspberry Pi online simulator is available at [https://docs.microsoft.com/azure/iot-hub/iot-hub-raspberry-pi-web-simulator-get-started](https://docs.microsoft.com/azure/iot-hub/iot-hub-raspberry-pi-web-simulator-get-started),
    and for physical devices that need to be registered with IoT Hub, the steps given
    at [https://docs.microsoft.com/azure/iot-hub/iot-hub-get-started-physical](https://docs.microsoft.com/azure/iot-hub/iot-hub-get-started-physical)
    should be used.
  id: totrans-126
  prefs: []
  type: TYPE_NORMAL
  zh: 树莓派在线模拟器可在[https://docs.microsoft.com/azure/iot-hub/iot-hub-raspberry-pi-web-simulator-get-started](https://docs.microsoft.com/azure/iot-hub/iot-hub-raspberry-pi-web-simulator-get-started)访问，对于需要在
    IoT Hub 注册的物理设备，应使用[https://docs.microsoft.com/azure/iot-hub/iot-hub-get-started-physical](https://docs.microsoft.com/azure/iot-hub/iot-hub-get-started-physical)中给出的步骤。
- en: 'To manually add a device using the Azure portal, IoT Hub provides the **IoT
    devices** menu, which can be used to configure a new device. Selecting the **New**
    option will let you create a new device as shown in *Figure 17.4*:'
  id: totrans-127
  prefs: []
  type: TYPE_NORMAL
  zh: 要通过 Azure 门户手动添加设备，IoT Hub 提供了**IoT 设备**菜单，可以用来配置新设备。选择**新建**选项将允许你创建一个新设备，如*图
    17.4*所示：
- en: '![Moving to the IoT devices blade from the left-hand navigation and then, adding
    the device details in the Create a device pane.](img/B15432_17_04.jpg)'
  id: totrans-128
  prefs: []
  type: TYPE_IMG
  zh: '![从左侧导航栏移动到 IoT 设备窗格，然后在“创建设备”面板中添加设备详细信息。](img/B15432_17_04.jpg)'
- en: 'Figure 17.4: Adding a device via the Azure portal'
  id: totrans-129
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图 17.4：通过 Azure 门户添加设备
- en: 'After the device identity is created, a primary key connection string for IoT
    Hub should be used in each device to connect to it:'
  id: totrans-130
  prefs: []
  type: TYPE_NORMAL
  zh: 创建设备身份后，应使用 IoT Hub 的主密钥连接字符串将每个设备连接到 IoT Hub：
- en: '![Adding the connection strings to the device created in the previous stepand
    providing details such as Device ID, Primary key, Secondary key, and so on.](img/B15432_17_05.jpg)'
  id: totrans-131
  prefs: []
  type: TYPE_IMG
  zh: '![将连接字符串添加到在前一步中创建的设备，并提供设备 ID、主密钥、次密钥等详细信息。](img/B15432_17_05.jpg)'
- en: 'Figure 17.5: Creating connecting strings for each device'
  id: totrans-132
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图 17.5：为每个设备创建连接字符串
- en: At this stage, the device has been registered with IoT Hub, and our next mission
    is to make communication happen between the device and IoT Hub. The next section
    will give you a good understanding of how message management is done.
  id: totrans-133
  prefs: []
  type: TYPE_NORMAL
  zh: 在此阶段，设备已成功注册到 IoT Hub，我们的下一个任务是实现设备与 IoT Hub 之间的通信。下一部分将详细介绍如何进行消息管理。
- en: Message management
  id: totrans-134
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 消息管理
- en: After devices are registered with IoT Hub, they can start interacting with it.
    Message management refers to how the communication or interaction between the
    IoT device and IoT Hub is done. This interaction could be from the device to the
    cloud, or from the cloud to the device.
  id: totrans-135
  prefs: []
  type: TYPE_NORMAL
  zh: 设备注册到 IoT Hub 后，就可以开始与其进行交互。消息管理指的是 IoT 设备与 IoT Hub 之间如何进行通信或交互。这种交互可以是设备向云端发送数据，也可以是云端向设备发送数据。
- en: '**Device-to-cloud messaging**'
  id: totrans-136
  prefs: []
  type: TYPE_NORMAL
  zh: '**设备到云端消息传递**'
- en: One of the best practices that must be followed in this communication is that
    although the device might be capturing a lot of information, only data that is
    of any importance should be transmitted to the cloud. The size of the message
    is very important in IoT solutions since IoT solutions generally have very high
    volumes of data. Even 1 KB of extra data flowing in can result in a GB of storage
    and processing wasted. Each message has properties and payloads; properties define
    the metadata for the message. This metadata contains data about the device, identification,
    tags, and other properties that are helpful in routing and identifying messages.
  id: totrans-137
  prefs: []
  type: TYPE_NORMAL
  zh: 在这种通信中必须遵循的最佳实践之一是，尽管设备可能会捕获大量信息，但只有那些重要的数据应传输到云端。消息的大小在物联网解决方案中非常重要，因为物联网解决方案通常有非常大的数据量。即使是多出的
    1 KB 数据流动，也可能导致浪费 GB 级的存储和处理能力。每条消息都有属性和有效负载；属性定义了消息的元数据。此元数据包含关于设备、标识、标签以及其他有助于路由和识别消息的属性的数据。
- en: 'Devices or cloud gateways should connect to IoT Hub to transfer data. IoT Hub
    provides public endpoints that can be utilized by devices to connect and send
    data. IoT Hub should be considered as the first point of contact for back-end
    processing. IoT Hub is capable of further transmission and routing of these messages
    to multiple services. By default, the messages are stored in event hubs. Multiple
    event hubs can be created for different kinds of messages. The built-in endpoints
    used by the devices to send and receive data can be seen in the **Built-in endpoints**
    blade in IoT Hub. *Figure 17.6* shows how you can find the built-in endpoints:'
  id: totrans-138
  prefs: []
  type: TYPE_NORMAL
  zh: 设备或云网关应连接到 IoT Hub 以传输数据。IoT Hub 提供可以供设备使用的公共端点，设备可以连接并发送数据。IoT Hub 应作为后端处理的第一个接触点。IoT
    Hub 能够将这些消息进一步传输并路由到多个服务。默认情况下，消息存储在事件中心中。可以为不同类型的消息创建多个事件中心。设备用来发送和接收数据的内置端点可以在
    IoT Hub 中的**内置端点**选项卡中查看。*图 17.6* 展示了如何找到内置端点：
- en: '![Choosing the Built-in endpoints blade from the left-hand navigationin the
    IoT Hub and checking the Built-in Endpoints.](img/B15432_17_06.jpg)'
  id: totrans-139
  prefs: []
  type: TYPE_IMG
  zh: '![从 IoT Hub 左侧导航栏中选择内置端点选项卡，并检查内置端点。](img/B15432_17_06.jpg)'
- en: 'Figure 17.6: Creating multiple event hubs'
  id: totrans-140
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图 17.6：创建多个事件中心
- en: 'Messages can be routed to different endpoints based on the message header and
    body properties, as shown in *Figure 17.7*:'
  id: totrans-141
  prefs: []
  type: TYPE_NORMAL
  zh: 消息可以根据消息头和正文属性路由到不同的端点，如*图 17.7*所示：
- en: '![Adding details in the ‘Add a route’ pane,for adding a new route to different
    endpoints.](img/B15432_17_07.jpg)'
  id: totrans-142
  prefs: []
  type: TYPE_IMG
  zh: '![在“添加路由”面板中添加详细信息，以便向不同的端点添加新路由。](img/B15432_17_07.jpg)'
- en: 'Figure 17.7: Adding a new route to different endpoints'
  id: totrans-143
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图 17.7：向不同的端点添加新路由
- en: Messages in an IoT hub stay there for seven days by default, and their size
    can go up to 256 KB.
  id: totrans-144
  prefs: []
  type: TYPE_NORMAL
  zh: IoT Hub 中的消息默认保存七天，消息的大小可以达到 256 KB。
- en: There is a sample simulator provided by Microsoft for simulating sending messages
    to the cloud. It is available in multiple languages; the C# version can be viewed
    at [https://docs.microsoft.com/azure/iot-hub/iot-hub-csharp-csharp-c2d](https://docs.microsoft.com/azure/iot-hub/iot-hub-csharp-csharp-c2d).
  id: totrans-145
  prefs: []
  type: TYPE_NORMAL
  zh: 微软提供了一个示例模拟器，用于模拟将消息发送到云端。它支持多种语言；可以在 [https://docs.microsoft.com/azure/iot-hub/iot-hub-csharp-csharp-c2d](https://docs.microsoft.com/azure/iot-hub/iot-hub-csharp-csharp-c2d)
    查看 C# 版本。
- en: '**Cloud-to-device messaging**'
  id: totrans-146
  prefs: []
  type: TYPE_NORMAL
  zh: '**云端到设备消息传递**'
- en: IoT Hub is a managed service providing a bi-directional messaging infrastructure.
    Messages can be sent from the cloud to devices, and then based on the message,
    the devices can act on them.
  id: totrans-147
  prefs: []
  type: TYPE_NORMAL
  zh: IoT Hub 是一个托管服务，提供双向消息传递基础设施。消息可以从云端发送到设备，然后设备根据消息执行相应操作。
- en: 'There are three types of cloud-to-device messaging patterns:'
  id: totrans-148
  prefs: []
  type: TYPE_NORMAL
  zh: 有三种类型的云端到设备消息传递模式：
- en: Direct methods require immediate confirmation of results. Direct methods are
    often used for the interactive control of devices, such as opening and closing
    garage shutters. They follow the request-response pattern.
  id: totrans-149
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 直接方法需要立即确认结果。直接方法通常用于设备的互动控制，例如开关车库百叶窗。它们遵循请求-响应模式。
- en: Setting up device properties using Azure IoT provides **device twin** properties.
    For example, you can set the telemetry-sending interval to 30 minutes. Device
    twins are JSON documents that store device state information (such as metadata,
    configurations, and conditions). An IoT hub persists a device twin for each device
    in the IoT hub.
  id: totrans-150
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 使用 Azure 物联网设置设备属性时，提供 **设备双胞胎** 属性。例如，您可以将遥测发送间隔设置为 30 分钟。设备双胞胎是存储设备状态信息的 JSON
    文档（例如元数据、配置和条件）。物联网中心为每个设备在物联网中心中持久化一个设备双胞胎。
- en: Cloud-to-device messages are used for one-way notifications to the device app.
    This follows the fire-and-forget pattern.
  id: totrans-151
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 云到设备的消息用于单向通知设备应用程序。此模式遵循“发送后忘记”模式。
- en: In every organization, security is a big concern, and even in the case of IoT
    devices and data, this concern is still there. We will be discussing security
    in the next section.
  id: totrans-152
  prefs: []
  type: TYPE_NORMAL
  zh: 在每个组织中，安全性都是一个重要问题，即使是在物联网设备和数据的情况下，这个问题依然存在。我们将在下一部分讨论安全性。
- en: Security
  id: totrans-153
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 安全性
- en: Security is an important aspect of IoT-based applications. IoT-based applications
    comprise devices that use the public internet for connectivity to back-end applications.
    Securing devices, back-end applications, and connectivity from malicious users
    and hackers should be considered a top priority for the success of these applications.
  id: totrans-154
  prefs: []
  type: TYPE_NORMAL
  zh: 安全性是基于物联网的应用程序中的一个重要方面。基于物联网的应用程序包括使用公共互联网进行连接的设备，这些设备连接到后端应用程序。保护设备、后端应用程序及连接免受恶意用户和黑客攻击应被视为这些应用程序成功的首要任务。
- en: '**Security in IoT**'
  id: totrans-155
  prefs: []
  type: TYPE_NORMAL
  zh: '**物联网中的安全性**'
- en: 'IoT applications are primarily built around the internet, and security should
    play a major role in ensuring that a solution is not compromised. Some of the
    most important security decisions affecting IoT architecture are listed here:'
  id: totrans-156
  prefs: []
  type: TYPE_NORMAL
  zh: 物联网应用程序主要围绕互联网构建，安全性在确保解决方案不被妥协方面起着至关重要的作用。影响物联网架构的一些重要安全决策列举如下：
- en: Regarding devices using HTTP versus HTTPS REST endpoints, REST endpoints secured
    by certificates ensure that messages transferred from a device to the cloud and
    vice versa are well encrypted and signed. The messages should make no sense to
    an intruder and should be extremely difficult to crack.
  id: totrans-157
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 关于使用 HTTP 和 HTTPS REST 端点的设备，受到证书保护的 REST 端点可确保从设备到云端及其反向传输的消息得到良好的加密和签名。这些消息对于入侵者来说应该毫无意义，并且极难破解。
- en: If devices are connected to a local gateway, the local gateway should connect
    to the cloud using a secure HTTP protocol.
  id: totrans-158
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 如果设备连接到本地网关，则本地网关应使用安全的 HTTP 协议连接到云端。
- en: Devices should be registered to IoT Hub before they can send any messages.
  id: totrans-159
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 设备必须先注册到物联网中心，才能发送任何消息。
- en: The information passed to the cloud should be persisted into storage that is
    well protected and secure. Appropriate SAS tokens or connection strings that are
    stored in Azure Key Vault should be used for connection.
  id: totrans-160
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 传递到云端的信息应存储在受保护和安全的存储中。应使用存储在 Azure Key Vault 中的适当 SAS 令牌或连接字符串进行连接。
- en: Azure Key Vault should be used to store all secrets, passwords, and credentials,
    including certificates.
  id: totrans-161
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 应使用 Azure Key Vault 存储所有的机密、密码和凭证，包括证书。
- en: Azure Security Center for IoT provides threat prevention and analysis for every
    device, IoT Edge, and IoT Hub across your IoT assets. We can build our own dashboards
    in Azure Security Center based on the security assessments. Some key features
    include central management from Azure Security Center, adaptive threat protection,
    and intelligent threat detection. It's a best practice to consider Azure Security
    Center while implementing secured IoT solutions.
  id: totrans-162
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: Azure 安全中心 for IoT 提供针对每个设备、IoT Edge 和 IoT Hub 的威胁防护和分析，涵盖您的物联网资产。我们可以根据安全评估在
    Azure 安全中心中构建自己的仪表板。一些关键功能包括来自 Azure 安全中心的集中管理、自适应威胁保护和智能威胁检测。在实施安全的物联网解决方案时，考虑使用
    Azure 安全中心是一种最佳实践。
- en: Next, we are going to look at the scalability aspect of IoT Hub.
  id: totrans-163
  prefs: []
  type: TYPE_NORMAL
  zh: 接下来，我们将探讨物联网中心（IoT Hub）的可扩展性方面。
- en: Scalability
  id: totrans-164
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 可扩展性
- en: 'Scalability for IoT Hub is a bit different than for other services. In IoT
    Hub, there are two types of messages:'
  id: totrans-165
  prefs: []
  type: TYPE_NORMAL
  zh: 物联网中心的可扩展性与其他服务略有不同。在物联网中心，有两种类型的消息：
- en: '**Incoming**: Device-to-cloud messages'
  id: totrans-166
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**传入**：设备到云的消息'
- en: '**Outgoing**: Cloud-to-device messages'
  id: totrans-167
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**传出**：云到设备的消息'
- en: Both need to be accounted for in terms of scalability.
  id: totrans-168
  prefs: []
  type: TYPE_NORMAL
  zh: 两者在可扩展性方面都需要考虑。
- en: IoT Hub provides a couple of configuration options during provision time to
    configure scalability. These options are also available post-provisioning and
    can be updated to better suit the solution requirements in terms of scalability.
  id: totrans-169
  prefs: []
  type: TYPE_NORMAL
  zh: IoT Hub 在配置时提供了一些选项来配置可扩展性。这些选项在配置后也可用，可以更新以更好地满足解决方案的可扩展性要求。
- en: 'The scalability options that are available for IoT Hub are as follows:'
  id: totrans-170
  prefs: []
  type: TYPE_NORMAL
  zh: IoT Hub 提供的可扩展性选项如下：
- en: The **Stock Keeping Unit** (**SKU**) edition, which is the size of IoT Hub
  id: totrans-171
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**库存单位**（**SKU**）版本，即 IoT Hub 的大小'
- en: The number of units
  id: totrans-172
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 单位数量
- en: We will first look into the SKU edition option.
  id: totrans-173
  prefs: []
  type: TYPE_NORMAL
  zh: 我们将首先查看 SKU 版本选项。
- en: '**The SKU edition**'
  id: totrans-174
  prefs: []
  type: TYPE_NORMAL
  zh: '**SKU 版本**'
- en: 'The SKU in IoT Hub determines the number of messages a hub can handle per unit
    per day, and this includes both incoming and outgoing messages. There are four
    tiers, as follows:'
  id: totrans-175
  prefs: []
  type: TYPE_NORMAL
  zh: IoT Hub 中的 SKU 决定了每个单位每天能处理的消息数量，包括入站和出站消息。共有四个层级，具体如下：
- en: '**Free**: This allows 8,000 messages per unit per day and allows both incoming
    and outgoing messages. A maximum of 1 unit can be provisioned. This edition is
    suitable for gaining familiarity and testing out the capabilities of the IoT Hub
    service.'
  id: totrans-176
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**免费版**：此版本允许每个单位每天处理 8,000 条消息，并支持双向消息（入站和出站）。最多可配置 1 个单位。此版本适用于熟悉和测试 IoT
    Hub 服务的功能。'
- en: '**Standard (S1)**: This allows 400,000 messages per unit per day and allows
    both incoming and outgoing messages. A maximum of 200 units can be provisioned.
    This edition is suitable for a small number of messages.'
  id: totrans-177
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**标准版 (S1)**：此版本允许每个单位每天处理 400,000 条消息，并支持双向消息（入站和出站）。最多可配置 200 个单位。此版本适用于少量消息。'
- en: '**Standard (S2)**: This allows 6 million messages per unit per day and allows
    both incoming and outgoing messages. A maximum of 200 units can be provisioned.
    This edition is suitable for a large number of messages.'
  id: totrans-178
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**标准版 (S2)**：此版本允许每个单位每天处理 600 万条消息，并支持双向消息（入站和出站）。最多可配置 200 个单位。此版本适用于大量消息。'
- en: '**Standard (S3)**: This allows 300 million messages per unit per day and allows
    both incoming and outgoing messages. A maximum of 10 units can be provisioned.
    This edition is suitable for a very large number of messages.'
  id: totrans-179
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**标准版 (S3)**：此版本允许每个单位每天处理 3 亿条消息，并支持双向消息（入站和出站）。最多可配置 10 个单位。此版本适用于非常大量的消息。'
- en: 'The upgrade and scaling options are available in the Azure portal, under the
    **Pricing and scale** blade of IoT Hub. The options will be presented to you as
    shown in *Figure 17.8*:'
  id: totrans-180
  prefs: []
  type: TYPE_NORMAL
  zh: 升级和扩展选项可以在 Azure 门户中的 IoT Hub **定价和规模** 页面找到。这些选项将以 *图 17.8* 所示的形式展示给您：
- en: '![The Pricing and scale blade of IoT Hub displaying various options to choose
    the pricing and scale tier, such as S1 Standard, S2 Standard, S3 Standard, B1
    Basic, B2 Basic, B3 Basic, and so on.](img/B15432_17_08.jpg)'
  id: totrans-181
  prefs: []
  type: TYPE_IMG
  zh: '![IoT Hub 的定价和规模页面，显示了选择定价和规模层级的各种选项，如 S1 标准版、S2 标准版、S3 标准版、B1 基础版、B2 基础版、B3
    基础版等。](img/B15432_17_08.jpg)'
- en: 'Figure 17.8: Choosing a pricing and scale tier'
  id: totrans-182
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图 17.8：选择定价和规模层级
- en: You may notice that the **Standard S3** tier allows a maximum of only **10 units**,
    compared to other standard units that allow **200 units**. This is directly related
    to the size of the compute resources that are provisioned to run IoT services.
    The size and capability of virtual machines for **Standard S3** are significantly
    higher compared to other tiers, where the size remains the same.
  id: totrans-183
  prefs: []
  type: TYPE_NORMAL
  zh: 您可能会注意到，**标准版 S3** 层级最多只允许 **10 个单位**，而其他标准层级则允许 **200 个单位**。这与为运行 IoT 服务所配置的计算资源的大小直接相关。**标准版
    S3** 的虚拟机的大小和能力远高于其他层级，而其他层级的大小保持不变。
- en: '**Units**'
  id: totrans-184
  prefs: []
  type: TYPE_NORMAL
  zh: '**单位**'
- en: Units define the number of instances of each SKU running behind the service.
    For example, 2 units of the **Standard S1** SKU tier will mean that the IoT hub
    is capable of handling *400K * 2 = 800K* messages per day.
  id: totrans-185
  prefs: []
  type: TYPE_NORMAL
  zh: 单位定义了每个 SKU 在服务后端运行的实例数量。例如，2 个 **标准版 S1** SKU 单位意味着 IoT Hub 每天可以处理 *400K *
    2 = 800K* 消息。
- en: 'More units will increase the scalability of the application. *Figure 17.9*
    is from the **Pricing and scale** blade of IoT Hub, where you can see the current
    pricing tier and number of units:'
  id: totrans-186
  prefs: []
  type: TYPE_NORMAL
  zh: 增加单位数量将提高应用程序的可扩展性。*图 17.9* 来自 IoT Hub 的 **定价和规模** 页面，您可以在其中看到当前的定价层级和单位数量：
- en: '![The Pricing and scale tier displayed as S1 Standard, and the Number of IoT
    Hub units selected as one.](img/B15432_17_09.jpg)'
  id: totrans-187
  prefs: []
  type: TYPE_IMG
  zh: '![显示为 S1 标准版的定价和规模层，以及选择的 IoT Hub 单位数量为一个。](img/B15432_17_09.jpg)'
- en: 'Figure 17.9: Options to adjust or migrate IoT Hub units'
  id: totrans-188
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图 17.9：调整或迁移 IoT Hub 单位的选项
- en: One of the booming services in Azure IoT Hub right now is Azure IoT Edge, which
    is a completely managed service built on Azure IoT Hub. We will be exploring what
    Azure IoT Edge is in the next section.
  id: totrans-189
  prefs: []
  type: TYPE_NORMAL
  zh: 目前在Azure IoT Hub中蓬勃发展的服务之一是Azure IoT Edge，它是一个完全托管的服务，建立在Azure IoT Hub之上。我们将在下一部分探讨什么是Azure
    IoT Edge。
- en: Azure IoT Edge
  id: totrans-190
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: Azure IoT Edge
- en: Microsoft Azure IoT Edge leverages edge compute to implement IoT solutions.
    Edge compute refers to the compute resources that are available on your on-premises
    network, right at the end of your network, where the public internet starts. This
    can be deployed on your main network or a guest network with firewall isolation.
  id: totrans-191
  prefs: []
  type: TYPE_NORMAL
  zh: Microsoft Azure IoT Edge利用边缘计算实现物联网解决方案。边缘计算是指您本地网络上可用的计算资源，位于网络的末端，公共互联网开始的地方。可以将其部署在您的主网络或具有防火墙隔离的来宾网络上。
- en: Azure IoT Edge comprises the IoT Edge runtime, which needs to be installed on
    a computer or a device. Docker will be installed on the computer; the computer
    can run either Windows or Linux. The role of Docker is to run the IoT Edge modules.
  id: totrans-192
  prefs: []
  type: TYPE_NORMAL
  zh: Azure IoT Edge包括IoT Edge运行时，需要安装在计算机或设备上。Docker将安装在计算机上；计算机可以运行Windows或Linux。Docker的作用是运行IoT
    Edge模块。
- en: Azure IoT Edge relies on the hybrid cloud concept, where you can deploy and
    manage IoT solutions on on-premises hardware and easily integrate them with Microsoft
    Azure.
  id: totrans-193
  prefs: []
  type: TYPE_NORMAL
  zh: Azure IoT Edge依赖于混合云概念，您可以在本地硬件上部署和管理物联网解决方案，并轻松将其与Microsoft Azure集成。
- en: Microsoft provides comprehensive documentation for Azure IoT Edge, with quick-start
    templates and guidance on how to install the modules. The link to the documentation
    is [https://docs.microsoft.com/azure/iot-edge](https://docs.microsoft.com/azure/iot-edge).
  id: totrans-194
  prefs: []
  type: TYPE_NORMAL
  zh: Microsoft为Azure IoT Edge提供了全面的文档，包括快速入门模板和安装模块的指导。文档链接是[https://docs.microsoft.com/azure/iot-edge](https://docs.microsoft.com/azure/iot-edge)。
- en: In the next section, we will look at how infrastructure is managed in the case
    of Azure IoT Hub and how high availability is provided to customers.
  id: totrans-195
  prefs: []
  type: TYPE_NORMAL
  zh: 在下一部分，我们将了解在Azure IoT Hub的情况下，如何管理基础设施以及如何为客户提供高可用性。
- en: High availability
  id: totrans-196
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 高可用性
- en: IoT Hub is a **platform as a service** (**PaaS**) offering from Azure. Customers
    and users do not directly interact with the underlying number and size of virtual
    machines on which the IoT Hub service runs. Users decide on the region, the SKU
    of the IoT hub, and the number of units for their application. The rest of the
    configuration is determined and executed by Azure behind the scenes. Azure ensures
    that every PaaS service is highly available by default. It does so by ensuring
    that multiple virtual machines provisioned behind the service are on separate
    racks in the datacenter. It does this by placing those virtual machines on an
    availability set and on a separate fault and update domain. This helps ensure
    high availability for both planned and unplanned maintenance. Availability sets
    take care of high availability at the datacenter level.
  id: totrans-197
  prefs: []
  type: TYPE_NORMAL
  zh: IoT Hub是Azure提供的**平台即服务**（**PaaS**）产品。客户和用户不会直接与运行IoT Hub服务的虚拟机的数量和大小进行交互。用户决定地区、IoT
    Hub的SKU和其应用程序所需的单位数量。其余配置由Azure在后台确定并执行。Azure确保每个PaaS服务默认是高度可用的。它通过确保多个虚拟机在数据中心内的不同机架上提供服务，从而实现这一点。通过将这些虚拟机放置在可用性集中，并置于单独的故障域和更新域中，Azure确保了计划内和计划外维护的高可用性。可用性集确保了数据中心级别的高可用性。
- en: In the next section, we will discuss Azure IoT Central.
  id: totrans-198
  prefs: []
  type: TYPE_NORMAL
  zh: 在下一部分，我们将讨论Azure IoT Central。
- en: Azure IoT Central
  id: totrans-199
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: Azure IoT Central
- en: Azure IoT Central provides a platform to build enterprise-grade IoT applications
    to meet your business requirements in a secure, reliable, and scalable fashion.
    IoT Central eliminates the cost of developing, maintaining, and managing IoT solutions.
  id: totrans-200
  prefs: []
  type: TYPE_NORMAL
  zh: Azure IoT Central提供了一个平台，用于构建企业级物联网应用程序，以安全、可靠和可扩展的方式满足您的业务需求。IoT Central消除了开发、维护和管理物联网解决方案的成本。
- en: 'IoT Central provides centralized management by which you can manage and monitor
    devices, device conditions, rule creation, and device data. In *Figure 17.10*,
    you can see some of the templates that are available in the Azure portal during
    the creation of IoT Central applications:'
  id: totrans-201
  prefs: []
  type: TYPE_NORMAL
  zh: IoT Central提供集中管理，您可以管理和监控设备、设备状态、规则创建和设备数据。在*图17.10*中，您可以看到在创建IoT Central应用程序时，Azure门户中可用的一些模板：
- en: '![The available templates displayed in the Azure portal during the creation
    of IoT Central applicationssuch as Custom application, Connected Logistics, Solar
    Power Monitoring, and so on.](img/B15432_17_10.jpg)'
  id: totrans-202
  prefs: []
  type: TYPE_IMG
  zh: '![在 Azure 门户中创建 IoT Central 应用程序时显示的可用模板，如自定义应用程序、连接物流、太阳能监控等。](img/B15432_17_10.jpg)'
- en: Figure 17.10 Creating an Azure IoT Central application
  id: totrans-203
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图 17.10 创建 Azure IoT Central 应用程序
- en: Templates will give you a head start and you can customize them as per your
    requirements. This will save you a lot of time during the development phase.
  id: totrans-204
  prefs: []
  type: TYPE_NORMAL
  zh: 模板将为您提供一个起点，您可以根据需求进行自定义。这将在开发阶段为您节省大量时间。
- en: 'IoT Central offers a seven-day trial at the time of writing, and you can see
    the pricing for this service here: [https://azure.microsoft.com/pricing/details/iot-central/?rtc=1](https://azure.microsoft.com/pricing/details/iot-central/?rtc=1).'
  id: totrans-205
  prefs: []
  type: TYPE_NORMAL
  zh: IoT Central 在撰写时提供七天的试用期，您可以在这里查看该服务的定价：[https://azure.microsoft.com/pricing/details/iot-central/?rtc=1](https://azure.microsoft.com/pricing/details/iot-central/?rtc=1)。
- en: Azure IoT Central is a boon for every organization that is developing IoT applications.
  id: totrans-206
  prefs: []
  type: TYPE_NORMAL
  zh: Azure IoT Central 对于每个开发 IoT 应用程序的组织来说都是一项福音。
- en: Summary
  id: totrans-207
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 总结
- en: IoT is one of the biggest emerging technologies of this decade and it is already
    disrupting industries. Things that sounded impossible before are now suddenly
    possible.
  id: totrans-208
  prefs: []
  type: TYPE_NORMAL
  zh: IoT 是本十年最大的新兴技术之一，已经开始颠覆各行各业。曾经看似不可能的事情，现在突然变得可能。
- en: In this chapter, we explored IoT Hub and discussed the delivery of IoT solutions
    to the customer in a faster, better, and cheaper way than alternative solutions.
    We also covered how IoT can fast-track the entire development life cycle and help
    expedite time-to-market for companies. Finally, you learned about Azure IoT Edge
    and Azure IoT Central.
  id: totrans-209
  prefs: []
  type: TYPE_NORMAL
  zh: 本章中，我们探讨了 IoT Hub，并讨论了如何以比其他解决方案更快、更好、更便宜的方式将 IoT 解决方案交付给客户。我们还介绍了 IoT 如何加速整个开发生命周期，帮助公司缩短上市时间。最后，您了解了
    Azure IoT Edge 和 Azure IoT Central。
- en: To help you effectively analyze ever-growing volumes of data, we will discuss
    Azure Synapse Analytics in the next chapter.
  id: totrans-210
  prefs: []
  type: TYPE_NORMAL
  zh: 为了帮助您有效分析日益增长的数据量，我们将在下一章讨论 Azure Synapse Analytics。
- en: 17\. Designing IoT solutions
  id: totrans-211
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 17\. 设计 IoT 解决方案
