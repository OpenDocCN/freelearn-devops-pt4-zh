<html><head></head><body>
		<div id="_idContainer592" class="Content">&#13;
			<h1 id="_idParaDest-475"><a id="_idTextAnchor758"/>Appendix A – OpenShift Sizing Requirements for Exercises</h1>&#13;
		</div>&#13;
		<div id="_idContainer594" class="Content">&#13;
			<div>&#13;
				<div id="_idContainer593" class="IMG---Figure" style="float: left; margin: 6px; hight:6cm; width:6cm;">&#13;
					<img src="../Images/image001.jpg" alt="" width="220" height="220"/>&#13;
				</div>&#13;
			</div>&#13;
			<p>OpenShift clusters support many types of footprints – cloud, datacenter, and local. You can discover the best way to install OpenShift in these <a id="_idIndexMarker3409"/><a id="_idIndexMarker3410"/>different environments by browsing to this link: <a href="https://cloud.redhat.com/openshift/create/">https://cloud.redhat.com/openshift/create/</a>.</p>&#13;
			<p>There is a distinction between <em class="italics">Red Hat supported</em> and <em class="italics">community</em> versions of OpenShift. You may wish to get full enterprise support for the Red Hat versions from Red Hat! Especially if you are doing anything work related, this is highly recommended. The community versions are supported by the open source community, you can read about them here <a href="https://www.okd.io/">https://www.okd.io/</a>.</p>&#13;
			<p>We have detailed using <strong class="bold">CodeReady Containers</strong> (<strong class="bold">CRC</strong>) on your local machine as the way to get started with OpenShift. There is both a<a id="_idIndexMarker3411"/><a id="_idIndexMarker3412"/> supported version of CRC, <a href="https://cloud.redhat.com/openshift/create/local">https://cloud.redhat.com/openshift/create/local</a>, and a community version, <a href="https://www.okd.io/crc.html">https://www.okd.io/crc.html</a>, available. To run CRC with the default settings, execute the following:</p>&#13;
			<p class="snippet">crc start</p>&#13;
			<p>In an effort to constrain the system resources used, CRC does not contain all of OpenShift’s features. Running CRC locally will take a lot longer if executing the techie bits of this book. You may find frequent timeouts and have to <em class="italics">try some commands twice</em>. So, either be patient or perhaps use a Cloud hosted OpenShift which has fewer resource constraints. If you have real money to spend on cloud hosting or you have a virtualized infrastructure available to you, you can install an OpenShift 4 cluster using the binary installer:</p>&#13;
			<p class="snippet">openshift-install cluster create</p>&#13;
			<p>This will give you a running cluster <a id="_idIndexMarker3413"/><a id="_idIndexMarker3414"/>with multiple master and worker nodes and you can configure different options prior to installing. Read the docs here: <a href="https://docs.openshift.com/container-platform/4.7/installing/index.html">https://docs.openshift.com/container-platform/4.7/installing/index.html</a>.</p>&#13;
			<p>CRC can be started with various options. Importantly, you can set the following:</p>&#13;
			<ul style="list-style-type:disc;">&#13;
				<li><strong class="inline">-c, --cpus int</strong>: The number of CPU cores to allocate to the OpenShift cluster (the default is 4)</li>&#13;
				<li><strong class="inline">-m, --memory int</strong>: The amount of memory (in MiB) to allocate to the OpenShift cluster (the default is 9216)</li>&#13;
				<li><strong class="inline">-d, --disk-size uint</strong>: The total size (in GiB) of the disk used by the OpenShift cluster (the default is 31)</li>&#13;
			</ul>&#13;
			<p>You can also configure the IP address – check out <strong class="inline">crc start --help</strong> for details.</p>&#13;
			<p>We have tested the following scenarios from the book using CRC and recommend the following minimum sizing. If you have more resources available locally, we recommend you use them! This will improve <a id="_idIndexMarker3415"/><a id="_idIndexMarker3416"/>the performance and usability when running through the code.</p>&#13;
			<div>&#13;
				<div id="_idContainer1001" class="IMG---Figure">&#13;
					<img src="../Images/Table_Appendix_A_1.png" alt="" style="height:300px; width:600px;"/>&#13;
				</div>&#13;
			</div>&#13;
						<p class="figure">Table Appendix A.1: Minimum sizing for various book scenarios</p>&#13;
			<p>CRC is<a id="_idIndexMarker3417"/><a id="_idIndexMarker3418"/> optimized to run on a single machine and so has metrics and monitoring disabled by default. This can be enabled by running the following command:</p>&#13;
			<p class="snippet">crc config set enable-cluster-monitoring true</p>&#13;
			<p>Be aware that you will require more memory than listed above to be able to run the monitoring stack, CI/CD, and PetBattle. For <a id="_idIndexMarker3419"/><a id="_idIndexMarker3420"/>the full documentation, options, and troubleshooting for CRC, please see <a href="https://code-ready.github.io/crc/">https://code-ready.github.io/crc/</a>.</p>&#13;
			<h3 id="_idParaDest-476"><a id="_idTextAnchor759"/>How To Resize Storage in Your CRC Virtual Machine</h3>&#13;
			<p>To grow the image disk size, you<a id="_idIndexMarker3421"/><a id="_idIndexMarker3422"/> need to stop and restart CRC to properly resize the image disk. This seems to be a bug/issue with CRC.<span class="P---Superscript">[</span><span id="footnote-191-backlink"><a class="_idFootnoteLink _idGenColorInherit" href="#footnote-191">1</a></span><span class="P---Superscript">][</span><span id="footnote-190-backlink"><a class="_idFootnoteLink _idGenColorInherit" href="#footnote-190">2</a></span><span class="P---Superscript">]</span></p>&#13;
			&#13;
			<p>On Linux, perform the <a id="_idIndexMarker3423"/><a id="_idIndexMarker3424"/>following to resize the disk:</p>&#13;
			<p class="snippet">$ crc start -c 4 -m 16384 -d 50</p>&#13;
			<p class="snippet">$ CRC_MACHINE_IMAGE=${HOME}/.crc/machines/crc/crc.qcow2</p>&#13;
			<p class="snippet">$ crc stop</p>&#13;
			<p class="snippet">$ cp ${CRC_MACHINE_IMAGE} ${CRC_MACHINE_IMAGE}.ORIGINAL</p>&#13;
			<p class="snippet">$ virt-resize --expand /dev/vda4 \</p>&#13;
			<p class="snippet">$ {CRC_MACHINE_IMAGE}.ORIGINAL ${CRC_MACHINE_IMAGE}</p>&#13;
			<p class="snippet">$ rm -f ${CRC_MACHINE_IMAGE}.ORIGINAL</p>&#13;
			<p class="snippet">crc start -c 4 -m 16384 -d 50</p>&#13;
			<h3 id="_idParaDest-477"><a id="_idTextAnchor760"/>Tekton Persistent Storage</h3>&#13;
			<p>Depending on your <a id="_idIndexMarker3425"/><a id="_idIndexMarker3426"/>environment, the type of storage class available to your OpenShift cluster will vary.</p>&#13;
			<h3><a id="_idTextAnchor761"/>CRC specifics</h3>&#13;
			<p>Currently, there are two Kustomize<a id="_idIndexMarker3427"/><a id="_idIndexMarker3428"/> overlays for <strong class="inline">PersistentVolumeClaims</strong> used in OpenShift. This is because there are different storage classes available in each environment. In <em class="italics">Chapter 7</em>, <em class="italics">Open Technical Practices – The Midpoint</em>, we bootstrap the tooling using ArgoCD. The Ubiquitous Journey file <strong class="inline">tekton/kustomization.yaml</strong> needs to be set accordingly by changing the following commented line:</p>&#13;
			<p class="snippet">apiVersion: kustomize.config.k8s.io/v1beta1</p>&#13;
			<p class="snippet">kind: Kustomization</p>&#13;
			<p class="snippet">bases:</p>&#13;
			<p class="snippet">- persistent-volume-claims/aws</p>&#13;
			<p class="snippet"># - persistent-volume-claims/crc</p>&#13;
			<p class="snippet">- rolebindings</p>&#13;
			<p class="snippet">- tasks</p>&#13;
			<p class="snippet">- pipelines</p>&#13;
			<p class="snippet">- templates</p>&#13;
			<p class="snippet">- triggers</p>&#13;
			<div id="footnote-191" class="_idFootnote" epub:type="footnote">&#13;
				<p class="FootNote"><a class="_idFootnoteAnchor _idGenColorInherit" href="#footnote-191-backlink">1</a>	<a href="https://access.redhat.com/solutions/4969811">https://access.redhat.com/solutions/4969811</a></p>&#13;
				<div id="footnote-190" class="_idFootnote" epub:type="footnote">&#13;
					<p class="FootNote"><a class="_idFootnoteAnchor _idGenColorInherit" href="#footnote-190-backlink">2</a>	<a href="https://github.com/code-ready/crc/issues/127">https://github.com/code-ready/crc/issues/127</a></p>&#13;
				</div>&#13;
			</div>&#13;
			<h3><a id="_idTextAnchor762"/>Cloud specifics</h3>&#13;
			<p>In AWS, we make use of <strong class="inline">aws-efs</strong> (<a href="https://docs.openshift.com/container-platform/4.4/storage/persistent_storage/persistent-storage-efs.html">https://docs.openshift.com/container-platform/4.4/storage/persistent_storage/persistent-storage-efs.html</a>) for RWX storage. An updated EFS driver is in the works. If this is not<a id="_idIndexMarker3429"/><a id="_idIndexMarker3430"/> available in your environment, you will still be able to run the examples but not all pipeline jobs will function currently if they are run in parallel. </p>&#13;
			<p>Edit the <strong class="inline">tekton/persistent-volume-claims</strong> files to use a storage class available in your cluster (for example, gp2 is the default in AWS). You can find the storage class name by running the following command:</p>&#13;
			<p class="snippet">oc get storageclass </p>&#13;
		</div>&#13;
</body></html>