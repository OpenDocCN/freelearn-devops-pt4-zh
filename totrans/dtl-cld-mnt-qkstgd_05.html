<html><head></head><body><div id="sbo-rt-content"><div id="_idContainer067">
			<h1 id="_idParaDest-86"><em class="italic"><a id="_idTextAnchor162"/>Chapter 4</em>: Account Management</h1>
			<p>In the last chapter, we looked at the main features of the Datadog user interface. The account management features are also part of the user interface but those warrant a separate discussion as account management is administrative in nature and not all the users of Datadog would be accessing those.</p>
			<p>Datadog supports <strong class="bold">Single Sign-On</strong> (<strong class="bold">SSO</strong>) and it provides key-based API support. It also supports multiple organizations within a customer account that can be used to build isolated monitoring environments, sometimes to meet a compliance requirement for separating development and production accounts, or for isolating client accounts hosted by a SaaS provider.</p>
			<p>When a user is created, first the privileges for that user can be set by using default roles available out of the box or it can be done finely using custom roles that an administrator can set up. Within a Datadog account, multiple organizations can be created to group or partition the environments that need to be monitored. While Datadog provides a native authentication system for users to log in, it also supports SSO. API and application key pairs can be created for Datadog users and a key pair can be used to access Datadog programmatically.</p>
			<p>This chapter covers all such account management features that are available on the Datadog UI and specifically the following:</p>
			<ul>
				<li>Managing users</li>
				<li>Granting custom access using roles</li>
				<li>Setting up organizations</li>
				<li>Implementing Single Sign-On (SSO)</li>
				<li>Managing API and application keys</li>
				<li>Tracking usage</li>
			</ul>
			<h1 id="_idParaDest-87"><a id="_idTextAnchor163"/>Technical requirements</h1>
			<p>There are no technical requirements for this chapter.</p>
			<h1 id="_idParaDest-88"><a id="_idTextAnchor164"/>Managing users</h1>
			<p>After Datadog is rolled out into an environment that mainly involves deploying the agent, the users <a id="_idIndexMarker265"/>can be given access to Datadog interfaces that provide insight into the infrastructure and the application software system. Though users can get API access to Datadog, they primarily use the UI to consume the information available.</p>
			<p>A user can be added by sending out an invitation by email, which could be done from the main menu item <strong class="bold">Team</strong> on the Datadog dashboard.</p>
			<p>The following screenshot is a sample <strong class="bold">Team</strong> window:</p>
			<div>
				<div id="_idContainer049" class="IMG---Figure">
					<img src="Images/Figure_4.1_B16483.jpg" alt="Figure 4.1– Main menu Team window&#13;&#10;" width="1650" height="884"/>
				</div>
			</div>
			<p class="figure-caption">Figure 4.1– Main menu Team window</p>
			<p>Users can be invited using a form available at the bottom of the <strong class="bold">Team</strong> window, as shown here:</p>
			<div>
				<div id="_idContainer050" class="IMG---Figure">
					<img src="Images/Figure_4.2_B16483.jpg" alt="Figure 4.2 – Invite Users form in the Team window&#13;&#10;" width="1256" height="283"/>
				</div>
			</div>
			<p class="figure-caption">Figure 4.2 – Invite Users form in the Team window</p>
			<p>Also, it can be <a id="_idIndexMarker266"/>done by using the <strong class="bold">Invite Users</strong> option available in the <strong class="bold">Team</strong> window:</p>
			<div>
				<div id="_idContainer051" class="IMG---Figure">
					<img src="Images/Figure_4.3_B16483.jpg" alt="Figure – 4.3 Invite Users dialog &#13;&#10;" width="605" height="342"/>
				</div>
			</div>
			<p class="figure-caption">Figure – 4.3 Invite Users dialog </p>
			<p>When a user is invited to join the team, one or more roles for the user must be assigned as well.</p>
			<p>These are the roles available:</p>
			<ul>
				<li><strong class="bold">Datadog Admin Role</strong>: As the name indicates, a user with this role is an administrator <a id="_idIndexMarker267"/>and that user can manage other users and has access to billing information.</li>
				<li><strong class="bold">Datadog Standard Role</strong>: A user <a id="_idIndexMarker268"/>with this role has full access to various Datadog features.</li>
				<li><strong class="bold">Datadog Read Only Role</strong>: As the name suggests, a user with this role can have <a id="_idIndexMarker269"/>read-only access to various features. Typically, this is the access assigned to a lot of users of Datadog organizations that cover production environments.</li>
			</ul>
			<p>As you have <a id="_idIndexMarker270"/>seen in this section, access for a user can be granted using one or more predefined roles. It is possible to define the user access more finely using roles so let's see how that can be accomplishe<a id="_idTextAnchor165"/>d.</p>
			<h1 id="_idParaDest-89"><a id="_idTextAnchor166"/>Granting custom access using roles</h1>
			<p>Each role <a id="_idIndexMarker271"/>grants the user a set of privileges as listed in the following screenshot:</p>
			<div>
				<div id="_idContainer052" class="IMG---Figure">
					<img src="Images/Figure_4.4_B16483.jpg" alt="Figure 4.4 – Privileges available in the standard user role&#13;&#10;" width="551" height="502"/>
				</div>
			</div>
			<p class="figure-caption">Figure 4.4 – Privileges available in the standard user role</p>
			<p>While assigning <a id="_idIndexMarker272"/>one or more predefined roles might be enough in most access management use cases, users could be assigned more specific privileges using custom roles.</p>
			<p>The custom roles can be set up by an administrator and be assigned to users after that.</p>
			<p>Here are a few steps you need to follow to create a custom role:</p>
			<ol>
				<li value="1">Go to the <strong class="bold">Roles</strong> page on the dashboard (direct link: <a href="https://app.datadoghq.com/access/roles">https://app.datadoghq.com/access/roles</a>).</li>
				<li>In the upper-right corner of the page, click on the <strong class="bold">New Role</strong> link:<div id="_idContainer053" class="IMG---Figure"><img src="Images/Figure_4.5_B16483.jpg" alt="Figure 4.5 – Creating a new custom role &#13;&#10;" width="1650" height="911"/></div><p class="figure-caption">Figure 4.5 – Creating a new custom role </p></li>
				<li>Enter the <a id="_idIndexMarker273"/>name of the role in the <strong class="bold">Name</strong> field, pick the privileges you want to add to the role from the <strong class="bold">Permissions</strong> table, and click on the <strong class="bold">Save</strong> button to create the role.<p class="callout-heading">Important note</p><p class="callout">An existing custom role can be updated following similar steps as well.</p></li>
			</ol>
			<p>In this section, we have seen how user access can be finely defined using custom roles if predefined roles don't serve the access control requirements. The resources and users can be grouped under an organization in a Datadog account so let's see how that could be configur<a id="_idTextAnchor167"/>ed.</p>
			<h1 id="_idParaDest-90"><a id="_idTextAnchor168"/>Setting up organizations</h1>
			<p>It is possible to set up multiple organizations in the same Datadog account. This <strong class="bold">multi-organizations</strong> feature is <a id="_idIndexMarker274"/>not enabled by default and you must <a id="_idIndexMarker275"/>request customer support for it. Multiple child-organizations are useful in cases where monitoring needs to be isolated for parts of the infrastructure and the applications run on it:</p>
			<ul>
				<li><strong class="bold">Dedicated environments for development and production</strong>: The access to monitoring information that covers production and non-production environments can be very different in terms of who will access them, and the privileges needed. The focus of monitoring is usually keeping track of systems in production and access to related information is highly controlled. Even though roles can be used to control access finely, an easy and secure way of doing it is to partition monitoring into multiple organizations.</li>
				<li><strong class="bold">Dedicated monitoring for customers</strong>: To meet privacy compliance requirements, monitoring infrastructure may have to be isolated. If that is required and the application system is run on managed infrastructure, then the managed service vendor should provide dedicated monitoring for the managed infrastructure and the software system run on it. The multi-organizations feature offers a logical separation of monitoring that could be used to roll out dedicated monitoring for each customer under the same Datadog account managed by the hosting vendor.</li>
			</ul>
			<p>An organization can be tied to a sub-domain for better identification. You need to get this feature also enabled by customer support. Once that is available, you can access an organization using a specific URL such as <a href="https://prod.datadoghq.com">https://prod.datadoghq.com</a>. In this case, the sub-domain product points to an organization.</p>
			<p>Now, let's see how an organization can be set up:</p>
			<ol>
				<li value="1">After customer support enables the multi-organization feature, you will be able to see the <strong class="bold">New Organization</strong> feature as in the following screenshot:<div id="_idContainer054" class="IMG---Figure"><img src="Images/Figure_4.6_B16483.jpg" alt="Figure 4.6 – New Organization option enabled&#13;&#10;" width="826" height="370"/></div><p class="figure-caption">Figure 4.6 – New Organization option enabled</p></li>
				<li>Click on <a id="_idIndexMarker276"/>the option <strong class="bold">New Organization</strong> to bring up the following window where the name of the organization can be provided. In the example, it is <strong class="source-inline">Production Environment</strong>, with an intent to monitor all the production-related resources using this new organization:<div id="_idContainer055" class="IMG---Figure"><img src="Images/Figure_4.7_B16483.jpg" alt="Figure 4.7 – Creation of a new organization&#13;&#10;" width="1167" height="746"/></div><p class="figure-caption">Figure 4.7 – Creation of a new organization</p></li>
				<li>The Datadog UI will <a id="_idIndexMarker277"/>switch to the new organization upon its creation. You can switch between organizations by just clicking on the corresponding label under the <strong class="bold">SWITCH ORGANIZATION</strong> section, as shown in the following screenshot:</li>
			</ol>
			<div>
				<div id="_idContainer056" class="IMG---Figure">
					<img src="Images/Figure_4.8_B16483.jpg" alt="Figure 4.8 – Switch organizations&#13;&#10;" width="798" height="455"/>
				</div>
			</div>
			<p class="figure-caption">Figure 4.8 – Switch organizations</p>
			<p>The active organization is displayed at the top of the same menu.</p>
			<p>If a user is a <a id="_idIndexMarker278"/>member of multiple organizations in a Datadog account, the user has the option to switch between organizations on the Datadog dashboard.</p>
			<p>For many companies, <strong class="bold">SSO</strong> is a requirement to meet corporate or security <a id="_idIndexMarker279"/>compliances. Datadog supports a variety of SSO methods and providers and we will look at the details in the following se<a id="_idTextAnchor169"/>ction.</p>
			<h1 id="_idParaDest-91"><a id="_idTextAnchor170"/>Implementing Single Sign-On</h1>
			<p>As with other popular SaaS applications, Datadog can be set up to use SSO, which allows users to <a id="_idIndexMarker280"/>log into the Datadog UI using existing credentials <a id="_idIndexMarker281"/>with a third-party platform such as Google or in-house <a id="_idIndexMarker282"/>authentication platforms such as <strong class="bold">Active Directory</strong> or <strong class="bold">Lightweight Directory Access Protocol</strong> (<strong class="bold">LDAP</strong>).</p>
			<p>Datadog uses <strong class="bold">Security Assertion Markup Language</strong> (<strong class="bold">SAML</strong>) to implement third-party authentication for SSO.</p>
			<p>Let's look <a id="_idIndexMarker283"/>at a few key single sign-on features <a id="_idIndexMarker284"/>that Datadog provides:</p>
			<ul>
				<li>The SSO can be implemented using industry-standard authentication platforms and providers <a id="_idIndexMarker285"/>such as Active Directory, LDAP, Google, <strong class="bold">AuthO</strong>, and <strong class="bold">Okta</strong>.</li>
				<li>By mapping <a id="_idIndexMarker286"/>SAML attributes to Datadog user roles, the authenticated users can be granted corresponding privileges.</li>
				<li>Datadog permits <strong class="bold">Just-in-Time</strong> user provisioning, which avoids the requirements <a id="_idIndexMarker287"/>to create a user beforehand. A user will be created when they are logged in for the first time. A default user role can be set for Just-in-Time users and the privileges of the new user will be set based on that.</li>
			</ul>
			<p>Though the <a id="_idIndexMarker288"/>details can be different, a SAML-based SSO setup would require these generic steps:</p>
			<ol>
				<li value="1">Set up the <a id="_idIndexMarker289"/>third-party SSO provider as the SAML <strong class="bold">identity provider</strong> (<strong class="bold">IdP</strong>). This is done on the third-party side. Download the IdP metadata file after completing this setup.</li>
				<li>Using the <strong class="bold">Configure SAML</strong> menu option on the Datadog UI, configure SSO mainly by uploading the IdP metadata created in the last step:<div id="_idContainer057" class="IMG---Figure"><img src="Images/Figure_4.9_B16483.jpg" alt="Figure 4.9 – Configure SAML menu option&#13;&#10;" width="478" height="226"/></div><p class="figure-caption">Figure 4.9 – Configure SAML menu option</p></li>
				<li>From the <a id="_idIndexMarker290"/>third-party application, enable the SAML authentication for Datadog if required.</li>
				<li>The authentication setting is verified based on one of the following types of user login workflow:<p><strong class="bold">Identity Provider (IdP)-initiated</strong>: In this case, the login is initiated by the identity <a id="_idIndexMarker291"/>provider, the third-party platform. With this option, a Datadog user initiates the logging process from a dashboard provided by the third party and the user is already logged into the third-party platform.</p><p><strong class="bold">Service Provider (SP)-initiated</strong>: A Datadog user will initiate the logging-in process <a id="_idIndexMarker292"/>using a Datadog URL such as <a href="https://app.datadoghq.com/account/login">https://app.datadoghq.com/account/login</a> and that will take the user to the third-party platform for authentication.</p></li>
			</ol>
			<p>Now let's see how SSO is configured with Google as the IdP provider:</p>
			<ol>
				<li value="1">Google provides steps to generate the IdP metadata for Datadog. Follow the steps available at <a href="https://support.google.com/a/answer/7553768">https://support.google.com/a/answer/7553768</a> to generate it in the Google Admin app and download the IdP metadata file.</li>
				<li>In the Datadog UI, upload the IdP metadata file from the <strong class="bold">Configure SAML</strong> page as in the following screenshot:<div id="_idContainer058" class="IMG---Figure"><img src="Images/Figure_4.10_B16483.jpg" alt="Figure 4.10 – Upload IdP metadata file&#13;&#10;" width="911" height="701"/></div><p class="figure-caption">Figure 4.10 – Upload IdP metadata file</p></li>
				<li>Once the <a id="_idIndexMarker293"/>IdP metadata file is uploaded and loaded, click the <strong class="bold">Enable</strong> button to enable SAML as in the following screenshot:<div id="_idContainer059" class="IMG---Figure"><img src="Images/Figure_4.11_B16483.jpg" alt="Figure 4.11 – Enable Single Sign-On&#13;&#10;" width="988" height="752"/></div><p class="figure-caption">Figure 4.11 – Enable Single Sign-On</p></li>
				<li>If successfully enabled in the preceding step, you will see the Single Sign-On URL that you can use <a id="_idIndexMarker294"/>to log in to Datadog. The link will take you to the SAML provider first if not logged in yet and then you will be redirected to the Datadog UI.</li>
				<li>For the preceding workflow to succeed, the user needs to be set up already in Datadog. Datadog provides an option called Just-in-Time Provisioning, which is basically the creation of users originating from the whitelisted domains. This avoids the requirement of provisioning a user explicitly in Datadog. The configuration can be done as in the following screenshot:</li>
			</ol>
			<div>
				<div id="_idContainer060" class="IMG---Figure">
					<img src="Images/Figure_4.12_B16483.jpg" alt="Figure 4.12 – Just-in-Time Provisioning&#13;&#10;" width="825" height="498"/>
				</div>
			</div>
			<p class="figure-caption">Figure 4.12 – Just-in-Time Provisioning</p>
			<p>In the preceding example, <strong class="source-inline">kurianinc.us</strong> is the domain whitelisted. Any user with that domain and <a id="_idIndexMarker295"/>authenticated by an SSO provider can access Datadog without having that user created in Datadog beforehand. The user will be created upon the first successful login.</p>
			<p>A key pair associated with a Datadog user tracks all the account and access information for that user and is an important resource for accessing Datadog programmatically. Let's see how those key pairs are managed and used in the f<a id="_idTextAnchor171"/>ollowing section.</p>
			<h1 id="_idParaDest-92"><a id="_idTextAnchor172"/>Managing API and application keys</h1>
			<p>While the users log in to the Datadog UI, using their own credentials or an SSO platform for authentication, a key pair is used for authentication in programmatic access scenarios such <a id="_idIndexMarker296"/>as publishing metrics from a program or provisioning <a id="_idIndexMarker297"/>Datadog resources using Terraform. In both cases, the processes run independently outside of the Datadog environments and access must be authenticated.</p>
			<p>The API key is associated with the organization and the application key is associated with a user account.</p>
			<p>The keys can be set up from the <strong class="bold">Integrations</strong> | <strong class="bold">APIs</strong> page:</p>
			<div>
				<div id="_idContainer061" class="IMG---Figure">
					<img src="Images/Figure_4.13_B16483.jpg" alt="Figure 4.13 – APIs page&#13;&#10;" width="1650" height="638"/>
				</div>
			</div>
			<p class="figure-caption"> </p>
			<p class="figure-caption">Figure 4.13 – APIs page</p>
			<p>Once the key <a id="_idIndexMarker298"/>pair is available, that can be used for authentication <a id="_idIndexMarker299"/>as you can see in the following Python code snippet:</p>
			<p class="source-code">from datadog import initialize, api</p>
			<p class="source-code">options = {</p>
			<p class="source-code">    'api_key': '&lt;DD_API_KEY&gt;',</p>
			<p class="source-code">    'app_key': '&lt;DD_APPLICATION_KEY&gt;'</p>
			<p class="source-code">}</p>
			<p class="source-code">initialize(**options)</p>
			<p>There are other, less-used options also available to access Datadog indirectly for information and publishing metrics:</p>
			<ul>
				<li><strong class="bold">Events API Email</strong>: On the <strong class="bold">APIs</strong> page, you <a id="_idIndexMarker300"/>can also set up an <strong class="source-inline">@dtdg.co</strong> email account to publish events by sending emails to it.</li>
				<li><strong class="bold">Client Token</strong>: A client token is used to instrument web and mobile applications <a id="_idIndexMarker301"/>for them to send logs and events to the Datadog backend. This is primarily used to gauge the last-mile user experience.</li>
			</ul>
			<p>Datadog provides various options to track your usage of the Datadog service so let's look at important features related to that in the next section.</p>
			<h1 id="_idParaDest-93"><a id="_idTextAnchor173"/>Tracking usage</h1>
			<p>Like other SaaS services, the use of Datadog tends to be elastic as it's typically deployed on infrastructure <a id="_idIndexMarker302"/>provisioned in public clouds. </p>
			<p class="callout-heading">Important note</p>
			<p class="callout">Please note that Datadog could be deployed in a classic, bare-metal environment as well, but such use cases are becoming less common.</p>
			<p>As the billing is tied to on-demand usage, it's important for an administrator to track the usage pattern:</p>
			<ol>
				<li value="1">Use the <strong class="bold">Plan &amp; Usage</strong> menu option under your user profile to get to the details of the plan you have subscribed and the usage of Datadog as a service as shown in the following screenshot:<div id="_idContainer062" class="IMG---Figure"><img src="Images/Figure_4.14_B16483.jpg" alt="Figure 4.14 – Plan &amp; Usage menu &#13;&#10;" width="297" height="568"/></div><p class="figure-caption">Figure 4.14 – Plan &amp; Usage menu </p></li>
				<li>By clicking <a id="_idIndexMarker303"/>on the <strong class="bold">Plan &amp; Usage</strong> option, you can get to the main page from where the details of the subscription plan, usage, billing, and organizations can be viewed and updated. For all the options available on that page, check the following screenshot:<div id="_idContainer063" class="IMG---Figure"><img src="Images/Figure_4.15_B16483.jpg" alt="Figure 4.15 – Plan &amp; Usage page with details of the plan&#13;&#10;" width="1022" height="563"/></div><p class="figure-caption">Figure 4.15 – Plan &amp; Usage page with details of the plan</p></li>
				<li>Under <a id="_idIndexMarker304"/>the <strong class="bold">Usage</strong> tab, the details of Datadog usage can be viewed as in the following screenshot:<div id="_idContainer064" class="IMG---Figure"><img src="Images/Figure_4.16_B16483.jpg" alt="Figure 4.16 – Usage tab on the Plan &amp; Usage page&#13;&#10;" width="1279" height="635"/></div><p class="figure-caption">Figure 4.16 – Usage tab on the Plan &amp; Usage page</p><p>From this page, you can find out how many machines Datadog has been monitoring over a specific period of time, which has a bearing on the billing. Also, you can understand how many containers Datadog has been monitoring:</p><ul><li>Under the <strong class="bold">Billing History</strong> tab, as the name suggests, the billing history and related receipts can be viewed and downloaded.</li><li>Under the <strong class="bold">Multi-Org</strong> tab, you can view aggregated usage and related trends. That would be very useful if you have partitioned your use of Datadog into multiple <a id="_idIndexMarker305"/>organizations. For example, if you navigate to <strong class="bold">Multi-Org Usage</strong> | <strong class="bold">Long-Term Trends</strong>, you can see various usage as shown in the following screenshot:</li></ul></li>
			</ol>
			<div>
				<div id="_idContainer065" class="IMG---Figure">
					<img src="Images/Figure_4.17_B16483.jpg" alt="Figure 4.17 – Overall usage trend charts under the Multi-Org tab&#13;&#10;" width="1314" height="662"/>
				</div>
			</div>
			<p class="figure-caption">Figure 4.17 – Overall usage trend charts under the Multi-Org tab</p>
			<ol>
				<li value="4">Under the <strong class="bold">Multi-Org Usage</strong> | <strong class="bold">Month-to-Date Usage</strong> tab, you can also see a summary of itemized usage per organization as in the following screenshot:</li>
			</ol>
			<div>
				<div id="_idContainer066" class="IMG---Figure">
					<img src="Images/Figure_4.18_B16483.jpg" alt="Figure 4.18 – Individual organization usage summary&#13;&#10;" width="1098" height="296"/>
				</div>
			</div>
			<p class="figure-caption">Figure 4.18 – Individual organization usage summary</p>
			<p>We have <a id="_idIndexMarker306"/>looked at multiple features and options available for managing the Datadog account set up for a company and its Datadog users, now let's look at the best practices of mana<a id="_idTextAnchor174"/>ging a Datadog account.</p>
			<h1 id="_idParaDest-94"><a id="_idTextAnchor175"/>Best practices</h1>
			<p>Here are some of the best practices related to managing accounts and users:</p>
			<ul>
				<li>Consider creating multiple organizations for isolating production monitoring from monitoring rolled out on non-production infrastructure and various monitoring environments for developing and testing new monitoring features. It will keep the production monitoring clean and safe from any inadvertent changes.</li>
				<li>Create custom user roles for use in production monitoring. Usage of predefined user roles could be more permissive than is required for the user. Always use the policy of least-needed permissions, and remember that monitoring is mostly read-only, unless automatic problem resolution is implemented.</li>
				<li>Roll out SSO for Datadog users to log in.</li>
				<li>Use major programmatic access authenticated using a service account and not a real user, as real users could leave the company and the deletion of user keys c<a id="_idTextAnchor176"/>an break your programs.</li>
			</ul>
			<h1 id="_idParaDest-95"><a id="_idTextAnchor177"/>Summary</h1>
			<p>Account and user management is an administrative task and regular users will not get into it except for tasks such as creating application keys. The multi-organizations feature can be used to partition the account into logical units, and we looked at sample scenarios where they are useful. Datadog supports industry-standard SSO options using SAML and we learned how to implement those. There are multiple methods available for programmatic access and the primary mechanism is using a key pair, and we went over the steps for generating them. Fine-grained access to Datadog for a user can be implemented using custom user roles and we learned the steps to configure those for a user.</p>
			<p>This is the last chapter in the first part of the book, which provided an overview of monitoring in general and an introduction to Datadog and getting started with it in particular. In the subsequent parts and chapters of the book, we will discuss how monitoring features are implemented and used in Datadog in detail. In the next chapter, we will learn more about metrics, events, and tags – three important concepts that Datadog heavily depends on.</p>
		</div>
	</div></body></html>