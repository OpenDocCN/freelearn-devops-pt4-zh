- en: '*Chapter 6*: Monitoring Infrastructure'
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: In the previous chapter, we learned about events that occur in a software system
    that are useful for monitoring purposes and how they are handled in Datadog. The
    metrics and events, when combined with tags, provide Datadog users with a rich
    set of data and the means to group and filter that information for multiple monitoring
    requirements.
  prefs: []
  type: TYPE_NORMAL
- en: 'In [*Chapter 1*](B16483_01_Final_VK_ePub.xhtml#_idTextAnchor014), *Introduction
    to Monitoring*, we looked at different types of monitoring that make up a comprehensive,
    proactive monitoring process. One of the basic types of monitoring is infrastructure
    monitoring, which is all about monitoring the compute, storage, and network infrastructure
    where the application system runs. All major monitoring applications offer infrastructure
    monitoring features out of the box. And at times, in many organizations, the scope
    of monitoring is limited to this type of monitoring. Datadog provides excellent
    support for infrastructure monitoring and we will learn about that in this chapter.
    We will look at the following topics specifically:'
  prefs: []
  type: TYPE_NORMAL
- en: Inventorying the hosts
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Listing containers
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Viewing system processes
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Monitoring serverless computing resources
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Technical requirements
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'To try out the examples mentioned in this book, you need to have the following
    tools installed and resources available:'
  prefs: []
  type: TYPE_NORMAL
- en: A Datadog account and a user with admin-level access.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: A Datadog Agent running at host level or as a microservice depending on the
    example, pointing to the Datadog account.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Inventorying the hosts
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'There are two interfaces available in Datadog that provide a list of hosts:
    **Host Map** and **Infrastructure List**. Each host listed on these interfaces
    will have a Datadog agent running on it. The host could be a bare-metal machine
    or a **virtual machine** (**VM**) that has been provisioned in a public cloud
    service such as AWS or Azure.'
  prefs: []
  type: TYPE_NORMAL
- en: 'Let''s look at the **Host Map** feature first. To access that interface, navigate
    to **Infrastructure** | **Host Map** on Datadog''s dashboard. You will see a dashboard
    similar to the following:'
  prefs: []
  type: TYPE_NORMAL
- en: '![Figure 6.1 – Sample host map'
  prefs: []
  type: TYPE_NORMAL
- en: '](img/Figure_6.1_B16483.jpg)'
  prefs: []
  type: TYPE_NORMAL
- en: Figure 6.1 – Sample host map
  prefs: []
  type: TYPE_NORMAL
- en: Each hexagonal shape on the dashboard represents a host in the infrastructure
    monitored by Datadog. The CPU utilization (in percent) of a host is color coded,
    with less usage represented by green and higher usage represented by orange. The
    legend at the bottom-right corner of the dashboard provides details about the
    color coding being used. The gear button provided with the legend can be used
    to customize this color coding to your preference.
  prefs: []
  type: TYPE_NORMAL
- en: 'The size of the hexagon can be tied to the value of a metric. At this point,
    the size of a hexagon pertaining to a host will be proportional to the value of
    the metric reported by that host. To use the *percentage CPU utilized for sizing*
    metric in the hexagons in the host map, select that metric from the **Fill by
    and Size by** dropdowns at the top-right end of the dashboard. The resulting host
    map will look as follows:'
  prefs: []
  type: TYPE_NORMAL
- en: '![Figure 6.2 – Host Map with size option used'
  prefs: []
  type: TYPE_NORMAL
- en: '](img/Figure_6.2_B16483.jpg)'
  prefs: []
  type: TYPE_NORMAL
- en: Figure 6.2 – Host Map with size option used
  prefs: []
  type: TYPE_NORMAL
- en: As you can see, the hexagons are smaller for those hosts with lower percentage
    CPU utilization. Any other metric that is published by the hosts can be used for
    this purpose.
  prefs: []
  type: TYPE_NORMAL
- en: The hosts listed on the **Host Map** dashboard can be filtered and grouped by
    available tags. Searching for a specific set of hosts using tags is useful in
    general. For example, while troubleshooting issues, narrowing down the search
    to a few hosts would be convenient if there are hundreds of hosts in the infrastructure.
  prefs: []
  type: TYPE_NORMAL
- en: Let's take a look at the options that are available for filtering hosts using
    tags.
  prefs: []
  type: TYPE_NORMAL
- en: 'By choosing one or more tags in the **Filter by** field, only the related hosts
    will be listed, as shown in the following screenshot:'
  prefs: []
  type: TYPE_NORMAL
- en: '![Figure 6.3 – Host Map with a filter enabled'
  prefs: []
  type: TYPE_NORMAL
- en: '](img/Figure_6.3_B16483.jpg)'
  prefs: []
  type: TYPE_NORMAL
- en: Figure 6.3 – Host Map with a filter enabled
  prefs: []
  type: TYPE_NORMAL
- en: In this case, the `metadata_platform:linux` tag is used as the filter to view
    only the Linux hosts.
  prefs: []
  type: TYPE_NORMAL
- en: 'By selecting one or more tags in the **Group hosts by tags** field, the hosts
    can be listed in clusters on the **Host Map** dashboard, as shown in the following
    screenshot:'
  prefs: []
  type: TYPE_NORMAL
- en: '![Figure 6.4 – Host Map with hosts grouped'
  prefs: []
  type: TYPE_NORMAL
- en: '](img/Figure_6.4_B16483.jpg)'
  prefs: []
  type: TYPE_NORMAL
- en: Figure 6.4 – Host Map with hosts grouped
  prefs: []
  type: TYPE_NORMAL
- en: In this case, the tag that was selected to group the hosts is `metadata_platform`.
    Here, we can see that the five Linux hosts are grouped together and that the lone
    Mac (**darwin**) host is shown separately from the Linux group.
  prefs: []
  type: TYPE_NORMAL
- en: Important note
  prefs: []
  type: TYPE_NORMAL
- en: The **Group hosts by tags** option only uses the key of a tag, but the **Filter
    by** option requires its value also.
  prefs: []
  type: TYPE_NORMAL
- en: 'You have already seen that there are multiple ways to list and locate a host
    on the **Host Map** dashboard. If you would like to look at a specific host, you
    can click on it, which will provide you with a zoomed-in version of it in another
    window containing host-specific details:'
  prefs: []
  type: TYPE_NORMAL
- en: '![Figure 6.5 – Host Map with host details zoomed in'
  prefs: []
  type: TYPE_NORMAL
- en: '](img/Figure_6.5_B16483.jpg)'
  prefs: []
  type: TYPE_NORMAL
- en: Figure 6.5 – Host Map with host details zoomed in
  prefs: []
  type: TYPE_NORMAL
- en: This interface provides host-level information and links to related resources
    so that you can gather all the details of the host, both when static and at runtime.
  prefs: []
  type: TYPE_NORMAL
- en: 'The details of the following resources can be looked up from the host dashboard:'
  prefs: []
  type: TYPE_NORMAL
- en: '**Apps**: The links to details about the integrations that have been implemented
    for this host are listed in the hexagonal shape.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Agent**: The version of the agent.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**System**: The operating system-level details are provided here, which can
    be drilled down into multiple levels.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Container**: If containers are running on the host, the related information
    will be available here.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Metrics**: Host-level metrics that were published recently are listed here.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '`host` tag pointing to the name of the host is available by default, more `host`-level
    tags can be set using the `tags` option in the Datadog agent configuration file.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'At the top of this interface, the host name and host aliases are provided.
    Also, links to the following dashboards with some relation to the host are available
    at the same location:'
  prefs: []
  type: TYPE_NORMAL
- en: '**Dashboard**: This is a dashboard that''s specific to the host with charts
    on important host-level metrics. We will look at this dashboard soon.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Networks**: The dashboard for **Network Performance Monitoring**. This feature
    needs to be enabled in the Datadog agent for this to be available.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Processes**: If the Live Processes feature is enabled from the Datadog agent,
    this dashboard will be populated with details about the processes running on the
    host. We will look at it in detail in the *System processes* section.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Containers**: This link will lead you to the dashboard where containers running
    on the host are listed.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Now, let's look at some of these detailed dashboards that we can access from
    the **Host Map** zoom-in window.
  prefs: []
  type: TYPE_NORMAL
- en: 'By navigating to **Apps** | **Agent**, you can pull up a dashboard with Datadog
    agent-specific metrics listed, as shown in the following screenshot:'
  prefs: []
  type: TYPE_NORMAL
- en: '![Figure 6.6– Datadog agent-specific metrics'
  prefs: []
  type: TYPE_NORMAL
- en: '](img/Figure_6.6_B16483.jpg)'
  prefs: []
  type: TYPE_NORMAL
- en: Figure 6.6– Datadog agent-specific metrics
  prefs: []
  type: TYPE_NORMAL
- en: The **datadog_agent.** category of metrics is not directly useful for monitoring
    the application system, but it can provide insights into how well the Datadog
    agent runs on that specific host.
  prefs: []
  type: TYPE_NORMAL
- en: 'By navigating to **Apps** | **system**, you will see a dashboard containing
    charts about the core infrastructure metrics for the host, such as CPU usage,
    load averages, disk usage and latency, memory availability and usage, and network
    traffic. The following screenshot provides such a sample dashboard:'
  prefs: []
  type: TYPE_NORMAL
- en: '![Figure 6.7 – Host dashboard with system metrics'
  prefs: []
  type: TYPE_NORMAL
- en: '](img/Figure_6.7_B16483.jpg)'
  prefs: []
  type: TYPE_NORMAL
- en: Figure 6.7 – Host dashboard with system metrics
  prefs: []
  type: TYPE_NORMAL
- en: 'We have already seen that the block-links listed under the **Apps** section
    in *Figure 6.5* are related to integrations running on that host. Besides the
    common links such as **agent** and **system** that we have just looked at, the
    rest of the links will depend on what integrations are enabled on the host. For
    example, in *Figure 6.5*, there was **docker** and **redisdb**, which were enabled
    explicitly. By clicking on **docker**, a dashboard with charts for Docker-specific
    metrics can be pulled up, as shown in the following screenshot:'
  prefs: []
  type: TYPE_NORMAL
- en: '![Figure 6.8 – Dashboard for Docker metrics'
  prefs: []
  type: TYPE_NORMAL
- en: '](img/Figure_6.8_B16483.jpg)'
  prefs: []
  type: TYPE_NORMAL
- en: Figure 6.8 – Dashboard for Docker metrics
  prefs: []
  type: TYPE_NORMAL
- en: By navigating to **Apps** | **system**, we can see how a dashboard with system-level
    metrics for the host can be viewed, as illustrated in *Figure 6.7*.
  prefs: []
  type: TYPE_NORMAL
- en: The system metrics can be looked up in a much better fashion by clicking the
    **View host in:** | **Dashboard** link from the host zoom-in window. This dashboard
    provides charts for each category of system metrics that are useful in inspecting
    the metrics for a time range. Let's look at which of these systems metrics make
    up the core of infrastructure monitoring.
  prefs: []
  type: TYPE_NORMAL
- en: For each category of system metrics, a widget is available on the host dashboard
    with related metrics charted. Using the menu options available in the top-right
    corner, it's possible to drill down further into these widgets.
  prefs: []
  type: TYPE_NORMAL
- en: 'By clicking on the left button, the widget can be viewed in full-screen mode
    with more options. The middle button pulls up a menu with options that are related
    to managing the chart. The right button provides details on the metrics that are
    being used on the chart. A screenshot of these menus, with the middle button highlighted,
    is as follows:'
  prefs: []
  type: TYPE_NORMAL
- en: '![Figure 6.9 – Widget common menu options'
  prefs: []
  type: TYPE_NORMAL
- en: '](img/Figure_6.9_B16483.jpg)'
  prefs: []
  type: TYPE_NORMAL
- en: Figure 6.9 – Widget common menu options
  prefs: []
  type: TYPE_NORMAL
- en: Now, let's take a look at the main widgets available on the host dashboard.
  prefs: []
  type: TYPE_NORMAL
- en: CPU usage
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: 'By hovering over the **CPU usage** chart, the related metrics can be displayed
    on the dashboard, as shown in the following screenshot:'
  prefs: []
  type: TYPE_NORMAL
- en: '![Figure 6.10 – CPU usage metrics'
  prefs: []
  type: TYPE_NORMAL
- en: '](img/Figure_6.10_B16483.jpg)'
  prefs: []
  type: TYPE_NORMAL
- en: Figure 6.10 – CPU usage metrics
  prefs: []
  type: TYPE_NORMAL
- en: 'These are the main CPU usage-related metrics and their meanings:'
  prefs: []
  type: TYPE_NORMAL
- en: '`system.cpu.idle`: The percentage of time the CPU spent in an idle state.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '`system.cpu.system`: The percentage of time the CPU spent running the kernel.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '`system.cpu.iowait`: The percentage of time the CPU spent waiting for the I/O
    operations to finish.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '`system.cpu.user`: The percentage of time the CPU spent running the processes
    in the user space.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: By tracking these metrics, you will get an overall picture of the CPU usage
    on the host and by building monitors around those, the tracking of these metrics
    could be made automated.
  prefs: []
  type: TYPE_NORMAL
- en: Load averages
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: 'The load on a host that runs some UNIX-based operating system such as Linux
    or macOS is measured in terms of the number of concurrent processes running on
    it. Usually, the load is tracked as the average of that measurement over the last
    1 minute, 5 minutes, and 15 minutes. That''s why a UNIX command such as `uptime`
    returns three measurements for load averages, as shown in the following example:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE0]'
  prefs: []
  type: TYPE_PRE
- en: 'The load averages data for the host are plotted on the **Load Averages** chart
    on the **host** dashboard, as shown in the following screenshot:'
  prefs: []
  type: TYPE_NORMAL
- en: '![Figure 6.11 – Load Averages chart on the host dashboard'
  prefs: []
  type: TYPE_NORMAL
- en: '](img/Figure_6.11_B16483.jpg)'
  prefs: []
  type: TYPE_NORMAL
- en: Figure 6.11 – Load Averages chart on the host dashboard
  prefs: []
  type: TYPE_NORMAL
- en: 'By hovering over the chart, the averages for 1-minute, 5-minute and 15-minute
    loads can be displayed, as shown in the preceding screenshot. The important metrics
    in this category are the following, all of which have self-documented names:'
  prefs: []
  type: TYPE_NORMAL
- en: '`System.load.1`: Average load in the last 1 minute'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '`System.load.5`: Average load in the last 5 minutes'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '`System.load.15`: Average load in the last 15 minutes'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: In this section, we looked at system load-related metrics. Now, let's look swap
    memory metrics.
  prefs: []
  type: TYPE_NORMAL
- en: Available swap
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: 'Swap space on a Linux host allows the inactive pages in memory to be moved
    to disk to make room in the RAM. The following system metrics are plotted on this
    chart on the host dashboard:'
  prefs: []
  type: TYPE_NORMAL
- en: '`system.swap.free`: The size of the free swap space in bytes'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '`system.swap.used`: The size of the swap space used in bytes'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'The swap memory metrics can be viewed on the dashboard, as shown in the following
    screenshot:'
  prefs: []
  type: TYPE_NORMAL
- en: '![Figure 6.12 – Available swap'
  prefs: []
  type: TYPE_NORMAL
- en: '](img/Figure_6.12_B16483.jpg)'
  prefs: []
  type: TYPE_NORMAL
- en: Figure 6.12 – Available swap
  prefs: []
  type: TYPE_NORMAL
- en: There are more swap-related metrics that are published by Datadog besides those
    being used on this chart, and they could be used on custom charts and monitors
    as well.
  prefs: []
  type: TYPE_NORMAL
- en: Disk latency
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: 'The disk latency of a storage device is determined by the delay in getting
    an I/O request processed, and that also includes the waiting time in the queue.
    This is tracked by the `system.io.await` metric:'
  prefs: []
  type: TYPE_NORMAL
- en: '![Figure 6.13 – Disk latency widget in full-screen mode'
  prefs: []
  type: TYPE_NORMAL
- en: '](img/Figure_6.13_B16483.jpg)'
  prefs: []
  type: TYPE_NORMAL
- en: Figure 6.13 – Disk latency widget in full-screen mode
  prefs: []
  type: TYPE_NORMAL
- en: This metric value is reported for each storage device on the host. In the preceding
    screenshot, a sample view of this widget has been provided in full-screen mode.
  prefs: []
  type: TYPE_NORMAL
- en: Memory breakdown
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: 'Though Datadog publishes a large set of metrics related to the available memory
    and its usage on the host, this widget charts only two metrics: `system.memory.usable`
    and a diff of `system.memory.total` and `system.memory.usable`, which provides
    an estimate of the reserved memory:'
  prefs: []
  type: TYPE_NORMAL
- en: '![Figure 6.14 – Memory breakdown widget in full-screen view'
  prefs: []
  type: TYPE_NORMAL
- en: '](img/Figure_6.14_B16483.jpg)'
  prefs: []
  type: TYPE_NORMAL
- en: Figure 6.14 – Memory breakdown widget in full-screen view
  prefs: []
  type: TYPE_NORMAL
- en: 'These are static metrics and don''t provide any information on the dynamic
    usage of memory on the host. Now, let''s look at some of the important metrics
    from this category:'
  prefs: []
  type: TYPE_NORMAL
- en: '`system.mem.cached`: The amount of RAM used for the cache in bytes'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '`system.mem.free`: The amount of RAM free in bytes'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '`system.mem.paged`: The amount of physical memory used for paging in bytes'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '`system.mem.used`: The amount of RAM being used in bytes'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: In this section, we have looked at important memory-related metrics. In the
    next section, we'll look at how disk storage usage can be monitored using the
    related metrics.
  prefs: []
  type: TYPE_NORMAL
- en: Disk usage
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: 'Tracking the use of storage on disks attached to a host is one of the most
    common aspects of infrastructure monitoring. This widget charts the disk usage
    for every device by using the `system.disk.in_use` metric, which is the amount
    of disk space that''s being used as a fraction of the total available on the device:'
  prefs: []
  type: TYPE_NORMAL
- en: '![Figure 6.15 – Disk usage widget'
  prefs: []
  type: TYPE_NORMAL
- en: '](img/Figure_6.15_B16483.jpg)'
  prefs: []
  type: TYPE_NORMAL
- en: Figure 6.15 – Disk usage widget
  prefs: []
  type: TYPE_NORMAL
- en: 'There are several disk-related metrics that are published by Datadog. The important
    ones are as follows:'
  prefs: []
  type: TYPE_NORMAL
- en: '`system.disk.free`: The amount of disk space that''s free on the device in
    bytes'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '`system.disk.total`: The total amount of disk space on the device in bytes'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '`system.disk.used`: The amount of disk space being used on the device in bytes'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '`system.fs.inodes.free`: The number of `inodes` free on the device'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '`system.fs.inodes.total`: The total number of `inodes` on the device'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '`system.fs.inodes.used`: The number of `inodes` being used on the device'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '`system.fs.inodes.in_use`: The number of `inodes` being used as a fraction
    of the total available on the device'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: In this section, we looked at various metrics that help us monitor storage disk
    usage. In the next section, we'll review the metrics available for monitoring
    network traffic.
  prefs: []
  type: TYPE_NORMAL
- en: Network traffic
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: 'The inbound and outbound network traffic on the host is tracked by the `system.net.bytes_rcvd`
    and `system.net.bytes_sent` metrics, respectively. The following screenshot shows
    the network traffic widget that''s available on the **host** dashboard:'
  prefs: []
  type: TYPE_NORMAL
- en: '![Figure 6.16 – Network traffic widget in full-screen mode'
  prefs: []
  type: TYPE_NORMAL
- en: '](img/Figure_6.16_B16483.jpg)'
  prefs: []
  type: TYPE_NORMAL
- en: Figure 6.16 – Network traffic widget in full-screen mode
  prefs: []
  type: TYPE_NORMAL
- en: As with other categories of system metrics, there are several network-related
    metrics that are published by Datadog, and they are available for use with charts
    and monitors. The full list of network metrics can be referenced at [https://docs.datadoghq.com/integrations/network/](https://docs.datadoghq.com/integrations/network/).
  prefs: []
  type: TYPE_NORMAL
- en: Thus far, we have been looking at the many options that you can use to drill
    down into the status of various components of a host, starting with the **Host
    Map** interface. The list of hosts can be viewed using the Infrastructure List
    interface, which can be accessed by navigating to **Infrastructure** | **Infrastructure
    List** on the Datadog dashboard.
  prefs: []
  type: TYPE_NORMAL
- en: 'The following screenshot provides a sample of the **Infrastructure List** interface:'
  prefs: []
  type: TYPE_NORMAL
- en: '![Figure 6.17 – Sample Infrastructure List interface'
  prefs: []
  type: TYPE_NORMAL
- en: '](img/Figure_6.17_B16483.jpg)'
  prefs: []
  type: TYPE_NORMAL
- en: Figure 6.17 – Sample Infrastructure List interface
  prefs: []
  type: TYPE_NORMAL
- en: Compared to Host Map, the Infrastructure List is a much simpler interface and
    lists the hosts in a tabular form. Clicking on a specific host will take you to
    the host dashboard, which we discussed extensively earlier in this section.
  prefs: []
  type: TYPE_NORMAL
- en: While hosts, both bare-metal and VMs, used to be the building blocks of infrastructure
    that hosted application systems, continuing to deploy applications as microservices
    means that containers are important building blocks of the infrastructure as well.
  prefs: []
  type: TYPE_NORMAL
- en: In the next section, we will see how Datadog can help you monitor containers
    running in your environment.
  prefs: []
  type: TYPE_NORMAL
- en: Listing containers
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: A microservice is deployed using one or more containers running on different
    hosts. If a Datadog agent runs on those hosts and it's been configured to detect
    those containers, Datadog will list them on the **Containers** dashboard. The
    Datadog agent configuration changes that are needed for discovering containers
    running on a host were discussed in [*Chapter 2*](B16483_02_Final_VK_ePub.xhtml#_idTextAnchor115),
    *Deploying a Datadog Agent*.
  prefs: []
  type: TYPE_NORMAL
- en: 'To get to the **Containers** dashboard, you can navigate to **Infrastructure**
    | **Containers**. From there, you will be able to see the dashboard shown in the
    following screenshot:'
  prefs: []
  type: TYPE_NORMAL
- en: '![Figure 6.18 – Containers dashboard'
  prefs: []
  type: TYPE_NORMAL
- en: '](img/Figure_6.18_B16483.jpg)'
  prefs: []
  type: TYPE_NORMAL
- en: Figure 6.18 – Containers dashboard
  prefs: []
  type: TYPE_NORMAL
- en: 'All the containers the Datadog agent discovers on the hosts are listed on this
    dashboard. Under the **Host** section on the left pane, the container hosts are
    listed. By selecting a specific host from that list, only the containers running
    on that host can be displayed on the dashboard:'
  prefs: []
  type: TYPE_NORMAL
- en: '![Figure 6.19 – Details of a NGINX container'
  prefs: []
  type: TYPE_NORMAL
- en: '](img/Figure_6.19_B16483.jpg)'
  prefs: []
  type: TYPE_NORMAL
- en: Figure 6.19 – Details of a NGINX container
  prefs: []
  type: TYPE_NORMAL
- en: Clicking on a container listing will take you to a detailed interface where
    the runtime details of the container such as the host name, the Docker image used
    to create the container, and the Datadog tags on the container are provided. The
    preceding screenshot shows the details of a sample container.
  prefs: []
  type: TYPE_NORMAL
- en: Looking at the processes that are running on a host is one of the basic system
    administrative tasks related to deploying an application, getting that application
    to work correctly, or checking on the health of the host in general. Datadog makes
    this easier to do. We'll look at this feature in the next section.
  prefs: []
  type: TYPE_NORMAL
- en: Viewing system processes
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: The traditional method of viewing processes running on a host is logging into
    that machine and listing the processes using commands such as `ps` on a UNIX-like
    operating system. In an environment where more elastic and immutable infrastructure
    is preferred, such manual steps are either not preferred or discouraged. In such
    situations, the option of viewing the processes running on the hosts is very useful.
    Also, having the processes listed in one place makes comparing the runtime environments
    of two or more hosts easier.
  prefs: []
  type: TYPE_NORMAL
- en: 'To get to the **Processes** dashboard, navigate to **Infrastructure** | **Processes**
    on the Datadog dashboard. You will see an interface similar to the one shown in
    the following screenshot:'
  prefs: []
  type: TYPE_NORMAL
- en: '![Figure 6.20 – List of processes'
  prefs: []
  type: TYPE_NORMAL
- en: '](img/Figure_6.20_B16483.jpg)'
  prefs: []
  type: TYPE_NORMAL
- en: Figure 6.20 – List of processes
  prefs: []
  type: TYPE_NORMAL
- en: 'This dashboard is similar to what we saw regarding the **Containers** dashboard
    in the previous section. On the left pane, there are search and filter options
    that you can use to locate the processes that you need to drill into. By clicking
    on a process listing, you can look at its details, as shown in the following screenshot:'
  prefs: []
  type: TYPE_NORMAL
- en: '![Figure 6.21 – Process details'
  prefs: []
  type: TYPE_NORMAL
- en: '](img/Figure_6.21_B16483.jpg)'
  prefs: []
  type: TYPE_NORMAL
- en: Figure 6.21 – Process details
  prefs: []
  type: TYPE_NORMAL
- en: 'Information about a process such as its name, **process ID** (**PID**), and
    the user who started the process are available on the details page. The process
    details provided in this example can be queried directly on the host like so:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE1]'
  prefs: []
  type: TYPE_PRE
- en: 'The processes running on a host are not reported by the Datadog agent by default,
    so you need to enable that feature. To do that, add the following option to the
    `datadog-agent.yml` Datadog agent configuration file and restart the agent service:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE2]'
  prefs: []
  type: TYPE_PRE
- en: Usually, this configuration option is available but commented out in the agent
    configuration file, so you just need to uncomment these lines before restarting
    the agent.
  prefs: []
  type: TYPE_NORMAL
- en: Thus far, we've mentioned real and virtual machines and containers as the building
    blocks of infrastructure. In the next section, we will see how Datadog can help
    with monitoring a serverless computing environment.
  prefs: []
  type: TYPE_NORMAL
- en: Monitoring serverless computing resources
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: The current trend is to avoid infrastructure of any kind altogether and move
    to a serverless computing environment, in which case the public cloud vendors
    provide the platform to create, run, and monitor the applications. Let's not get
    confused with any hosting services in the cloud. There is no concept of a host
    (and hence the name serverless); instead, the applications are run in computing
    sandboxes provided by the cloud provider.
  prefs: []
  type: TYPE_NORMAL
- en: One of the most popular serverless computing services is AWS Lambda. A Lambda
    function runs application code and, practically, you can consider it the equivalent
    of a microservice. By installing AWS integration and some additional configurations
    specific to Lambda, the Lambda functions can be monitored from Datadog.
  prefs: []
  type: TYPE_NORMAL
- en: 'The following steps outline the process of setting up Datadog to monitor Lambda
    functions:'
  prefs: []
  type: TYPE_NORMAL
- en: Install the AWS integration in Datadog.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Install the Datadog Forwarder Lambda function on your AWS account.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Instrument the Lambda functions if any application monitoring-related information
    needs to be published to Datadog.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: The detailed steps to do this configuration are available at [https://docs.datadoghq.com/serverless/](https://docs.datadoghq.com/serverless/).
  prefs: []
  type: TYPE_NORMAL
- en: 'Navigate to **Infrastructure** | **Serverless** to get to the Serverless dashboard,
    which is where all the **Lambda** functions are monitored, as shown in the following
    screenshot:'
  prefs: []
  type: TYPE_NORMAL
- en: '![Figure 6.22 – AWS Lambda functions for serverless computing'
  prefs: []
  type: TYPE_NORMAL
- en: '](img/Figure_6.22_B16483.jpg)'
  prefs: []
  type: TYPE_NORMAL
- en: Figure 6.22 – AWS Lambda functions for serverless computing
  prefs: []
  type: TYPE_NORMAL
- en: Note that no traditional agent is needed in this situation, but the Lambda function
    known as **Datadog Forwarder** does that job for Lambda-based serverless computing.
  prefs: []
  type: TYPE_NORMAL
- en: Best practices
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'These are the best practices that should be followed for monitoring infrastructure:'
  prefs: []
  type: TYPE_NORMAL
- en: Datadog provides lots of metrics that cover various aspects of compute, storage,
    and network monitoring out of the box. Make sure that you only focus on the important
    metrics from each category.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Containers are becoming core constructs of the infrastructure that hosts modern
    applications. If microservices are used, it is important to monitor the containers
    and obtain insights that could be used to fine-tune the performance and availability
    of applications.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Aggregating the processes would make it easy to compare runtime environments,
    and that feature must be enabled.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Though there is no infrastructure to manage in serverless computing, Datadog
    provides options for monitoring the application functions that should be enabled
    for tracking the related metrics.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Summary
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: In a traditional computing scenario where hosts are involved, infrastructure
    monitoring is the core of monitoring. Hosts include both bare-metal and virtual
    machines. With the increased use of microservices to deploy applications, the
    container has become an important element in building infrastructure. Datadog
    provides features that support both host- and container-level monitoring. The
    Datadog feature of aggregating processes from the hosts makes comparing runtime
    environments at the host level easy. Though no infrastructure is involved, Datadog
    can be used to monitor serverless computing resources such as AWS Lambda functions.
    In this chapter, you learned how various components of the infrastructure that
    run a software application system are monitored using Datadog. These infrastructure
    components could be in traditional data centers or public clouds, and they could
    be virtual machines or containers.
  prefs: []
  type: TYPE_NORMAL
- en: Though useful metrics can be published to Datadog or generated by it, if you
    do not use monitors and alerts, they are not very useful. In the next chapter,
    we will learn how monitors and alerts are set up in Datadog.
  prefs: []
  type: TYPE_NORMAL
