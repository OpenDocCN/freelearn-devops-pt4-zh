<html><head></head><body>
        <section>

                            <header>
                    </header><h1 class="header-title" id="calibre_pb_0">Salt - Using Salt to Provision a Vagrant Box</h1>
                
            
            <article>
                
<p class="calibre2">You've reached the final chapter of the book, and our provisioning miniseries. In this chapter, we'll learn more about the Salt provisioner that can be used with Vagrant. At the end of this chapter, you will have a good understanding of how to use Salt to provision Vagrant and know more about Salt as a standalone piece of configuration-management software. We'll learn about Salt and how it works.</p>
<p class="calibre2">Specifically, we'll cover the following topics:</p>
<ul class="calibre10">
<li class="calibre11">Understanding Salt</li>
<li class="calibre11">Salt states</li>
<li class="calibre11">The syntax of Salt states</li>
<li class="calibre11">Provisioning a Vagrant machine with Salt</li>
<li class="calibre11">Vagrantfile options available when using Salt</li>
</ul>


            </article>

            
        </section>
    

        <section>

                            <header>
                    </header><h1 class="header-title" id="calibre_pb_0">Understanding Salt</h1>
                
            
            <article>
                
<p class="calibre2">Salt is another member of the provisioning and infrastructure as code family. It can be compared directly to Chef, Ansible, and Puppet. It's written in the Python language and was first released in March 2011.</p>
<p class="calibre2">Salt can sometimes be referred to as the SaltStack platform. This is due to the modular approach in which the software has been designed and built. It's extensible, flexible approach allows you to add and remove modules.</p>
<p class="calibre2">Salt has one main setup—the client and server. You can think of it as a Puppet Master and Minion setup. Salt uses a server (Master) and client (Minion) for its configuration management. The other setup option that Salt supports is called <strong class="calibre4">Masterless</strong>,</p>
<p class="calibre2"/>


            </article>

            
        </section>
    

        <section>

                            <header>
                    </header><h1 class="header-title" id="calibre_pb_0">Salt Master</h1>
                
            
            <article>
                
<p class="calibre2">A Salt Master is used to manage the infrastructure and the servers within it. It can run remote execution commands onto Minion servers and manage their state. It also can operate in a Master-tiered setup where commands can be passed down through lower Master servers. The Salt Master manages Salt Minions and is used to capture grains sent from the Minions. It can then use the grain data to decide how to manage that specific Minion. It runs a daemon called <kbd class="calibre12">salt-master</kbd>.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    </header><h1 class="header-title" id="calibre_pb_0">Salt Minion</h1>
                
            
            <article>
                
<p class="calibre2">A Salt Minion is a server/machine often controlled by the Salt Master. A Minion can run in a <kbd class="calibre12">masterless</kbd> setup too. A Salt Minion runs a daemon called <kbd class="calibre12">salt-minion</kbd> and its main purpose is to run commands sent from the Master, report data back, and send information about itself in the form of <strong class="calibre4">grains</strong>.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    </header><h1 class="header-title" id="calibre_pb_0">Modules</h1>
                
            
            <article>
                
<p class="calibre2">There are six different modules available in Salt. Each type of module offers a different action or function. We'll learn more about each here.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    </header><h1 class="header-title" id="calibre_pb_0">Execution</h1>
                
            
            <article>
                
<p class="calibre2">You can think of execution modules as <kbd class="calibre12">ad hoc</kbd> commands. These commands are run on the Minion (command line) machines/nodes. They are written using Python/Cython.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    </header><h1 class="header-title" id="calibre_pb_0">State</h1>
                
            
            <article>
                
<p class="calibre2">States are a core part of configuration management in Salt. A state is a file that configures and describes what state a machine should be in. This is very similar to the Puppet manifests that describe the desired state of the machine.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    </header><h1 class="header-title" id="calibre_pb_0">Grains</h1>
                
            
            <article>
                
<p class="calibre2">Grains are pieces of static information about the Minion. This information includes core details about the Minion, such as operating system, model, memory, and other data that is gathered and sent to the Master upon the initial connection. This can help the Master target different groups of Minions, such as targeting a specific operating system.</p>
<p class="calibre2"/>


            </article>

            
        </section>
    

        <section>

                            <header>
                    </header><h1 class="header-title" id="calibre_pb_0">Renderer</h1>
                
            
            <article>
                
<p class="calibre2">A renderer in Salt is used to transform data types described in <strong class="calibre4">SaLt State files</strong> (<strong class="calibre4">SLS</strong>) into Python to be consumed and handled by Salt. A common example is an SLS file rendered into a Jinja template and then parsed as a YAML document. There are a few different combinations currently supported:</p>
<ul class="calibre10">
<li class="calibre11">Jinja and YAML</li>
<li class="calibre11">Mako and YAML</li>
<li class="calibre11">Wempy and YAML</li>
<li class="calibre11">Jinja and JSON</li>
<li class="calibre11">Mako and JSON</li>
<li class="calibre11">Wempy and JSON</li>
</ul>


            </article>

            
        </section>
    

        <section>

                            <header>
                    </header><h1 class="header-title" id="calibre_pb_0">Returners</h1>
                
            
            <article>
                
<p class="calibre2">In Salt, a returner is used to handle and output from a command run on a Minion machine. The output/results data is always sent back to the Master but using a returner allows you to decide where that data goes. You can choose any service that can receive data, such as Redis or MySQL. This data can be used for analysis or archiving. It can give you better insights into what's happening on the Minions and which commands are performing best.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    </header><h1 class="header-title" id="calibre_pb_0">Runners</h1>
                
            
            <article>
                
<p class="calibre2">A Salt runner is very similar to an execution module. The one difference is that a runner is a command run and is executed on the Master server. <span class="calibre6">A runner can be as simple or as complex as you like. They can be run using the </span><kbd class="calibre12">salt-run</kbd><span class="calibre6"> command.</span></p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    </header><h1 class="header-title" id="calibre_pb_0">Salt states</h1>
                
            
            <article>
                
<p class="calibre2">Salt states are also known as state modules. They make up an important part of the state system used within Salt. A Salt state is used to describe what packages should be installed on the Minion and other options such as user accounts, running services, and folder permissions. We'll look at the Salt state syntax now.</p>
<p class="calibre2"/>


            </article>

            
        </section>
    

        <section>

                            <header>
                    </header><h1 class="header-title" id="calibre_pb_0">Syntax and example</h1>
                
            
            <article>
                
<p class="calibre2"><span class="calibre6">A Salt state file can often be found in the <kbd class="calibre12">roots</kbd> directory. It employs the <kbd class="calibre12">.sls</kbd> file extension and uses the <strong class="calibre4">Yet Another Markup Language</strong> (<strong class="calibre4">YAML</strong>) format for its contents. There is a certain hierarchy within a salt state file and that can go quite deep, depending on your requirements and configuration.</span></p>
<p class="calibre2">Let's break down an example Salt state file:</p>
<pre class="calibre17">lampstack:<br class="title-page-name"/>     pkg.installed:<br class="title-page-name"/>         - pkgs:<br class="title-page-name"/>         - mysql-server<br class="title-page-name"/>         - php5<br class="title-page-name"/>         - php-pear<br class="title-page-name"/>         - php5-mysql</pre>
<p class="calibre2">We first set a name for this section, in this example it's called <kbd class="calibre12">lampstack</kbd>. We then call <kbd class="calibre12">pkg.installed</kbd>, which verifies that certain packages have been installed. We use the <kbd class="calibre12">- pkgs</kbd> option and set the <kbd class="calibre12">- mysql-server</kbd>, <kbd class="calibre12">- php5</kbd>, <kbd class="calibre12">- php-pear</kbd>, and <kbd class="calibre12">- php5-mysql</kbd> values.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    </header><h1 class="header-title" id="calibre_pb_0">Provisioning Vagrant with Salt</h1>
                
            
            <article>
                
<p class="calibre2">Let's get to the main part of this chapter: provisioning a Vagrant machine with Salt. We'll look at the <kbd class="calibre12">masterless</kbd> configuration setup for this section. We'll learn how to install the Nginx web server onto our Vagrant machine:</p>
<ol class="calibre13">
<li value="1" class="calibre11">Create a new folder/directory for this example. I'm calling mine <kbd class="calibre12">vagrant-salt</kbd>.</li>
<li value="2" class="calibre11">Move into the new folder and run the <kbd class="calibre12">vagrant init -m</kbd> command to create a new Vagrantfile.</li>
<li value="3" class="calibre11">We need to create some folders and files for Salt. Create a <kbd class="calibre12">roots</kbd> folder and a <kbd class="calibre12">minionfiles</kbd> folder. Inside the <kbd class="calibre12">roots</kbd> folder, create a file called <kbd class="calibre12">top.sls</kbd> and enter these contents:</li>
</ol>
<pre class="calibre59"> base:<br class="title-page-name"/>     '*':<br class="title-page-name"/>         - base</pre>
<p class="calibre2"/>
<p class="calibre2"/>
<p class="calibre2"/>
<p class="calibre2"/>
<p class="calibre2"/>
<p class="calibre2"/>
<p class="calibre2"/>
<p class="calibre2"/>
<p class="calibre2"/>
<p class="calibre2"/>
<p class="calibre56">Within the same folder (<kbd class="calibre12">roots</kbd>), create another file called <kbd class="calibre12">base.sls</kbd> and enter these contents:</p>
<pre class="calibre59"> nginx:<br class="title-page-name"/>     pkg.installed:<br class="title-page-name"/>         - name: nginx</pre>
<p class="calibre56">The top file dictates what hosts to target. We can use the <kbd class="calibre12">*</kbd> icon here to indicate that we will target all hosts. This is not always the best option, but in this instance it will work fine. It also dictates what Salt file to use. The <kbd class="calibre12">- base</kbd> value translates into the <kbd class="calibre12">base.sls</kbd> file that we created.</p>
<p class="calibre56">The <kbd class="calibre12">base.sls</kbd> file is very minimal. It dictates that the <kbd class="calibre12">nginx</kbd> package (<kbd class="calibre12">pkg</kbd>) should be <kbd class="calibre12">installed</kbd>. Let's now move into the <kbd class="calibre12">minionfile</kbd> folder and create our base Minion file. Create the <kbd class="calibre12">minion.yml</kbd> file and enter the following contents:</p>
<pre class="calibre59"> master: localhost<br class="title-page-name"/> file_client: local</pre>
<p class="calibre56">Here we are setting the <kbd class="calibre12">master</kbd> value as <kbd class="calibre12">localhost</kbd> (as we are using a Masterless setup) and the <kbd class="calibre12">file_client</kbd> to <kbd class="calibre12">local</kbd> too. Save these files and return to the <kbd class="calibre12">roots</kbd> folder where the Vagrantfile is.</p>
<ol start="4" class="calibre13">
<li value="4" class="calibre11">Set up the Vagrantfile. Edit the file to include these contents:</li>
</ol>
<pre class="calibre59"> Vagrant.configure("2") do |config|<br class="title-page-name"/>     config.vm.box = "ubuntu/xenial64"<br class="title-page-name"/>     config.vm.network "private_network", ip: "10.10.10.20"<br class="title-page-name"/>     config.vm.synced_folder "roots/", "/srv/salt"<br class="title-page-name"/>     config.vm.provision :salt do |sa|<br class="title-page-name"/>         sa.masterless = true<br class="title-page-name"/>         sa.minion_config = "minionfiles/minion.yml"<br class="title-page-name"/>         sa.run_highstate = true<br class="title-page-name"/>     end<br class="title-page-name"/> end</pre>
<p class="calibre56">The Vagrantfile is fairly compact, but there are many options available to configure Salt. You'll learn more about these in the coming sections.</p>
<p class="calibre56">In this Vagrantfile, we first set the box to use Ubuntu Xenial 64 bit and we set a private network IP address as <kbd class="calibre12">10.10.10.20</kbd>. We then set up Vagrant's <kbd class="calibre12">synced_folder</kbd> option to share our roots folder with Salt so it can access our <kbd class="calibre12">top.sls</kbd> and <kbd class="calibre12">base.sls</kbd> files. In the next section, we set the provision block to use salt and set some basic values. We set the Masterless option to <kbd class="calibre12">true</kbd>, and the <kbd class="calibre12">minion_config</kbd> to use our recently created <kbd class="calibre12">minion.yml</kbd> file inside the <kbd class="calibre12">minionfiles</kbd> folder. We also set the <kbd class="calibre12">run_highstate</kbd> option to <kbd class="calibre12">true</kbd> to suppress any errors and run the files.</p>
<ol start="5" class="calibre13">
<li value="5" class="calibre11">Save the Vagrantfile and run <kbd class="calibre12">vagrant up --provision</kbd> to start the Vagrant machine.</li>
<li value="6" class="calibre11">During the <kbd class="calibre12">vagrant up </kbd><span>process, we will see some new output as defined by the Vagrantfile and Salt options. We'll first see the folder syncing setup. In the following screenshot, we can see Vagrant's</span> <kbd class="calibre12">/srv/salt</kbd><span> folder linking to</span> <kbd class="calibre12">/roots</kbd><span> on the host machine:</span></li>
</ol>
<p class="cdpaligncenter1"><img class="alignnone81" src="../images/00153.jpeg"/></p>
<p class="calibre56">We'll then see the <kbd class="calibre12">Running provisioner: salt...</kbd> section, which will show any output from the Salt provisioner. We can see that Salt checks a number of things such as whether <kbd class="calibre12">salt-minion</kbd> is installed or outputs that <kbd class="calibre12">Salt successfully configured and installed!</kbd>.</p>
<p class="calibre56">Salt has been installed and the Salt state and minion files have been parsed and executed:</p>
<p class="cdpaligncenter3"><img class="alignnone82" src="../images/00154.jpeg"/></p>
<p class="calibre56">Once this is complete and the Vagrant machine is running, open a web browser and visit the private network IP address we set in the Vagrantfile. Open <kbd class="calibre12">http://10.10.10.20</kbd> and you should see the default Nginx welcome page:</p>
<p class="cdpaligncenter3"><img class="alignnone83" src="../images/00155.jpeg"/></p>
<p class="calibre2">Congratulations! You have successfully provisioned a Vagrant machine using Salt. We have used the <kbd class="calibre12">sls</kbd> files to dictate that the Nginx package should be installed. There are many different options that you can experiment with here, especially using a Master and Minion configuration setup.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    </header><h1 class="header-title" id="calibre_pb_0">Salt options available within Vagrant</h1>
                
            
            <article>
                
<p class="calibre2">As Salt is essentially built into Vagrant, there are many options available. There are currently six different types of options available to manage in the Vagrantfile. These option types are:</p>
<ul class="calibre10">
<li class="calibre11">Install</li>
<li class="calibre11">Minion</li>
<li class="calibre11">Master</li>
<li class="calibre11">Execute states</li>
<li class="calibre11">Execute runners</li>
<li class="calibre11">Output control</li>
</ul>
<p class="calibre2">Let's break these option groups down to see what specific options are available to configure.</p>
<p class="calibre2"/>


            </article>

            
        </section>
    

        <section>

                            <header>
                    </header><h1 class="header-title" id="calibre_pb_0">Install options</h1>
                
            
            <article>
                
<p class="calibre2">These are fairly generic options and are used to manage the installation of Salt. Here are the options available:</p>
<ul class="calibre10">
<li class="calibre11"><kbd class="calibre12">install_master</kbd>: If this option is set to <kbd class="calibre12">true</kbd>, it will install the <kbd class="calibre12">salt-master</kbd> daemon</li>
<li class="calibre11"><kbd class="calibre12">no_minion</kbd>: If set to true, this options will not install the minion</li>
<li class="calibre11"><kbd class="calibre12">install_syndic</kbd>: Dictates whether to install <kbd class="calibre12"><span>salt-syndic</span></kbd></li>
<li class="calibre11"><kbd class="calibre12">install_type</kbd>: Dictates the installation channel when installing via package manager, such as stable, daily, or testing</li>
<li class="calibre11"><kbd class="calibre12">install_args</kbd>: When using Git, you can specify additional args, such as branch or tag</li>
<li class="calibre11"><kbd class="calibre12">always_install</kbd>: Dictates whether to install binaries, even if they are already detected</li>
<li class="calibre11"><kbd class="calibre12">bootstrap_script</kbd>: This is the path to your custom boostrap sh script</li>
<li class="calibre11"><kbd class="calibre12">bootstrap_options</kbd>: Additional options to path to your custom bootstrap <kbd class="calibre12">sh</kbd> script</li>
<li class="calibre11"><kbd class="calibre12">version</kbd>: This dictates the version of the Minion to be installed</li>
<li class="calibre11"><kbd class="calibre12">python_version</kbd>: This dictates the major Python version to be installed on the Minion</li>
</ul>


            </article>

            
        </section>
    

        <section>

                            <header>
                    </header><h1 class="header-title" id="calibre_pb_0">Minion options</h1>
                
            
            <article>
                
<p class="calibre2">These are minion-specific options. These are only really used when the <kbd class="calibre12">no_minion</kbd> option is set to true (the default value). Here are the options available:</p>
<ul class="calibre10">
<li class="calibre11"><kbd class="calibre12">minion_config</kbd>: The path to a custom minion config file</li>
<li class="calibre11"><kbd class="calibre12">minion_key</kbd>: The path to your minion key</li>
<li class="calibre11"><kbd class="calibre12">minion_id</kbd>: A unique identifier for a minion</li>
<li class="calibre11"><kbd class="calibre12">minion_pub</kbd>: The path to your minion public key</li>
<li class="calibre11"><kbd class="calibre12">grains_config</kbd>: The path to a custom grains file</li>
<li class="calibre11"><kbd class="calibre12">masterless</kbd>: This will call <kbd class="calibre12">state.highstate</kbd> in local mode</li>
<li class="calibre11"><kbd class="calibre12">minion_json_config</kbd>: This is valid JSON used to configure the salt minion</li>
<li class="calibre11"><kbd class="calibre12">salt_call_args</kbd>: Additional arguments to pass to the <kbd class="calibre12">salt-call</kbd> command if provisioning with Masterless</li>
</ul>


            </article>

            
        </section>
    

        <section>

                            <header>
                    </header><h1 class="header-title" id="calibre_pb_0">Master options</h1>
                
            
            <article>
                
<p class="calibre2"><span class="calibre6">These are master-specific options. These are only really used when the <kbd class="calibre12">install_master</kbd> option is set to true. Here are the options available:</span></p>
<ul class="calibre10">
<li class="calibre11"><span><kbd class="calibre12">master_config</kbd>: This is the path to the master config file</span></li>
<li class="calibre11"><kbd class="calibre12">master_key</kbd>: This is the path to your master key</li>
<li class="calibre11"><kbd class="calibre12">master_pub</kbd>: This is the path to your public key</li>
<li class="calibre11"><kbd class="calibre12">seed_master</kbd>: This is used to upload keys to the master</li>
<li class="calibre11"><kbd class="calibre12">master_json_config</kbd>: This is valid JSON used to configure the master minion</li>
<li class="calibre11"><kbd class="calibre12">salt_args</kbd>: <span>Additional arguments to pass to the 'salt' command if provisioning with Masterless</span></li>
</ul>


            </article>

            
        </section>
    

        <section>

                            <header>
                    </header><h1 class="header-title" id="calibre_pb_0">Execute states</h1>
                
            
            <article>
                
<p class="calibre2">There is only one option here to control state-execution during provisioning:</p>
<ul class="calibre10">
<li class="calibre11"><kbd class="calibre12">run_highstate</kbd>:<strong class="calibre1"> </strong>Executes <kbd class="calibre12">state.highstate</kbd> on <kbd class="calibre12">vagrant up</kbd></li>
</ul>


            </article>

            
        </section>
    

        <section>

                            <header>
                    </header><h1 class="header-title" id="calibre_pb_0">Execute runners</h1>
                
            
            <article>
                
<p class="calibre2">These options control runner execution during provisioning. These are the options available:</p>
<ul class="calibre10">
<li class="calibre11"><strong class="calibre1"><kbd class="calibre12">run_overstate</kbd>:</strong> <span>Dictates whether</span> <span><kbd class="calibre12">state.over</kbd> is run during <kbd class="calibre12">vagrant up</kbd></span></li>
<li class="calibre11"><kbd class="calibre12">orchestrations</kbd>: Dictates whether <span><kbd class="calibre12">state.orchestrate</kbd> is run during <kbd class="calibre12">vagrant up</kbd></span></li>
</ul>


            </article>

            
        </section>
    

        <section>

                            <header>
                    </header><h1 class="header-title" id="calibre_pb_0">Output control</h1>
                
            
            <article>
                
<p class="calibre2">These options are used to control the output of state execution:</p>
<ul class="calibre10">
<li class="calibre11"><kbd class="calibre12">colorize</kbd>: This dictates whether the output is colorized</li>
<li class="calibre11"><kbd class="calibre12">log_level</kbd>: The level of output, the default value is <kbd class="calibre12">debug</kbd></li>
<li class="calibre11"><kbd class="calibre12">verbose</kbd>: This dictates whether the output of salt commands are to be displayed</li>
</ul>


            </article>

            
        </section>
    

        <section>

                            <header>
                    </header><h1 class="header-title" id="calibre_pb_0">Vagrant cheat sheet</h1>
                
            
            <article>
                
<p class="calibre2">Through this chapter, I have shown you various tips and tricks when using Vagrant. It's always helpful to learn the correct way of doing something and, when comfortable, using faster methods that you may have picked up along the way. In this section, we will highlight some Vagrant shortcuts that I use and that I hope will help you.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    </header><h1 class="header-title" id="calibre_pb_0">Testing a Vagrantfile</h1>
                
            
            <article>
                
<p class="calibre2">When working with a Vagrantfile, large or small, it can be useful to test it as you write it. If writing a complex Vagrantfile, it can be useful to test certain sections as you add them, without writing the whole thing and getting errors.</p>
<p class="calibre2">Run the<span class="calibre6"> </span><kbd class="calibre12">vagrant validate</kbd><span class="calibre6"> </span>command to test your Vagrantfile without having to run <kbd class="calibre12">vagrant up</kbd> or go through the whole process.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    </header><h1 class="header-title" id="calibre_pb_0">Saving a snapshot</h1>
                
            
            <article>
                
<p class="calibre2">You can quickly and easily save a snapshot of your Vagrant machine and roll back to that at a later date/time. This can be useful for testing purposes, local versioning, and general usage.</p>
<p class="calibre2">Run the<span class="calibre6"> </span><kbd class="calibre12">vagrant snapshot save [options] [vm-name] [snapshot-save-name]</kbd><span class="calibre6"> </span>command. The final parameter is used to give the snapshot a name so you can revert back to it.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    </header><h1 class="header-title" id="calibre_pb_0">Status</h1>
                
            
            <article>
                
<p class="calibre2">Vagrant offers two status commands. One to view the status of the machine in your current working directory (if any), and one to view the status of all machines on your system.</p>
<p class="calibre2">Use the<span class="calibre6"> </span><kbd class="calibre12">vagrant status</kbd><span class="calibre6"> </span>or<span class="calibre6"> </span><kbd class="calibre12">vagrant global-status</kbd><span class="calibre6"> </span>commands.</p>
<p class="calibre2"/>


            </article>

            
        </section>
    

        <section>

                            <header>
                    </header><h1 class="header-title" id="calibre_pb_0">Boxes</h1>
                
            
            <article>
                
<p class="calibre2">Boxes are a big part of the Vagrant ecosystem and can sometimes be a pain to manage. Here are a few commands to help:</p>
<ul class="calibre10">
<li class="calibre11">Use<span> </span><kbd class="calibre12">vagrant box list</kbd><span> </span>to view all installed boxes on your system</li>
<li class="calibre11">Use<span> </span><kbd class="calibre12">vagrant box outdated --global</kbd><span> </span>to check for updates on installed boxes</li>
<li class="calibre11">Use<span> </span><kbd class="calibre12">vagrant box prune</kbd><span> </span>to remove old box versions</li>
</ul>


            </article>

            
        </section>
    

        <section>

                            <header>
                    </header><h1 class="header-title" id="calibre_pb_0">Hardware specification</h1>
                
            
            <article>
                
<p class="calibre2">If you need a more powerful Vagrant machine, you can use provider-specific code in your Vagrantfile to beef up the hardware spec. <span class="calibre6">In the following example we will use the <kbd class="calibre12">memory</kbd> value to set a higher memory (RAM) for the machine. We also set the <kbd class="calibre12">cpus</kbd> value to set a higher processor count. Finally, we set the <kbd class="calibre12">gui</kbd> value so we can access the machine via a graphical user interface:</span></p>
<pre class="calibre17">config.vm.provider "virtualbox" do |vb|<br class="title-page-name"/>     vb.memory = 4096<br class="title-page-name"/>     vb.cpus = 2<br class="title-page-name"/>     vb.gui = true<br class="title-page-name"/> end</pre>
<p class="calibre2">This is VirtualBox-specific code.</p>
<div class="packt_infobox">Please note: You cannot specify a higher hardware specification than the host machine.</div>


            </article>

            
        </section>
    

        <section>

                            <header>
                    </header><h1 class="header-title" id="calibre_pb_0">Code deployment</h1>
                
            
            <article>
                
<p class="calibre2">You can deploy code from Vagrant by running the vagrant push command. You will need to do some configuration first but this can be a good way of managing code and a machine at the same time. You will need to specify a remote server (such as FTP) in your Vagrantfile before running the command. Here is an example block:</p>
<pre class="calibre17">config.push.define "ftp" do |push|<br class="title-page-name"/>     push.host = "ftp.yourdeploymentexample.com"<br class="title-page-name"/>     push.username = "yourftpusername"<br class="title-page-name"/>     push.password = "yourftppassword"<br class="title-page-name"/> end</pre>
<p class="calibre2">You can use FTP, SFTP (by setting the secure option to true in the FTP version), Heroku, or execute commands that you have created for pushing code.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    </header><h1 class="header-title" id="calibre_pb_0">Multi-machine</h1>
                
            
            <article>
                
<p class="calibre2">Using Vagrant's multi-machine is a powerful and easy way to create an infrastructure. This can be used for testing or to closely replicate your production environment. You can set up multiple Vagrant machines in one Vagrantfile and then manage them separately.</p>
<p class="calibre2">Each machine gets its own block in the Vagrantfile so any options are specific to that one machine. You can use different provisioners, hardware specs, and other options in each block.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    </header><h1 class="header-title" id="calibre_pb_0">General</h1>
                
            
            <article>
                
<p class="calibre2">We've covered some specific parts, <span class="calibre6">but it can be worth revisiting the basics</span> when trying to solve a problem or learn more about specific features.</p>
<p class="calibre2">You can run the<span class="calibre6"> </span><kbd class="calibre12">vagrant help</kbd><span class="calibre6"> </span>command to list all commands in the system, which shows a description and usage. To get more information on a specific command, you can run the<span class="calibre6"> </span><kbd class="calibre12">vagant [command-name] -h</kbd><span class="calibre6"> </span>command.</p>
<p class="calibre2"/>
<p class="calibre2"/>
<p class="calibre2">The official Vagrant website and documentation is well written, easy to understand, and easy to use. I often refer to it when using something new or something I haven't used for a while.</p>
<p class="calibre2">Error messages in Vagrant are generally helpful and describe the error in a fairly easy-to-understand manner. If you have any issues, try to work through the error message. I often use search engines to find out how to fix an error.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    </header><h1 class="header-title" id="calibre_pb_0">Summary</h1>
                
            
            <article>
                
<p class="calibre2"><span class="calibre6">In this chapter, we learned how to provision a Vagrant machine using the Salt software. We learned about the options available when configuring Salt with Vagrant, and looked at what Salt states are and their syntax.</span></p>
<p class="calibre2">The end of this chapter marks the end of our provisioning miniseries and the end of this book. I encourage you to keep exploring Vagrant and its many different features. We've focused mainly on provisioning in this book, but you could also look at the provider option in Vagrant. This allows you to manage which software actually powers the virtual machine. We use VirtualBox in this book, but there are other options, such as VMWare and Docker. It all depends on your environment and available software, but Vagrant can be flexible and will often meet your requirements.</p>


            </article>

            
        </section>
    </body></html>