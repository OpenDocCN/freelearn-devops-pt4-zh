["```\nglobal:\n  scrape_interval: 1m\n...\nscrape_configs:\n  - job_name: 'prometheus'\n    scrape_interval: 15s\n    scrape_timeout: 5s\n    sample_limit: 1000\n    static_configs:\n      - targets: ['localhost:9090']\n    metric_relabel_configs:\n      - source_labels: [ __name__ ]\n        regex: expensive_metric_.+\n        action: drop\n```", "```\nglobal:\n  scrape_interval: 1m\n  scrape_timeout: 10s\n  evaluation_interval: 1m\n  external_labels:\n    dc: dc1\n    prom: prom1\n```", "```\nscrape_configs:\n - job_name: 'prometheus'\n    static_configs:\n      - targets: ['localhost:9090']\n...\n\n  - job_name: 'blackbox'\n    static_configs:\n      - targets:\n        - http://example.com\n        - https://example.com:443\n...\n```", "```\nscrape_configs:\n - job_name: 'prometheus'\n    scrape_interval: 15s\n    scrape_timeout: 5s\n    sample_limit: 1000\n    static_configs:\n      - targets: ['localhost:9090']\n    metric_relabel_configs:\n      - source_labels: [ __name__ ]\n        regex: expensive_metric_.+\n        action: drop\n```", "```\n  - job_name: 'blackbox'\n    metrics_path: /probe\n    scheme: http\n    params:\n      module: [http_2xx]\n    static_configs:\n      - targets:\n        - http://example.com\n    relabel_configs:\n      - source_labels: [__address__]\n        target_label: __param_target\n      - source_labels: [__param_target]\n        target_label: instance\n      - target_label: __address__\n        replacement: 127.0.0.1:9115\n```", "```\ncd chapter05/\n```", "```\nvagrant global-status\nvagrant up\n```", "```\nvagrant ssh prometheus\n```", "```\ncat /etc/systemd/system/prometheus.service\n```", "```\nExecStart=/usr/bin/prometheus \\\n    --config.file=/etc/prometheus/prometheus.yml \\\n    --storage.tsdb.path=/var/lib/prometheus/data \\\n    --web.console.templates=/usr/share/prometheus/consoles \\\n    --web.console.libraries=/usr/share/prometheus/console_libraries\n```", "```\ncat /etc/prometheus/prometheus.yml\n```", "```\nvagrant destroy -f\n```", "```\nminikube status\nminikube delete\n```", "```\nminikube start \\\n --cpus=2 \\\n --memory=2048 \\\n --kubernetes-version=\"v1.14.0\" \\\n --vm-driver=virtualbox\n```", "```\nminikube dashboard\n```", "```\ncd chapter05/provision/kubernetes/static\n```", "```\napiVersion: v1\nkind: Namespace\nmetadata:\n name: monitoring\n```", "```\nkubectl apply -f monitoring-namespace.yaml\n```", "```\napiVersion: v1\nkind: ConfigMap\nmetadata:\n  name: prometheus-config\n  namespace: monitoring \ndata:\n  prometheus.yml: |\n    scrape_configs:\n    - job_name: prometheus\n      static_configs:\n      - targets:\n        - localhost:9090\n```", "```\nkubectl apply -f prometheus-configmap.yaml\n```", "```\napiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: prometheus-deployment\n  namespace: monitoring\n  labels:\n    app: prometheus\n```", "```\n        args:\n          - --config.file=/etc/config/prometheus.yml\n          - --storage.tsdb.path=/data\n        volumeMounts:\n          - name: config-volume\n            mountPath: /etc/config/prometheus.yml\n            subPath: prometheus.yml\n          - name: prometheus-data\n            mountPath: /data\n            subPath: \"\"\n```", "```\n      volumes:\n        - name: config-volume\n          configMap:\n           name: prometheus-config\n        - name: prometheus-data\n          emptyDir: {}\n```", "```\nkubectl apply -f prometheus-deployment.yaml\n```", "```\nkubectl rollout status deployment/prometheus-deployment -n monitoring\n```", "```\nkubectl logs --tail=20 -n monitoring -l app=prometheus\n```", "```\nkind: Service\napiVersion: v1\nmetadata:\n  name: prometheus-service\n  namespace: monitoring\nspec:\n  selector:\n    app: prometheus\n  type: NodePort\n  ports:\n  - name: prometheus-port\n    protocol: TCP\n    port: 9090\n    targetPort: 9090\n```", "```\nkubectl apply -f prometheus-service.yaml\n```", "```\nminikube service prometheus-service -n monitoring\n```", "```\napiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: hey-deployment\n  namespace: monitoring\n  labels:\n    app: hey\n...\n      - name: hey\n        image: kintoandar/hey:v1.0.1\n...\n        - name: http\n          containerPort: 8000\n...\n```", "```\nkubectl apply -f hey-deployment.yaml\n```", "```\nkubectl rollout status deployment/hey-deployment -n monitoring\n```", "```\nkubectl logs --tail=20 -n monitoring -l app=hey\n```", "```\nkind: Service\napiVersion: v1\nmetadata:\n  name: hey-service\n  namespace: monitoring\nspec:\n  selector:\n    app: hey\n  type: NodePort\n  ports:\n  - name: hey-port\n    protocol: TCP\n    port: 8000\n    targetPort: 8000\n```", "```\nkubectl apply -f hey-service.yaml\n```", "```\nminikube service hey-service -n monitoring\n```", "```\nkind: ConfigMap\nmetadata:\n  name: prometheus-config\n  namespace: monitoring \ndata:\n  prometheus.yml: |\n    scrape_configs:\n    - job_name: prometheus\n      static_configs:\n      - targets:\n        - localhost:9090\n    - job_name: hey\n      static_configs:\n      - targets:\n        - hey-service.monitoring.svc:8000\n```", "```\nkubectl create -f prometheus-configmap-update.yaml -o yaml --dry-run | kubectl apply -f -\n```", "```\nkubectl apply -f prometheus-deployment-update.yaml\n```", "```\nkubectl rollout status deployment/prometheus-deployment -n monitoring\n```", "```\nminikube status\nminikube delete\n```", "```\nminikube start \\\n --cpus=2 \\\n --memory=2048 \\\n --kubernetes-version=\"v1.14.0\" \\\n --vm-driver=virtualbox\n```", "```\nminikube dashboard\n```", "```\ncd chapter05/provision/kubernetes/operator\n```", "```\nkubectl apply -f monitoring-namespace.yaml\n```", "```\napiVersion: rbac.authorization.k8s.io/v1\nkind: ClusterRole\nmetadata:\n  name: prometheus-operator\nrules:\n- apiGroups: [apiextensions.k8s.io]\n  verbs: ['*']\n  resources: [customresourcedefinitions]\n- apiGroups: [monitoring.coreos.com]\n  verbs: ['*']\n  resources: \n  - alertmanagers\n  - prometheuses\n  - servicemonitors\n...\n```", "```\napiVersion: rbac.authorization.k8s.io/v1\nkind: ClusterRoleBinding\nmetadata:\n  name: prometheus-operator\nroleRef:\n  apiGroup: rbac.authorization.k8s.io\n  kind: ClusterRole\n  name: prometheus-operator\nsubjects:\n- kind: ServiceAccount\n  name: prometheus-operator\n  namespace: monitoring\n```", "```\napiVersion: v1\nkind: ServiceAccount\nmetadata:\n  name: prometheus-operator\n  namespace: monitoring\n```", "```\nkubectl apply -f prometheus-operator-rbac.yaml\n```", "```\napiVersion: apps/v1beta2\nkind: Deployment\nmetadata:\n  labels:\n    k8s-app: prometheus-operator\n  name: prometheus-operator\n  namespace: monitoring\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      k8s-app: prometheus-operator\n...\n      serviceAccountName: prometheus-operator\n```", "```\nkubectl apply -f prometheus-operator-deployment.yaml\n```", "```\nkubectl rollout status deployment/prometheus-operator -n monitoring\n```", "```\napiVersion: rbac.authorization.k8s.io/v1\nkind: ClusterRole\nmetadata:\n  name: prometheus-k8s\nrules:\n...\n- nonResourceURLs:\n  - /metrics\n  verbs:\n  - get\n```", "```\napiVersion: rbac.authorization.k8s.io/v1\nkind: ClusterRoleBinding\nmetadata:\n  name: prometheus-k8s\nroleRef:\n  apiGroup: rbac.authorization.k8s.io\n  kind: ClusterRole\n  name: prometheus-k8s\nsubjects:\n- kind: ServiceAccount\n  name: prometheus-k8s\n  namespace: monitoring\n```", "```\napiVersion: v1\nkind: ServiceAccount\nmetadata:\n  name: prometheus-k8s\n  namespace: monitoring\n```", "```\nkubectl apply -f prometheus-rbac.yaml\n```", "```\napiVersion: monitoring.coreos.com/v1\nkind: Prometheus\nmetadata:\n  labels:\n    prometheus: k8s\n  name: k8s\n  namespace: monitoring\nspec:\n  baseImage: quay.io/prometheus/prometheus\n  version: v2.9.2\n  replicas: 2\n...\n  serviceAccountName: prometheus-k8s\n  serviceMonitorNamespaceSelector: {}\n  serviceMonitorSelector: {}\n```", "```\nkubectl apply -f prometheus-server.yaml\n```", "```\nkubectl rollout status statefulset/prometheus-k8s -n monitoring\n```", "```\nkubectl apply -f prometheus-service.yaml\n\nminikube service prometheus-service -n monitoring \n```", "```\napiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: hey-deployment\n  namespace: default\nspec:\n  replicas: 3\n  selector:\n    matchLabels:\n      app: hey\n```", "```\n  template:\n    metadata:\n      labels:\n        app: hey\n    spec:\n      containers:\n      - name: hey\n        image: kintoandar/hey:v1.0.1\n        ports:\n        - name: hey-port\n          containerPort: 8000\n...\n```", "```\nkubectl apply -f hey-deployment.yaml\n```", "```\nkubectl rollout status deployment/hey-deployment -n default\n```", "```\nkind: Service\nmetadata:\n  labels:\n    squad: frontend\n  name: hey-service\n  namespace: default\nspec:\n  selector:\n    app: hey\n  type: NodePort\n  ports:\n  - name: hey-port\n    protocol: TCP\n    port: 8000\n    targetPort: hey-port\n```", "```\nkubectl apply -f hey-service.yaml minikube service hey-service -n default\n```", "```\napiVersion: monitoring.coreos.com/v1\nkind: ServiceMonitor\nmetadata:\n  labels:\n    k8s-app: prometheus\n  name: prometheus\n  namespace: monitoring\nspec:\n  endpoints:\n  - interval: 30s\n    port: web\n  selector:\n    matchLabels:\n      prometheus: k8s\n```", "```\napiVersion: monitoring.coreos.com/v1\nkind: ServiceMonitor\nmetadata:\n  labels:\n    app: hey\n  name: hey-metrics\n  namespace: default\nspec:\n  endpoints:\n  - interval: 30s\n    port: hey-port\n  selector:\n    matchLabels:\n      squad: frontend\n```", "```\nkubectl apply -f prometheus-servicemonitor.yaml\n\nkubectl apply -f hey-servicemonitor.yaml\n```", "```\nkubectl get servicemonitors --all-namespaces\n```"]