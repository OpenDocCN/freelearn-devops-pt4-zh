["```\ncd chapter08/\n```", "```\nvagrant global-status\nvagrant up\n```", "```\nvagrant status\n```", "```\nCurrent machine states:\n\nprometheus running (virtualbox)\n\nThe VM is running. To stop this VM, you can run `vagrant halt` to shut it down forcefully, or you can run `vagrant suspend` to simply suspend the virtual machine. In either case, to restart it again, simply run `vagrant up`.\n```", "```\nvagrant ssh prometheus\n```", "```\nvagrant destroy -f\n```", "```\nvagrant@prometheus:~$ promtool check config /etc/prometheus/prometheus.yml \nChecking /etc/prometheus/prometheus.yml\n SUCCESS: 1 rule files found\n\nChecking /etc/prometheus/first_rules.yml\n SUCCESS: 1 rules found\n```", "```\nvagrant@prometheus:~$ promtool check rules /etc/prometheus/first_rules.yml \nChecking /etc/prometheus/first_rules.yml\n SUCCESS: 1 rules found\n```", "```\n~$ curl -s http://prometheus:9090/metrics | promtool check metrics\nprometheus_tsdb_storage_blocks_bytes_total non-counter metrics should not have \"_total\" suffix\n```", "```\n~$ curl -s http://prometheus:9090/metrics | grep prometheus_tsdb_storage_blocks_bytes_total\n# HELP prometheus_tsdb_storage_blocks_bytes_total The number of bytes that are currently used for local storage by all blocks.\n# TYPE prometheus_tsdb_storage_blocks_bytes_total gauge\nprometheus_tsdb_storage_blocks_bytes_total 0\n```", "```\nvagrant@prometheus:~$ promtool query instant 'http://prometheus:9090' 'up == 1'\nup{instance=\"prometheus:9090\", job=\"prometheus\"} => 1 @[1550609854.042]\nup{instance=\"prometheus:9100\", job=\"node\"} => 1 @[1550609854.042]\n```", "```\nvagrant@prometheus:~$ promtool query range --start=$(date -d '5 minutes ago' +'%s') --end=$(date -d 'now' +'%s') --step=1m 'http://prometheus:9090' 'node_network_transmit_bytes_total{device=\"eth0\",instance=\"prometheus:9100\",job=\"node\"}'\nnode_network_transmit_bytes_total{device=\"eth0\", instance=\"prometheus:9100\", job=\"node\"} =>\n139109 @[1551019990]\n139251 @[1551020050]\n139401 @[1551020110]\n139543 @[1551020170]\n139693 @[1551020230]\n140571 @[1551020290]\n```", "```\nvagrant@prometheus:~$ promtool query series 'http://prometheus:9090' --match='up' --match='go_info{job=\"prometheus\"}'\n{__name__=\"go_info\", instance=\"prometheus:9090\", job=\"prometheus\", version=\"go1.11.5\"}\n{__name__=\"up\", instance=\"prometheus:9090\", job=\"prometheus\"}\n{__name__=\"up\", instance=\"prometheus:9100\", job=\"node\"}\n```", "```\nvagrant@prometheus:~$ promtool query labels 'http://prometheus:9090' 'mountpoint'\n/\n/run\n/run/lock\n/run/user/1000\n/vagrant\n/var/lib/lxcfs\n```", "```\nvagrant@prometheus:~$ promtool debug pprof 'http://prometheus:9090'\ncollecting: http://prometheus:9090/debug/pprof/profile?seconds=30\ncollecting: http://prometheus:9090/debug/pprof/block\ncollecting: http://prometheus:9090/debug/pprof/goroutine\ncollecting: http://prometheus:9090/debug/pprof/heap\ncollecting: http://prometheus:9090/debug/pprof/mutex\ncollecting: http://prometheus:9090/debug/pprof/threadcreate\ncollecting: http://prometheus:9090/debug/pprof/trace?seconds=30\nCompiling debug information complete, all files written in \"debug.tar.gz\".\n```", "```\nvagrant@prometheus:~$ tar xzvf debug.tar.gz \ncpu.pb\nblock.pb\ngoroutine.pb\nheap.pb\nmutex.pb\nthreadcreate.pb\ntrace.pb\n```", "```\nvagrant@prometheus:~$ pprof -svg heap.pb > /vagrant/cache/heap.svg\n```", "```\nvagrant@prometheus:~$ promtool debug metrics 'http://prometheus:9090'\ncollecting: http://prometheus:9090/metrics\nCompiling debug information complete, all files written in \"debug.tar.gz\".\n\nvagrant@prometheus:~$ tar xzvf debug.tar.gz \nmetrics.txt\n\nvagrant@prometheus:~$ tail -n 5 metrics.txt \n# HELP promhttp_metric_handler_requests_total Total number of scrapes by HTTP status code.\n# TYPE promhttp_metric_handler_requests_total counter\npromhttp_metric_handler_requests_total{code=\"200\"} 284\npromhttp_metric_handler_requests_total{code=\"500\"} 0\npromhttp_metric_handler_requests_total{code=\"503\"} 0\n```", "```\nvagrant@prometheus:~$ promtool debug all 'http://prometheus:9090'\ncollecting: http://prometheus:9090/debug/pprof/threadcreate\ncollecting: http://prometheus:9090/debug/pprof/profile?seconds=30\ncollecting: http://prometheus:9090/debug/pprof/block\ncollecting: http://prometheus:9090/debug/pprof/goroutine\ncollecting: http://prometheus:9090/debug/pprof/heap\ncollecting: http://prometheus:9090/debug/pprof/mutex\ncollecting: http://prometheus:9090/debug/pprof/trace?seconds=30\ncollecting: http://prometheus:9090/metrics\nCompiling debug information complete, all files written in \"debug.tar.gz\".\n```", "```\nvagrant@prometheus:~$ curl -w \"%{http_code}\\n\" http://localhost:9090/-/healthy\nPrometheus is Healthy.\n200\n\nvagrant@prometheus:~$ curl -w \"%{http_code}\\n\" http://localhost:9090/-/ready\nPrometheus is Ready.\n200\n```", "```\nvagrant@prometheus:~$ sudo systemctl cat prometheus.service\n```", "```\nExecStart=/usr/bin/prometheus \\\n    --log.level=debug \\\n    --config.file=/etc/prometheus/prometheus.yml \\\n    --storage.tsdb.path=/var/lib/prometheus/data \\\n    --web.console.templates=/usr/share/prometheus/consoles \\\n    --web.console.libraries=/usr/share/prometheus/console_libraries\n```", "```\nvagrant@prometheus:~$ sudo service node-exporter stop\nvagrant@prometheus:~$ sudo journalctl -fu prometheus | grep debug\nFeb 23 15:28:14 prometheus prometheus[1438]: level=debug ts=2019-02-23T15:28:14.44856006Z caller=scrape.go:825 component=\"scrape manager\" scrape_pool=node target=http://prometheus:9100/metrics msg=\"Scrape failed\" err=\"Get http://prometheus:9100/metrics: dial tcp 192.168.42.10:9100: connect: connection refused\"\nFeb 23 15:28:29 prometheus prometheus[1438]: level=debug ts=2019-02-23T15:28:29.448826505Z caller=scrape.go:825 component=\"scrape manager\" scrape_pool=node target=http://prometheus:9100/metrics msg=\"Scrape failed\" err=\"Get http://prometheus:9100/metrics: dial tcp 192.168.42.10:9100: connect: connection refused\"\n```", "```\nvagrant@prometheus:~$ sudo systemctl stop prometheus\n```", "```\nvagrant@prometheus:~$ sudo tsdb analyze --limit=3 /var/lib/prometheus/data/\n```", "```\nBlock path: /var/lib/prometheus/data/01D48RFXXF27F91FVNGZ107JCK\nDuration: 2h0m0s\nSeries: 819\nLabel names: 40\nPostings (unique label pairs): 592\nPostings entries (total label pairs): 3164\n```", "```\nLabel pairs most involved in churning:\n112 job=node\n112 instance=prometheus:9100\n111 instance=prometheus:9090\n```", "```\nLabel names most involved in churning:\n224 instance\n224 __name__\n224 job\n```", "```\nMost common label pairs:\n413 job=node\n413 instance=prometheus:9100\n406 instance=prometheus:9090\n```", "```\nHighest cardinality labels:\n394 __name__\n66 le\n30 collector\n```", "```\nHighest cardinality metric names:\n30 node_scrape_collector_duration_seconds\n30 node_scrape_collector_success\n20 prometheus_http_request_duration_seconds_bucket\n```", "```\nvagrant@prometheus:~$ ls -l /var/lib/prometheus/data/\ntotal 28\ndrwxr-xr-x 3 prometheus prometheus 4096 Feb 21 21:15 01D45Z3QCP8D6135QNS4MEPJEK/\ndrwxr-xr-x 3 prometheus prometheus 4096 Feb 21 21:15 01D486GRJTNYJH1RM0F2F4Q9TR/\ndrwxr-xr-x 4 prometheus prometheus 4096 Feb 21 21:15 01D48942G83N129W5FKQ5B3XCH/\ndrwxr-xr-x 4 prometheus prometheus 4096 Feb 21 21:15 01D48G04625Y6AKQ3Z63YJVNTQ/\ndrwxr-xr-x 3 prometheus prometheus 4096 Feb 21 21:15 01D48G048ECAR9GZ7QY1Q8SQ6Z/\ndrwxr-xr-x 4 prometheus prometheus 4096 Feb 21 21:15 01D48RFXXF27F91FVNGZ107JCK/\n-rw-r--r-- 1 prometheus prometheus 0 Feb 19 23:16 lock\ndrwxr-xr-x 2 prometheus prometheus 4096 Feb 19 23:16 wal/\n\nvagrant@prometheus:~$ sudo tsdb analyze /var/lib/prometheus/data 01D486GRJTNYJH1RM0F2F4Q9TR\n```"]