<html><head></head><body>
        <section>

                            <header>
                    <h1 class="header-title">Installing and Configuring GitLab Runners</h1>
                </header>
            
            <article>
                
<p>In this chapter, we will take a look at the GitLab Runner client architecture. After studying this topic, you will understand the basic flow of control between GitLab CI and Runners. In the second part of this chapter, I will show you how to install Runner software on different operating systems. Since the Runner program is written in Golang, there are many platforms that are capable of running the client. Golang is known for its excellent multi-platform support.</p>
<p>In this chapter, we will cover the following topics:</p>
<ul>
<li><span>The Runner client architecture</span></li>
<li>Creating a basic runner with the shell executor</li>
</ul>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Technical requirements</h1>
                </header>
            
            <article>
                
<p><span>To follow along with the instructions in this chapter, please download the Git repository with the examples available from GitHub: <a href="https://github.com/PacktPublishing/Mastering-GitLab-12/tree/master/Chapter15" target="_blank">https://github.com/PacktPublishing/Mastering-GitLab-12/tree/master/Chapter15</a><a href="https://github.com/PacktPublishing/Mastering-GitLab-12/tree/master/Chapter15" target="_blank">.</a></span></p>
<p>The other requirements for this chapter are as follows:</p>
<ul>
<li><strong>GitLab Runner client <span>– </span>Linux 64-<span>bit</span></strong>: <a href="https://gitlab-runner-downloads.s3.amazonaws.com/latest/binaries/gitlab-runner-linux-amd64">https://gitlab-runner-downloads.s3.amazonaws.com/latest/binaries/gitlab-runner-linux-amd64</a></li>
<li><strong>Linux 32-bit</strong>: <a href="https://gitlab-runner-downloads.s3.amazonaws.com/latest/binaries/gitlab-runner-linux-386">https://gitlab-runner-downloads.s3.amazonaws.com/latest/binaries/gitlab-runner-linux-386</a></li>
<li><strong>Linux<span> ARM</span></strong>: <a href="https://gitlab-runner-downloads.s3.amazonaws.com/latest/binaries/gitlab-runner-linux-arm">https://gitlab-runner-downloads.s3.amazonaws.com/latest/binaries/gitlab-runner-linux-arm</a></li>
</ul>
<ul>
<li><strong>macOS<span> 64-bit</span></strong>: <a href="https://gitlab-runner-downloads.s3.amazonaws.com/latest/binaries/gitlab-runner-darwin-amd64">https://gitlab-runner-downloads.s3.amazonaws.com/latest/binaries/gitlab-runner-darwin-amd64</a></li>
<li><strong>FreeBSD<span> 64-bit</span></strong>: <a href="https://gitlab-runner-downloads.s3.amazonaws.com/latest/binaries/gitlab-runner-freebsd-amd64">https://gitlab-runner-downloads.s3.amazonaws.com/latest/binaries/gitlab-runner-freebsd-amd64</a></li>
<li><strong>FreeBSD<span> 32-bit</span></strong>: <a href="https://gitlab-runner-downloads.s3.amazonaws.com/latest/binaries/gitlab-runner-freebsd-386">https://gitlab-runner-downloads.s3.amazonaws.com/latest/binaries/gitlab-runner-freebsd-386</a></li>
<li><strong>Windows 32-bit</strong>: <a href="https://gitlab-runner-downloads.s3.amazonaws.com/latest/binaries/gitlab-runner-windows-386.exe">https://gitlab-runner-downloads.s3.amazonaws.com/latest/binaries/gitlab-runner-windows-386.exe</a></li>
<li><strong>Windows <span>64-bit</span></strong>: <a href="https://gitlab-runner-downloads.s3.amazonaws.com/latest/binaries/gitlab-runner-windows-amd64.exe">https://gitlab-runner-downloads.s3.amazonaws.com/latest/binaries/gitlab-runner-windows-amd64.exe</a></li>
<li><strong>cURL</strong>: <a href="https://curl.haxx.se/download.html">https://curl.haxx.se/download.html</a></li>
</ul>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">The Runner client architecture</h1>
                </header>
            
            <article>
                
<p>We took a brief look at the GitLab architecture in <a href="384dcfd9-ef7f-470d-89dc-3af7502a2d09.xhtml">Chapter 1</a>, <em>Introducing the GitLab Architecture</em>. It was explained that a GitLab Runner registers with a GitLab instance and waits for a job to execute. <span>Unlike the individual components that are a part of the GitLab frontend application server, the runner has a very straightforward architecture. The communication between a runner and its GitLab host is basically one-way. </span></p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Basic architecture</h1>
                </header>
            
            <article>
                
<p>The main network communication is from the GitLab Runner to the GitLab CI, never the other way around. This is shown in the following diagram:</p>
<p class="CDPAlignCenter CDPAlign"><img src="assets/74727c52-cbf6-47c2-bb6e-195b186058bd.png" style="width:27.83em;height:18.67em;"/></p>
<p>The behavior is best depicted by a sequence diagram like the following one:</p>
<p class="CDPAlignCenter CDPAlign"><img src="assets/417ee550-ae39-4540-b50a-8e511aa4e7f8.png" style="width:36.67em;height:43.17em;"/></p>
<p><span>When the GitLab Runner starts, it tries to find its coordinator by contacting the GitLab URL. When it registers itself with the registration token, it gets a special token to connect to GitLab. After a restart, it connects and waits for a job from GitLab CI. It polls GitLab in intervals, and when there is nothing to do, it will check GitLab less often to prohibit too much network traffic.</span></p>
<p>When a job is queued in GitLab CI, it will try to find an available runner. After receiving the command, it will clone the project-specific commit that triggered the job and will execute the steps defined in the <kbd>.gitlab-ci.yml</kbd> file. After execution, the results are sent back to GitLab.</p>
<p>GitLab CI has two types of runners:</p>
<ul>
<li><span class="packt_screen">Specific Runners</span>: As a developer, you can create your own runners and register them to a project in GitLab. Only <span>then is </span>the project visible to the runner.</li>
<li><span class="packt_screen">Shared Runners</span>: A GitLab administrator can also designate a runner to be shared. It can then pick up jobs from several projects. Because this is potentially classed as a security breach, be careful when you're promoting runners to be shared.</li>
</ul>
<p>In the following screenshot, you can see the CI/CD configuration of a project in GitLab, where you can set which runner to use:</p>
<p class="CDPAlignCenter CDPAlign"><img src="assets/02838e13-ac9c-4bfd-91a2-8abdca80dee2.png" style="width:37.58em;height:32.83em;"/></p>
<p>The GitLab Runner clones the repository and performs steps that are defined in the <kbd>.gitlab-ci.yml</kbd> file. It is possible to inject special variables that can be protected on the GitLab project level:</p>
<p class="CDPAlignCenter CDPAlign"><img src="assets/fc761b09-be1d-453a-bb45-91ddc7a63130.png" style="width:55.92em;height:20.33em;"/></p>
<p>We've explained the basic architecture of the runner platform, so now we'll install the software on different operating systems.</p>
<p>The GitLab Runner software is available for the following operating systems:</p>
<ul>
<li>Linux</li>
<li>FreeBSD</li>
<li>macOS</li>
<li>Windows</li>
</ul>
<p>The installation procedure is largely identical on all systems, with subtle differences. In the next section, we will show you how to install the basic Runner on several types of operating systems.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Creating a basic Runner with the shell executor</h1>
                </header>
            
            <article>
                
<p>On the machine where you install the GitLab Runner software, you can run the shell executor to locally build software. This shell type of executor can be run on all platforms where the runner software is installed. Therefore, you can run Bash or a Bourne shell on a Unix-like system, or CMD or PowerShell on the Windows platform.</p>
<p>It isn't a very safe way to build because it can access local resources on the system where the runner executes. More secure executors will be introduced in later chapters.</p>
<p>In the next section, we will demonstrate how to install the GitLab Runner software for your platform.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Installing Runner on Linux</h1>
                </header>
            
            <article>
                
<p>If you run a Linux distribution with a package management system such as</p>
<p> <kbd>yum</kbd> or <kbd>apt</kbd>, you can install the GitLab Runner package using that method. Alternatively, you can install the software manually. First, we will cover the installation via a package manager.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Using a package manager</h1>
                </header>
            
            <article>
                
<p>For yum-based systems, you can add the official GitLab package repository:</p>
<pre><strong>curl -o script.rpm.sh https://packages.gitlab.com/install/repositories/runner/gitlab-runner/script.rpm.sh</strong><br/><strong> less script.rpm.sh #(check the contents, if you are fine with it make it executable and run it)</strong><br/><strong> chmod +x script.rpm.sh</strong><br/><strong> ./script.rpm.sh</strong></pre>
<p>After that, you can install GitLab with this basic command (as root or with <kbd>sudo</kbd>):</p>
<pre><strong>yum install gitlab-runner</strong></pre>
<p>For apt-based systems, it's a bit more tricky to stay up to date with the latest and greatest. We can add a link to GitLab apt repositories, but unfortunately, Debian has named the package in the base repository the same as GitLab. This means that the base packages automatically take precedence. A solution to this is to <kbd>pin</kbd> the package to the right repository. This can be done by adding a file to <kbd>/etc/apt/preferences.d</kbd>:</p>
<pre><strong>cat &lt;&lt;EOF &gt;&gt; /etc/apt/preferences.d/pin-gitlab-runner.pref</strong><br/><strong> Explanation: Pin GitLab-runner package</strong><br/><strong> Package: gitlab-runner</strong><br/><strong> Pin: origin packages.gitlab.com</strong><br/><strong> Pin-Priority: 999</strong><br/><strong> EOF</strong></pre>
<p class="mce-root"/>
<p class="mce-root"/>
<p class="mce-root"/>
<p class="mceNonEditable"/>
<p>After that, you can install the correct <kbd>apt</kbd> package repositories:</p>
<pre><strong>curl -o script.deb.sh https://packages.gitlab.com/install/repositories/runner/gitlab-runner/script.deb.sh</strong><br/><strong> less script.deb.sh #(check the contents, if you are fine with it make it executable and run it)</strong><br/><strong> chmod +x script.deb.sh</strong><br/><strong> ./script.deb.sh</strong></pre>
<p>The output from the preceding command is shown in the following code block. As you can see, it checks the <kbd>gpg</kbd> key and adds the package repository:</p>
<pre><strong>Detected operating system as debian/stretch.</strong><br/><strong> Checking for curl...</strong><br/><strong> Detected curl...</strong><br/><strong> Checking for gpg...</strong><br/><strong> Detected gpg...</strong><br/><strong> Running apt-get update... done.</strong><br/><strong> Installing debian-archive-keyring which is needed for installing</strong><br/><strong> apt-transport-https on many Debian systems.</strong><br/><strong> Installing apt-transport-https... done.</strong><br/><strong> Installing /etc/apt/sources.list.d/runner_gitlab-runner.list...done.</strong><br/><strong> Importing packagecloud gpg key... done.</strong><br/><strong> Running apt-get update... done.</strong><br/> <br/><strong> The repository is setup! You can now install packages.</strong></pre>
<p>The next step is much simpler <span>–</span> you just install it via <kbd>apt-get</kbd>:</p>
<pre><strong>apt-get install gitlab-runner</strong></pre>
<p>In the output, you will find a message like the following, which means that you have now installed all the binaries. However, you have to register the GitLab Runner first before running it:</p>
<pre><strong>...</strong><br/><strong> gitlab-runner: Service is not running.</strong><br/><strong> ...</strong></pre>
<p>The process of registering the runner is explained in more detail in the <em>Registering a runner</em><span> section</span>.</p>
<p>Updating the package is done just as updating all the other packages on the system is done: you can run the <kbd>apt-get update</kbd> or <kbd>yum update</kbd> command.</p>
<p>When installing with <kbd>apt-get</kbd> or <kbd>yum</kbd>, package management will give you a GitLab Runner install with the necessary configuration files and init scripts for your Linux distribution. You can also choose to just download the runner binary and run it in a generic way.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Using a manual installation</h1>
                </header>
            
            <article>
                
<p>Simply download one of the binaries for your CPU architecture (x86-64, x86-32, or ARM):</p>
<ul>
<li><strong>x86-64 bit architecture</strong>:</li>
</ul>
<pre style="padding-left: 60px"><strong>curl -o /usr/local/bin/gitlab-runner https://gitlab-runner-downloads.s3.amazonaws.com/latest/binaries/gitlab-runner-linux-amd64</strong></pre>
<ul>
<li><strong>x86-32 bit architecture</strong>:</li>
</ul>
<pre style="padding-left: 60px"><strong>curl -o  /usr/local/bin/gitlab-runner https://gitlab-runner-downloads.s3.amazonaws.com/latest/binaries/gitlab-runner-linux-386</strong></pre>
<ul>
<li><strong>ARM architecture</strong>: This is the binary for the ARM CPU architecture, in a list:</li>
</ul>
<pre style="padding-left: 60px"><strong>curl -o  /usr/local/bin/gitlab-runner https://gitlab-runner-downloads.s3.amazonaws.com/latest/binaries/gitlab-runner-linux-arm</strong></pre>
<p>When you're getting binaries this way, you have to make them executable:</p>
<pre><strong>chmod +x /usr/local/bin/gitlab-runner</strong></pre>
<p>Then, you can create a GitLab Runner user as root:</p>
<pre><strong>useradd --create-home gitlab-runner</strong></pre>
<p>You then need to install it and run it as a service:</p>
<pre><strong>gitlab-runner install --user=gitlab-runner --working-directory=/home/gitlab-runner</strong><br/><strong>gitlab-runner start</strong></pre>
<p>Although the manual installation is a bit more work than via the package managers, it still isn't a complex process. One advantage is that, when using the manual installation, you can't install newer versions of the runner. The package manager maintainers will never install a development version, while you can. Updating the binary is not very hard either.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Updating a manually installed runner binary</h1>
                </header>
            
            <article>
                
<p>The process we are following when updating is to replace the Golang binary that was downloaded previously. It does have to be stopped, so make sure it isn't running, otherwise the installation will fail.</p>
<p>Stop the service (you need root permissions, like before):</p>
<pre><strong>gitlab-runner stop</strong></pre>
<p>Then, download a new binary to replace the older one:</p>
<pre><strong>curl -o /usr/local/bin/gitlab-runner https://gitlab-runner-downloads.s3.amazonaws.com/latest/binaries/gitlab-runner-linux-386</strong><br/><strong> curl -o /usr/local/bin/gitlab-runner https://gitlab-runner-downloads.s3.amazonaws.com/latest/binaries/gitlab-runner-linux-amd64</strong></pre>
<p>Set the execute bit on the runner binary:</p>
<pre><strong>chmod +x /usr/local/bin/gitlab-runner</strong></pre>
<p>Start the runner again:</p>
<pre><strong>gitlab-runner start</strong></pre>
<p>The manual install is much easier, but you have to manage the updates yourself. In this era of automation, it makes more sense to let the package manager that's available for your distribution to manage it.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Installing on Mac</h1>
                </header>
            
            <article>
                
<p>Just like on Linux, there are several ways to install the GitLab Runner software. Unlike on Linux, where package management is recommended by GitLab, for macOS, they recommend the manual install. The other way to install is by using the Homebrew installation method, which you saw earlier in the book (<em>Installing Redis</em> section of  <a href="384dcfd9-ef7f-470d-89dc-3af7502a2d09.xhtml">Chapter 1</a>, <em>Introducing the GitLab Architecture</em>).</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">The manual way of installing a runner</h1>
                </header>
            
            <article>
                
<p>First, get the binary for your system (with <kbd>sudo</kbd>):</p>
<pre><strong>sudo curl -o  /usr/local/bin/gitlab-runner https://gitlab-runner-downloads.s3.amazonaws.com/latest/binaries/gitlab-runner-darwin-amd64</strong></pre>
<p>Then, just like we did previously, make the binary executable:</p>
<pre><strong>$ sudo chmod +x /usr/local/bin/gitlab-runner</strong></pre>
<p>Now that we have the binary in place, we can run the program as another user if we want:</p>
<pre><strong>$ cd ~</strong><br/><strong>$ gitlab-runner install</strong><br/><strong>$ gitlab-runner start</strong></pre>
<p>The runner will be installed and will be run after a system reboot.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Installing and using the Homebrew package manager</h1>
                </header>
            
            <article>
                
<p>A unified package manager for macOS doesn't really exist, but the one that's used the most is Homebrew, which can be found at <a href="https://brew.sh/">https://brew.sh/</a>. It works with formulas that contain scripts and settings to install binaries.</p>
<p>A Homebrew formula exists to install GitLab Runner:</p>
<pre><strong>brew install gitlab-runner</strong></pre>
<p>The next step is to install the runner as a service (this will also start it):</p>
<pre><strong>brew services start gitlab-runner</strong></pre>
<p>There are some drawbacks to using macOS as a runner platform. Many developers use runners on macOS to build iOS-related software. Often, UI testing is also involved. It isn't possible to automate this. You would have to run in the background as a system service (LaunchDaemon), and then the UI isn't reachable anymore. You can only run the runner in user mode to get access to the UI, which is why you must always log in to run the GitLab Runner.</p>
<p>Updating the runner is done by issuing <kbd>brew upgrade gitlab-runner</kbd>. For a manual install, it's a bit more complicated.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Updating a manually installed runner binary</h1>
                </header>
            
            <article>
                
<p>Just like we did for Linux, we are replacing the Golang binary that was downloaded previously. It also needs to be stopped, so make sure it isn't running, otherwise the installation will fail:</p>
<ol>
<li>First, we need to stop the service:</li>
</ol>
<pre style="padding-left: 60px"><strong>gitlab-runner stop</strong></pre>
<ol start="2">
<li>Like we did previously, get the binary to replace the runner's executable:</li>
</ol>
<pre style="padding-left: 60px"><strong>curl -o /usr/local/bin/gitlab-runner https://gitlab-runner-downloads.s3.amazonaws.com/latest/binaries/gitlab-runner-darwin-amd64</strong></pre>
<ol start="3">
<li>Make the downloaded binary executable:</li>
</ol>
<pre style="padding-left: 60px"><strong>chmod +x /usr/local/bin/gitlab-runner</strong></pre>
<ol start="4">
<li>Start the GitLab Runner service again:</li>
</ol>
<pre style="padding-left: 60px"><strong>gitlab-runner start</strong></pre>
<p>The steps to install the GitLab Runner software are roughly the same on the Linux and macOS platforms. The good part about using a package manager is that the software is easier to upgrade.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Installing on Windows</h1>
                </header>
            
            <article>
                
<p>Unlike GitLab itself, which doesn't run on Windows, you can operate the GitLab Runner software on Windows machines.</p>
<p>There are two types of runner binaries, depending on your CPU architecture:</p>
<ul>
<li>32-bit version (<a href="https://gitlab-runner-downloads.s3.amazonaws.com/latest/binaries/gitlab-runner-windows-386.exe">https://gitlab-runner-downloads.s3.amazonaws.com/latest/binaries/gitlab-runner-windows-386.exe</a>) </li>
<li>64-bit version (<a href="https://gitlab-runner-downloads.s3.amazonaws.com/latest/binaries/gitlab-runner-windows-amd64.exe">https://gitlab-runner-downloads.s3.amazonaws.com/latest/binaries/gitlab-runner-windows-amd64.exe</a>)</li>
</ul>
<p>Download it and copy it to <kbd>gitlab-runner.exe</kbd> in a folder on your local drive; for example, <kbd>C:-runner</kbd>.</p>
<p>Now, you need an elevated command prompt to register and install the software:</p>
<pre><strong>c:\cd c:\gitlab-runner</strong><br/><strong>c:\gitlab-runner\gitlab-runner.exe register</strong></pre>
<p>The registration steps will be shown in the next section as they are almost universal for all platforms.</p>
<p>When registration succeeds, you can start the GitLab Runner:</p>
<pre><strong>c:\gitlab-runner\gitlab-runner.exe install</strong><br/><strong>c:\gitlab-runner\gitlab-runner.exe start</strong></pre>
<p>Now that we have installed the runner software, the next step is to register with GitLab.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Registering a runner</h1>
                </header>
            
            <article>
                
<p>A GitLab Runner needs some basic information to start:</p>
<ul>
<li>The URL where it can find GitLab, which is called the coordinator URL.</li>
<li>The special token that you can find in GitLab that's meant to register runner instances.</li>
<li>A description that will later show up in the GitLab CI.</li>
<li>Tags, which you can give to the runner to make it easier to find in GitLab CI.</li>
<li>The type of executor (remember that there are many types, all of which were named in the <em>Runner client architecture</em> <span>section</span>).</li>
</ul>
<p>This basic information can be provided to the runner in two ways: interactive and non-interactive. First, we will discuss the interactive way.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">The interactive way of registering a runner</h1>
                </header>
            
            <article>
                
<p><span>The web location of the GitLab server to connect is the following:</span></p>
<pre><strong>sudo gitlab-runner register</strong></pre>
<p> Please enter the gitlab-ci coordinator URL (for example, <a href="https://gitlab.com">https://gitlab.com</a>):</p>
<pre><strong> https://gitlab-ee.joustie.com</strong></pre>
<p class="mce-root">You also need to enter the runner registration token since it's needed to register with GitLab:</p>
<pre><strong> Please enter the gitlab-ci token for this runner</strong><br/><strong>  xxx</strong></pre>
<p>The runner registration token can be found on the <span class="packt_screen">Admin Area</span> | <span class="packt_screen">Overview</span> | <span class="packt_screen">Runners</span> page or under <span class="packt_screen">Projects</span>.</p>
<p>You want a nice description so that you can find the runner later (the default is <kbd>hostname</kbd>):</p>
<pre><strong> Please enter the gitlab-ci description for this runner</strong><br/><strong>  [hostname] my-runner</strong></pre>
<p>Enter the tags that should apply to this runner (for example, <kbd>javarunner</kbd>). This can be changed later in GitLab:</p>
<pre><strong> Please enter the gitlab-ci tags for this runner (comma separated):</strong><br/><strong>  javarunner,another-javarunner</strong></pre>
<p>The most important part is determining the type of executor (for this chapter, I chose the shell executor):</p>
<pre><strong>Please enter the executor: ssh, docker+machine, docker-ssh+machine, kubernetes, docker, parallels, virtualbox, docker-ssh, shell:</strong><br/><strong> shell</strong></pre>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">The non-interactive way of registering a runner</h1>
                </header>
            
            <article>
                
<p>In larger environments, deployments are frequently scripted. So, for the runner, there is also a non-interactive install available to help in the effort of automating the infrastructure. You can specify subcommands to the GitLab <kbd>register</kbd> argument. To find out about these options, type the following on the command line:</p>
<pre><strong>gitlab-runner register -h</strong></pre>
<p>To register a runner, using the most common options, you would do the following:</p>
<pre><strong>sudo gitlab-runner register \</strong><br/><strong> --description "docker-runner" \</strong><br/><strong> --url "https://gitlab-ee.joustie.com/" \</strong><br/><strong> --registration-token "xxxx" \</strong><br/><strong> --executor "docker" \</strong><br/><strong> --docker-image alpine:latest \</strong><br/><strong> --non-interactive \</strong><br/><strong> --tag-list "docker,aws" \</strong><br/><strong> --run-untagged="true" \</strong><br/><strong> --locked="false" \</strong></pre>
<p>When the runner is registered, it will show up in GitLab in the Runner list:</p>
<p class="CDPAlignCenter CDPAlign"><img src="assets/1ed45ca0-a248-4b5d-add9-ee08630b3079.png" style="width:62.50em;height:27.17em;"/></p>
<p>The registration process is basically the process of telling the runner where GitLab is situated, and initiating a key exchange to secure access to GitLab. Following a successful registration, the runner saves the configuration information in a TOML file, which looks as follows:</p>
<pre>concurrent = 1<br/> check_interval = 0<br/> <br/> [[runners]]<br/>   name = "runnerhost.joustie.nl"<br/>   url = "https://gitlab-ee.joustie.nl"<br/>   token = "801bd1f41a3bb7a42c0b6f43e9ffc8"<br/>   executor = "shell"<br/>   shell = "bash"<br/>   [runners.cache]</pre>
<p>The shell can also be set to <kbd>sh</kbd> for a simple Bourne shell or <kbd>powershell</kbd> on Windows. On Linux, this is usually placed in <kbd>/etc/gitlab-runner/config.toml</kbd>.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Running the nightly version</h1>
                </header>
            
            <article>
                
<p>If you are feeling adventurous, you could also install the latest release, which isn't part of any release yet. Do this at your own risk. There could still be bugs in there:</p>
<ul>
<li><strong>Linux</strong>: 
<ul>
<li><a href="https://s3.amazonaws.com/gitlab-runner-downloads/master/binaries/gitlab-runner-linux-386">https://s3.amazonaws.com/gitlab-runner-downloads/master/binaries/gitlab-runner-linux-386</a></li>
<li><a href="https://s3.amazonaws.com/gitlab-runner-downloads/master/binaries/gitlab-runner-linux-amd64">https://s3.amazonaws.com/gitlab-runner-downloads/master/binaries/gitlab-runner-linux-amd64</a></li>
<li><a href="https://s3.amazonaws.com/gitlab-runner-downloads/master/binaries/gitlab-runner-linux-arm">https://s3.amazonaws.com/gitlab-runner-downloads/master/binaries/gitlab-runner-linux-arm</a></li>
</ul>
</li>
<li><strong>macOS</strong>:
<ul>
<li><a href="https://s3.amazonaws.com/gitlab-runner-downloads/master/binaries/gitlab-runner-darwin-386">https://s3.amazonaws.com/gitlab-runner-downloads/master/binaries/gitlab-runner-darwin-386</a></li>
<li><a href="https://s3.amazonaws.com/gitlab-runner-downloads/master/binaries/gitlab-runner-darwin-amd64">https://s3.amazonaws.com/gitlab-runner-downloads/master/binaries/gitlab-runner-darwin-amd64</a></li>
</ul>
</li>
<li><strong>Windows</strong>:
<ul>
<li><a href="https://s3.amazonaws.com/gitlab-runner-downloads/master/binaries/gitlab-runner-windows-386.exe">https://s3.amazonaws.com/gitlab-runner-downloads/master/binaries/gitlab-runner-windows-386.exe</a></li>
<li><a href="https://s3.amazonaws.com/gitlab-runner-downloads/master/binaries/gitlab-runner-windows-amd64.exe">https://s3.amazonaws.com/gitlab-runner-downloads/master/binaries/gitlab-runner-windows-amd64.exe</a></li>
</ul>
</li>
<li><strong>FreeBSD</strong>: 
<ul>
<li><a href="https://s3.amazonaws.com/gitlab-runner-downloads/master/binaries/gitlab-runner-freebsd-386">https://s3.amazonaws.com/gitlab-runner-downloads/master/binaries/gitlab-runner-freebsd-386</a></li>
<li><a href="https://s3.amazonaws.com/gitlab-runner-downloads/master/binaries/gitlab-runner-freebsd-amd64">https://s3.amazonaws.com/gitlab-runner-downloads/master/binaries/gitlab-runner-freebsd-amd64</a></li>
<li><a href="https://s3.amazonaws.com/gitlab-runner-downloads/master/binaries/gitlab-runner-freebsd-arm">https://s3.amazonaws.com/gitlab-runner-downloads/master/binaries/gitlab-runner-freebsd-arm</a></li>
</ul>
</li>
</ul>
<p>Now, we should have a runner installed and ready for use.</p>
<p>The easiest way to install a runner is by using a package manager running on the host operating system. Doing a manual install allows you to run development versions or patched versions easily because it has only one Golang binary.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Summary</h1>
                </header>
            
            <article>
                
<p>In this chapter, we showed you the basic architecture of a GitLab Runner. Then, we showed you how to install it on several operating systems with a shell executor. On most systems, there is a more or less automated way to do this, which also manages updates and platform compatibility. There's also a manual way of installing the software on every system. Using the manual method allows you to run developer versions of the runner easily. The registration process of the runner can be done step by step or in one command.</p>
<p>In the next chapter, we will deploy GitLab Runner in a Docker container and also in a more managed way in a Kubernetes cluster.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Questions</h1>
                </header>
            
            <article>
                
<ol>
<li>What part of GitLab does a runner connect to?</li>
<li>What additional action has to be performed on Debian-based systems to install the right package?</li>
<li>In what language is the runner client written?</li>
<li>What is the default description that's given to a runner?</li>
<li>What command argument is used to communicate the registration token to the <kbd>gitlab register</kbd> command?</li>
</ol>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Further reading</h1>
                </header>
            
            <article>
                
<ul>
<li><em>Hands-On Full Stack Development with Go</em>, by <em>Mina Andrawos</em>: <a href="https://www.packtpub.com/web-development/hands-full-stack-development-go">https://www.packtpub.com/web-development/hands-full-stack-development-go</a></li>
<li><em>Windows 10 for Enterprise Administrators</em>, by <em>Jeff Stokes</em>, <em>Manuel Singer</em>, and <em>Richard Diver</em>: <a href="https://www.packtpub.com/in/networking-and-servers/windows-10-enterprise-administrators">https://www.packtpub.com/in/networking-and-servers/windows-10-enterprise-administrators</a></li>
<li><em>Hands-On Continuous Integration and Delivery</em>, by <em>Jean-Marcel Belmont</em>: <a href="https://www.packtpub.com/in/virtualization-and-cloud/hands-continuous-integration-and-delivery">https://www.packtpub.com/in/virtualization-and-cloud/hands-continuous-integration-and-delivery</a></li>
</ul>


            </article>

            
        </section>
    </body></html>