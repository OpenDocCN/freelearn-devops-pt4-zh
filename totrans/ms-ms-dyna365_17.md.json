["```\n[FunctionName(\"EmailValidator\")]\npublic static async Task<IActionResult> Run(\n    [HttpTrigger(AuthorizationLevel.Anonymous, \"get\", \"post\", Route = null)] HttpRequest req,\n     ILogger log)\n{\n     log.LogInformation(\"C# HTTP trigger function processed a request.\");\n     string email = req.Query[\"email\"];\n     string requestBody = await new StreamReader(req.Body).ReadToEndAsync();\n     dynamic data = JsonConvert.DeserializeObject(requestBody);\n     email = email ?? data?.email;\n\n     //Validating the email address\n     EmailValidationResult jsonResponse = new EmailValidationResult();\n     jsonResponse.Email = email;\n     jsonResponse.Valid = IsEmailValid(email);\n     string json = JsonConvert.SerializeObject(jsonResponse);\n\n     return email != null\n           ? (ActionResult)new OkObjectResult($\"{json}\")\n           : new BadRequestObjectResult(\"Please pass a email parameter on the query string or in the request body\");\n}\n```", "```\nstatic bool IsEmailValid(string emailaddress)\n{\n    try\n    {\n        System.Net.Mail.MailAddress m = new System.Net.Mail.MailAddress(emailaddress);\n        return true;\n    }\n    catch (FormatException)\n    {\n        return false;\n    }\n}\n```", "```\npublic class EmailValidationResult\n{\n    public string Email { get; set; }\n    public bool Valid { get; set; }\n}\n```", "```\n{\"Email\":\"masteringd365bc@packt.com\",\"Valid\":true}\n```", "```\n{\"Email\":\"masteringd365bc\",\"Valid\":false}\n```", "```\nnpm i -g azure-functions-core-tools --unsafe-perm true\n```", "```\ncodeunit 50100 EmailValidation_PKT\n{\n    [EventSubscriber(ObjectType::table, Database::Customer, 'OnAfterValidateEvent', 'E-Mail', false, false)]\n    local procedure ValidateCustomerEmail(var Rec: Record Customer)\n    var\n        httpClient: HttpClient;\n        httpResponse: HttpResponseMessage;\n        jsonText: Text;\n        jsonObj: JsonObject;\n        funcUrl: Label 'https://sdemailvalidatorcore.azurewebsites.net/api/emailvalidatorcore?email=';\n        InvalidEmailError: Label 'Invalid email address.';\n        InvalidJonError: Label 'Invalid JSON response.';\n        validationResult: Boolean;\n    begin\n        if rec.\"E-Mail\" <> '' then begin\n            httpClient.Get(funcUrl + rec.\"E-Mail\", httpResponse);\n            httpResponse.Content().ReadAs(jsonText);\n            //Response JSON format: {\"Email\":\"test@packt.com\",\"Valid\":true}\n            if not jsonObj.ReadFrom(jsonText) then\n                Error(InvalidJonError);\n            //Read the Valid token from the response\n            validationResult := GetJsonToken(jsonObj, 'Valid').AsValue().AsBoolean();\n           if not validationResult then\n                Error(InvalidEmailError);\n        end;\n    end;\n\n    local procedure GetJsonToken(jsonObject: JsonObject; token: Text) jsonToken: JsonToken\n    var\n        TokenNotFoundErr: Label 'Token %1 not found.';\n    begin\n        if not jsonObject.Get(token, jsonToken) then\n            Error(TokenNotFoundErr, token);\n    end;\n}\n```", "```\nlocal procedure EnableExternalCallsInSandbox()\n    var\n        NAVAppSetting: Record \"NAV App Setting\";\n        EnvironmentInformation: Codeunit \"Environment Information\";\n        ModInfo: ModuleInfo;\n    begin\n        NavApp.GetCurrentModuleInfo(ModInfo);\n        if EnvironmentInformation.IsSandbox() then begin\n            NAVAppSetting.\"App ID\" := ModInfo.Id();\n            NAVAppSetting.\"Allow HttpClient Requests\" := true;\n            if not NAVAppSetting.Insert() then\n                NAVAppSetting.Modify();\n        end;\n    end;\n```", "```\nbegin\n    if rec.\"E-Mail\" <> '' then begin\n        EnableExternalCallsInSandbox();\n        httpClient.Get(funcUrl + rec.\"E-Mail\", httpResponse);\n```", "```\n[FunctionName(\"UploadFile\")]\npublic static async Task<IActionResult> Upload(\n   [HttpTrigger(AuthorizationLevel.Function, \"post\", Route = null)] HttpRequest req, ILogger    \n   log)\n\n[FunctionName(\"DownloadFile\")]\npublic static async Task<IActionResult> Download(\n    [HttpTrigger(AuthorizationLevel.Function, \"post\", Route = null)] HttpRequest req, ILogger \n    log)\n```", "```\n[FunctionName(\"ListFiles\")]\npublic static async Task<IActionResult> Dir(\n    [HttpTrigger(AuthorizationLevel.Function, \"get\", Route = null)] HttpRequest req,\n ILogger log)\n```", "```\n{\n    \"base64\": \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAJAAAACVCAYAAAC3i3MLAA\",\n    \"fileName\": \"MyFile.png\",\n    \"fileType\": \"image/png\",\n    \"fileExt\": \"png\"\n}\n```", "```\n[FunctionName(\"UploadFile\")]\npublic static async Task<IActionResult> Upload(                \n    [HttpTrigger(AuthorizationLevel.Function, \"post\", Route = null)] HttpRequest req,\n    ILogger log)\n    {\n        log.LogInformation(\"C# HTTP trigger function processed a request.\");\n        string requestBody = await new StreamReader(req.Body).ReadToEndAsync();\n        dynamic data = JsonConvert.DeserializeObject(requestBody);\n        string base64String = data.base64;\n        string fileName = data.fileName;\n        string fileType = data.fileType;\n        string fileExt = data.fileExt;\n        Uri uri = await UploadBlobAsync(base64String, fileName, fileType,     \n                    fileExt);           \n        return fileName != null\n            ? (ActionResult)new OkObjectResult($\"File {fileName} stored. URI = {uri}\")\n            : new BadRequestObjectResult(\"Error on input parameter (object)\");\n}\n```", "```\npublic static async Task<Uri> UploadBlobAsync(string base64String, string fileName, string fileType, string fileExtension)\n{\n    string contentType = fileType;           \n    byte[] fileBytes = Convert.FromBase64String(base64String);\n    CloudStorageAccount storageAccount =     \n        CloudStorageAccount.Parse(BLOBStorageConnectionString);\n    CloudBlobClient client = storageAccount.CreateCloudBlobClient();\n    CloudBlobContainer container = client.GetContainerReference(\"d365bcfiles\");\n    await container.CreateIfNotExistsAsync(\n        BlobContainerPublicAccessType.Blob,\n        new BlobRequestOptions(),\n        new OperationContext());\n    CloudBlockBlob blob = container.GetBlockBlobReference(fileName);\n    blob.Properties.ContentType = contentType;\n    using (Stream stream = new MemoryStream(fileBytes, 0, fileBytes.Length))\n    {\n        await blob.UploadFromStreamAsync(stream).ConfigureAwait(false);\n    }\n    return blob.Uri;\n}\n```", "```\n{\n    \"url\": \"https://d365bcfilestorage.blob.core.windows.net/d365bcfiles/MasteringD365BC.png\",\n    \"fileType\": \"image/png\",\n    \"fileName\": \"MasteringD365BC.png\"\n}\n```", "```\n[FunctionName(\"DownloadFile\")]\npublic static async Task<IActionResult> Download(\n    [HttpTrigger(AuthorizationLevel.Function, \"post\", Route = null)] HttpRequest req,\n    ILogger log)\n{\n    log.LogInformation(\"C# HTTP trigger function processed a request.\");\n    try\n    {\n        string requestBody = await new StreamReader(req.Body).ReadToEndAsync();\n        dynamic data = JsonConvert.DeserializeObject(requestBody);\n        string url = data.url;\n        string contentType = data.fileType;\n        string fileName = data.fileName;\n        byte[] x = await DownloadBlobAsync(url, fileName);\n        //Returns the Base64 string of the retrieved file\n        return (ActionResult)new OkObjectResult($\"{Convert.ToBase64String(x)}\");            \n    }\n    catch(Exception ex)\n    {\n        log.LogInformation(\"Bad input request: \" + ex.Message);\n        return new BadRequestObjectResult(\"Error on input parameter (object): \" + \n            ex.Message);\n    }\n}\n```", "```\npublic static async Task<byte[]> DownloadBlobAsync(string url, string fileName)\n{\n    CloudStorageAccount storageAccount =\n        CloudStorageAccount.Parse(BLOBStorageConnectionString);\n    CloudBlobClient client = storageAccount.CreateCloudBlobClient();\n    CloudBlobContainer container = client.GetContainerReference(\"d365bcfiles\"); \n    CloudBlockBlob blob = container.GetBlockBlobReference(fileName);\n    await blob.FetchAttributesAsync();\n    long fileByteLength = blob.Properties.Length;\n    byte[] fileContent = new byte[fileByteLength];\n    for (int i = 0; i < fileByteLength; i++)\n    {\n        fileContent[i] = 0x20;\n    }\n    await blob.DownloadToByteArrayAsync(fileContent, 0);\n    return fileContent;\n}\n```", "```\n[FunctionName(\"ListFiles\")]\n        public static async Task<IActionResult> Dir(\n            [HttpTrigger(AuthorizationLevel.Function, \"get\", Route = null)] HttpRequest req,\n            ILogger log)\n        {\n            log.LogInformation(\"C# HTTP trigger function processed a request.\");\n            string requestBody = await new StreamReader(req.Body).ReadToEndAsync();\n            dynamic data = JsonConvert.DeserializeObject(requestBody);\n            var URIfileList = await ListBlobAsync();\n            string json = JsonConvert.SerializeObject(URIfileList);\n            return URIfileList != null\n                ? (ActionResult)new OkObjectResult($\"{json}\")\n               : new BadRequestObjectResult(\"Bad request.\");\n       }\n```", "```\npublic static async Task<List<Uri>> ListBlobAsync()\n{\n    CloudStorageAccount storageAccount = \n        CloudStorageAccount.Parse(BLOBStorageConnectionString);\n    CloudBlobClient client = storageAccount.CreateCloudBlobClient();\n    CloudBlobContainer container = client.GetContainerReference(\"d365bcfiles\");\n    List<Uri> URIFileList = new List<Uri>();\n    BlobContinuationToken blobContinuationToken = null;\n    do\n    {\n        var resultSegment = await container.ListBlobsSegmentedAsync(prefix: null,\n                                           useFlatBlobListing: true,\n                                           blobListingDetails: BlobListingDetails.None,\n                                           maxResults: null,\n                                           currentToken: blobContinuationToken,\n                                           options: null,\n                                           operationContext: null);\n        // Get the value of the continuation token returned by the listing call.\n        blobContinuationToken = resultSegment.ContinuationToken;\n        foreach (IListBlobItem item in resultSegment.Results)\n        {\n            URIFileList.Add(item.Uri);\n        }\n    } while (blobContinuationToken != null); //Loop while the continuation token is not null.\n\n    return URIFileList;\n}\n```", "```\n{\n    \"url\": \"https://d365bcfilestorage.blob.core.windows.net/d365bcfiles/MasteringD365BC.png\",\n    \"fileType\": \"image/png\",\n    \"fileName\": \"MasteringD365BC.png\"\n}\n```", "```\nvar\n        BaseUrlUploadFunction: Label 'https://saasfilemgt.azurewebsites.net/api/UploadFile?code=YOURFUNCTIONKEY';\n        BaseUrlDownloadFunction: Label \n                'https://saasfilemgt.azurewebsites.net/api/DownloadFile?code=YOURFUNCTIONKEY';\n```", "```\n    procedure UploadFile()\n    var\n      fileMgt: Codeunit \"File Management\";\n      selectedFile: Text;\n      httpClient: HttpClient;\n      httpContent: HttpContent;\n      jsonBody: text;\n      httpResponse: HttpResponseMessage;\n      httpHeader: HttpHeaders;\n      fileName: Text;\n      fileExt: Text;\n      base64Convert: Codeunit \"Base64 Convert\";\n      instr: InStream;\n    begin\n        UploadIntoStream('Select a file to upload','','',selectedFile,instr);\n        fileName := delchr(fileMgt.GetFileName(selectedFile), '=', '.' + \n                fileMgt.GetExtension(selectedFile));\n        fileExt := fileMgt.GetExtension(selectedFile);\n        jsonBody := ' {\"base64\":\"' + tempblob.ToBase64String() +\n                '\",\"fileName\":\"' + fileName + '.' + fileExt +\n                '\",\"fileType\":\"' + GetMimeType(selectedFile) + '\", \"fileExt\":\"' + \n                 fileMgt.GetExtension(selectedFile) + '\"}';\n        httpContent.WriteFrom(jsonBody);\n        httpContent.GetHeaders(httpHeader);\n        httpHeader.Remove('Content-Type');\n        httpHeader.Add('Content-Type', 'application/json');\n        httpClient.Post(BaseUrlUploadFunction, httpContent, httpResponse);\n        //Here we should read the response to retrieve the URI\n        message('File uploaded.');\n    end;\n```", "```\n    procedure DownloadFile(fileName: Text; blobUrl: Text)\n    var\n        tempblob: Codeunit \"Temp Blob\";\n        httpClient: HttpClient;\n        httpContent: HttpContent;\n        jsonBody: text;\n        httpResponse: HttpResponseMessage;\n        httpHeader: HttpHeaders;\n        base64: Text;\n        fileType: Text;\n        fileStream: InStream;\n        base64Convert: Codeunit \"Base64 Convert\";\n        outstr: OutStream;\n    begin\n        fileType := GetMimeType(fileName);\n        jsonBody := ' {\"url\":\"' + blobUrl + '\",\"fileName\":\"' + fileName + '\", \"fileType\":\"' + \n                    fileType + '\"}';\n        httpContent.WriteFrom(jsonBody);\n        httpContent.GetHeaders(httpHeader);\n        httpHeader.Remove('Content-Type');\n        httpHeader.Add('Content-Type', 'application/json');\n        httpClient.Post(BaseUrlDownloadFunction, httpContent, httpResponse);\n        httpResponse.Content.ReadAs(base64);\n        base64 := DelChr(base64, '=', '\"');\n        base64Convert.FromBase64(base64);\n        tempblob.CreateOutStream(outstr);\n        outstr.WriteText(base64);\n        tempblob.CreateInStream(fileStream);\n        DownloadFromStream(fileStream, 'Download file from Azure Storage', '', '', fileName);\n    end;\n```", "```\nlocal procedure GetMimeType(selectedFile: Text): Text\nvar\n    fileMgt: Codeunit \"File Management\";\n    mimeType: Text;\nbegin\n    case lowercase(fileMgt.GetExtension(selectedFile)) of\n        'pdf':\n            mimeType := 'application/pdf';\n        'txt':\n            mimeType := 'text/plain';\n        'csv':\n            mimeType := 'text/csv';\n        'png':\n            mimeType := 'image/png';\n        'jpg':\n            mimeType := 'image/jpg';\n        'bmp':\n            mimeType := 'image/bmp';\n        'gif':\n            mimeType := 'image/gif';\n        else\n            Error('File Format not supported!');\n    end;\n    EXIT(mimeType);\nend;\n```", "```\npageextension 50103 ItemListExt extends \"Item List\"\n{\n    actions\n    {\n        addlast(Creation)\n        {\n            Action(Upload)\n            {\n                ApplicationArea = All;\n                Caption = 'Upload file to Azure Blob Storage';\n                Image = Add;\n                Promoted = true;\n                trigger OnAction();\n                var\n                    SaaSFileMgt: Codeunit SaaSFileMgt;\n                begin\n                    SaaSFileMgt.UploadFile();\n                end;\n            }\n\n            Action(Download)\n            {\n                ApplicationArea = All;\n                Caption = 'Download file from Azure Blob Storage';\n                Image = MoveDown;\n                Promoted = true;\n                trigger OnAction();\n                var\n                    SaaSFileMgt: Codeunit SaaSFileMgt;\n                begin\n                    SaaSFileMgt.DownloadFile('TEST.txt', 'https://d365bcfilestorage.blob.core.windows.net/d365bcfiles/TEST.txt');\n                end;\n            }\n        }\n    }\n}\n```"]